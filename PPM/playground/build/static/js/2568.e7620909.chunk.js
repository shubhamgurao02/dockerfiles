"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[2568],{92333:function(e,t,s){s.d(t,{Z:function(){return v}});var n=s(74569),r=s.n(n),o=s(72791),c=s(34831),l=s(76683),a=s(29439),i=s(3555),d=s(78820),u=s(72426),h=s.n(u),p=s(80184),f=(0,i.td)([]);var m=function(e){var t=e.roleWiseComputedCostData,s=e.getRoleWiseComputedCost,n=e.setLoader,l=localStorage.getItem("resId"),i=c.N.baseUrl,u=(0,o.useState)(null),m=(0,a.Z)(u,2),v=m[0],x=m[1],j=(0,o.useState)(!1),y=(0,a.Z)(j,2),g=(y[0],y[1],(0,o.useState)(!0)),_=(0,a.Z)(g,2),C=_[0],S=_[1],b=(0,o.useState)(!1),Z=(0,a.Z)(b,2),k=Z[0],w=Z[1],N=["check","roleType","department","country_name","computed_cost"],T=["computed_cost","effective_start_date","effective_end_date"],D=(0,o.useRef)(null);(0,o.useEffect)((function(){W()}),[t]);var W=function(){x((function(){return t.length>0?t.map((function(e,t){var s=e.roleWiseComputedCost,n=e.roleWiseComputedCostHistory,r=[];return N.forEach((function(e,n){switch(e){case"check":r.push((0,p.jsx)("td",{align:"center",children:(0,p.jsx)("input",{type:"checkBox",onClick:function(e){B(e,s)}})}));break;case"computed_cost":r.push((0,p.jsx)("td",{align:"right",children:s[e]}));break;case"roleType":r.push((0,p.jsxs)("td",{children:[(0,p.jsx)("span",{children:s[e]}),(0,p.jsx)("span",{align:"right",children:(0,p.jsx)(d.wYb,{title:"Computed Cost History",style:{color:"blue",cursor:"pointer"},onClick:function(e){R(e,t)}})})]}));break;default:r.push((0,p.jsx)("td",{children:s[e]}))}})),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("tr",{id:t,children:r},t),(0,p.jsx)("tr",{className:"hideEle",children:(0,p.jsx)("td",{colSpan:"5",children:(0,p.jsx)(E,{roleWiseHistoryData:n})})})]})})):(0,p.jsx)("td",{colSpan:"5",align:"center",children:"No Rows to Show"})}))},E=function(e){var t=e.roleWiseHistoryData,s=t.length>0?t.map((function(e,t){var s=[];return T.forEach((function(t,n){switch(t){case"effective_start_date":case"effective_end_date":s.push((0,p.jsx)("td",{align:"center",children:null!=e[t]?h()(e[t]).format("DD-MMM-yyyy"):"N/A"}));break;default:s.push((0,p.jsx)("td",{align:"right",children:e[t]}))}})),(0,p.jsx)("tr",{children:s})})):(0,p.jsx)("td",{colSpan:"5",align:"center",children:"No Rows to Show"});return(0,p.jsx)("table",{style:{width:"90%",marginLeft:"4rem"},className:"table table-bordered table-striped",children:(0,p.jsxs)("tbody",{children:[(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:"Computed Cost"}),(0,p.jsx)("th",{children:"Effective From"}),(0,p.jsx)("th",{children:"Effective To"})]}),s]})})},R=function(e,t){var s=document.getElementById(t).nextSibling.classList;s.contains("hideEle")?s.remove("hideEle"):s.add("hideEle")},B=function(e,t){for(var s=document.getElementsByTagName("input"),n=[],r=f.value,o=0;o<s.length;o++)"checkbox"==s[o].type&&o>0&&n.push(s[o].checked);var c=r.some((function(e){return e.resource_cost_data_id===t.resource_cost_data_id}));if(e.target.checked&&!1===c)r.push({department_id:t.department_id,role_type_id:t.role_type_id,country_id:t.country_id,computed_cost:t.computed_cost,resource_cost_data_id:t.resource_cost_data_id});else if(!1===e.target.checked&&c){var l=r.filter((function(e){return e.resource_cost_data_id!==t.resource_cost_data_id}));r=l}f.value=r;var a=document.getElementById("parentCheckBox");n.includes(!1)?a.checked=!1:a.checked=!0,I()},A=function(){var e={computedRoleCostData:f.value,loggedUserId:l};n(!0),r()({method:"POST",url:i+"/CostMS/cost/saveComputedRoleCosts",data:e}).then((function(e){!0===e.data.status&&(n(!1),w(!0),setTimeout((function(){w(!1)}),3e3)),s()}))},I=function(){var e,t;f.value.length>0?S(!1):S(!0);var s=D.current;s.disabled?null===(e=s.classList)||void 0===e||e.add("blockButton"):null===(t=s.classList)||void 0===t||t.remove("blockButton")};return(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12 mt-1 customCard",children:[k?(0,p.jsx)("div",{className:"successMsg",children:(0,p.jsx)("span",{children:"Approved Successfully."})}):"",(0,p.jsx)("div",{id:"roleApprovals",children:(0,p.jsx)("table",{className:"table table-bordered table-striped",children:(0,p.jsxs)("tbody",{children:[(0,p.jsxs)("tr",{className:"headerSticky",children:[(0,p.jsx)("th",{children:(0,p.jsx)("input",{id:"parentCheckBox",type:"checkBox",onClick:function(e){var s=document.getElementsByTagName("input"),n=t,r=[];if(e.target.checked){for(var o=0;o<s.length;o++)"checkbox"==s[o].type&&(s[o].checked=!0),void 0!==n[o]&&r.push({department_id:n[o].roleWiseComputedCost.department_id,role_type_id:n[o].roleWiseComputedCost.role_type_id,country_id:n[o].roleWiseComputedCost.country_id,computed_cost:n[o].roleWiseComputedCost.computed_cost,resource_cost_data_id:n[o].roleWiseComputedCost.resource_cost_data_id});f.value=r}else{for(o=0;o<s.length;o++)"checkbox"==s[o].type&&(s[o].checked=!1);f.value=[]}I()}})}),(0,p.jsx)("th",{children:"Role Type"}),(0,p.jsx)("th",{children:"Department"}),(0,p.jsx)("th",{children:"Country"}),(0,p.jsx)("th",{children:"Computed Cost"})]}),v]})})})]}),(0,p.jsx)("div",{align:"center",className:" col-md-12 mt-2",children:(0,p.jsx)("button",{ref:D,className:"btn btn-primary ".concat(C?"disabledIcon":""),disabled:C,onClick:function(e){A()},children:"Approve"})})]})};var v=function(e){var t=e.country,s=e.departments,n=e.selectedDepartments,r=e.setSelectedDepartments,o=e.roleTypes,a=e.selectedRoleTypes,i=e.setSelectedRoleTypes,d=e.formData,u=e.setFormData,h=e.getRoleWiseComputedCost,f=e.roleWiseComputedCostData,v=e.validator,x=e.setLoader;return c.N.baseUrl,(0,p.jsxs)("div",{children:[(0,p.jsx)(l.Z,{country:t,departments:s,selectedDepartments:n,setSelectedDepartments:r,roleTypes:o,formData:d,setFormData:u,selectedRoleTypes:a,setSelectedRoleTypes:i,costApprovalButtonHandler:function(){h()},validator:v}),(0,p.jsx)(m,{roleWiseComputedCostData:f,getRoleWiseComputedCost:h,setLoader:x})]})}},76683:function(e,t,s){s.d(t,{Z:function(){return h}});var n=s(4942),r=s(1413),o=s(29439),c=s(72791),l=s(36167),a=s(32125),i=s(80184);var d=function(e){var t=e.roleWiseViewState,s=e.columnData,n=(0,c.useState)([]),r=(0,o.Z)(n,2),l=r[0],a=r[1],d=(0,c.useState)(null),u=(0,o.Z)(d,2),h=u[0],p=u[1],f=(0,c.useState)([]),m=(0,o.Z)(f,2),v=m[0],x=m[1];(0,c.useEffect)((function(){void 0!==t&&a(JSON.parse(JSON.stringify(t)))}),[t]),(0,c.useEffect)((function(){j(),y()}),[l]);var j=function(){p((function(){return null===l||void 0===l?void 0:l.map((function(e,t){var s=[];return Object.keys(e).forEach((function(t,n){!1===t.includes("id")&&(null===e[t]?s.push((0,i.jsx)("td",{className:"ellpss",title:"",children:""})):t.includes("Cadre")||t.includes("Role Type")?s.push((0,i.jsx)("td",{className:"ellpss",title:e[t],children:e[t]})):s.push((0,i.jsxs)("td",{className:"ellpss",title:e[t],align:"right",children:[(0,i.jsx)("span",{style:{float:"left"},children:"$"}),(0,i.jsx)("span",{align:"right",children:e[t]})]})))})),(0,i.jsx)("tr",{children:s})}))}))},y=function(){x((function(){return s.map((function(e,t){var s=[];return Object.keys(e).forEach((function(n,r){0===t&&s.push((0,i.jsx)("th",{className:"ellpss",title:e[n],children:e[n]}))})),(0,i.jsx)("tr",{className:"headerSticky",children:s})}))}))};return(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"col-md-12 mt-2",style:{overflow:"auto",maxHeight:"450px"},children:(0,i.jsx)("table",{className:"table table-bordered table-striped pipelinetable",children:(0,i.jsxs)("tbody",{children:[v,h]})})})})},u=s(78820);var h=function(e){var t=e.country,s=e.departments,h=e.selectedDepartments,p=e.setSelectedDepartments,f=e.roleTypes,m=e.selectedRoleTypes,v=e.setSelectedRoleTypes,x=e.costApprovalButtonHandler,j=e.formData,y=e.setFormData,g=e.type,_=e.roleWiseViewAxios,C=e.roleWiseViewState,S=e.columnData,b=(e.validator,(0,c.useState)("")),Z=(0,o.Z)(b,2),k=Z[0],w=Z[1],N=(0,c.useRef)([]),T=(0,c.useRef)([]);(0,c.useEffect)((function(){}),[j]),(0,c.useEffect)((function(){}),[h]);var D=function(e,t){return e.length===s.length?"<< ALL >>":0===e.length?"<< Please Select >>":e.map((function(t){return e.length>1?t.label+",":t.label}))};return(0,i.jsxs)("div",{className:"col-xs-12 col-sm-12 col-md-12 col-lg-12 customCard",children:[k,(0,i.jsxs)("div",{class:"group-content row",children:["roleWiseView"!==g?(0,i.jsx)("div",{class:"col-md-3 mb-2",children:(0,i.jsxs)("div",{class:"form-group row",children:[(0,i.jsxs)("label",{class:"col-5",for:"BuIds",children:["Role Types",(0,i.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,i.jsx)("span",{class:"col-1 p-0",children:":"}),(0,i.jsxs)("div",{class:"col-6 multiselect",ref:function(e){N.current[0]=e},children:[" ",(0,i.jsx)(l.NU,{id:"roleTypes",options:f,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,valueRenderer:D,value:m,disabled:!1,onChange:function(e){v(e);var t=[];e.forEach((function(e){t.push(e.value)})),y((function(e){return(0,r.Z)((0,r.Z)({},e),{},(0,n.Z)({},"roleType",t.toString()))}))}})]})]})}):"",(0,i.jsx)("div",{class:"col-md-3 mb-2",children:(0,i.jsxs)("div",{class:"form-group row",children:[(0,i.jsxs)("label",{class:"col-5",for:"BuIds",children:["Country ",(0,i.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,i.jsx)("span",{class:"col-1 p-0",children:":"}),(0,i.jsxs)("div",{class:"col-6",children:[" ",(0,i.jsx)("select",{id:"country",onChange:function(e){return function(e){var t=e.target,s=t.id,o=t.value;y((function(e){return(0,r.Z)((0,r.Z)({},e),{},(0,n.Z)({},s,o))}))}(e)},style:{width:"100%"},children:t.map((function(e){return(0,i.jsx)("option",{value:e.id,selected:"India"==e.country_name,children:e.country_name},e.id)}))})]})]})}),(0,i.jsx)("div",{class:"col-md-3 mb-2",children:(0,i.jsxs)("div",{class:"form-group row",children:[(0,i.jsxs)("label",{class:"col-5",for:"BuIds",children:["Business Unit ",(0,i.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,i.jsx)("span",{class:"col-1 p-0",children:":"}),(0,i.jsx)("div",{class:"col-6 multiselect",ref:function(e){N.current[1]=e},children:(0,i.jsx)(l.NU,{id:"businessUnit",options:s,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,valueRenderer:D,value:h,disabled:!1,onChange:function(e){p(e);var t=[];e.forEach((function(e){t.push(e.value)})),y((function(e){return(0,r.Z)((0,r.Z)({},e),{},(0,n.Z)({},"departments",t.toString()))}))}})})]})}),(0,i.jsx)("div",{class:"col-md-12 col-sm-12 col-xs-12 btn-container center my-3 mb-2",children:(0,i.jsx)("button",{type:"submit",class:"btn btn-primary",title:"Search",onClick:function(){"roleWiseView"===g?function(){var e=N.current.filter((function(e){return void 0!=e}));T.current=e,(0,a.Z)(T)?w((0,i.jsxs)("div",{className:"col-md-12 statusMsg error",children:[(0,i.jsx)(u.CSE,{}),(0,i.jsx)("span",{children:"Please Select Mandatory Fields"})]})):(w(""),_())}():function(){var e=N.current.filter((function(e){return void 0!=e}));T.current=e,(0,a.Z)(T)?w((0,i.jsxs)("div",{className:"col-md-12 statusMsg error",children:[(0,i.jsx)(u.CSE,{}),(0,i.jsx)("span",{children:"Please Select Mandatory Fields"})]})):(w(""),x())}()},children:"Search"})})]}),"roleWiseView"===g&&S.length>0&&(0,i.jsx)(d,{roleWiseViewState:C,columnData:S})]})}},42568:function(e,t,s){s.r(t);var n=s(74165),r=s(4942),o=s(1413),c=s(15861),l=s(29439),a=s(72791),i=(s(3704),s(92333),s(74569)),d=s.n(i),u=s(34831),h=s(76683),p=s(83854),f=s(80184);t.default=function(e){var t=window.location.href,s=(0,a.useState)([]),i=(0,l.Z)(s,2),m=i[0],v=i[1],x=(0,a.useState)([]),j=(0,l.Z)(x,2),y=j[0],g=j[1],_=(0,a.useState)([]),C=(0,l.Z)(_,2),S=C[0],b=C[1],Z=(0,a.useState)([]),k=(0,l.Z)(Z,2),w=k[0],N=k[1],T=(0,a.useState)([]),D=(0,l.Z)(T,2),W=D[0],E=D[1],R=(0,a.useState)([]),B=(0,l.Z)(R,2),A=B[0],I=B[1],M=(0,a.useState)([]),L=(0,l.Z)(M,2),V=L[0],H=L[1],O=(0,a.useState)(!1),U=(0,l.Z)(O,2),F=U[0],P=U[1],J=(0,a.useState)({roleType:"",country:3,departments:""}),Y=(0,l.Z)(J,2),$=Y[0],q=Y[1],z=(0,a.useState)(!1),G=(0,l.Z)(z,2),K=G[0],Q=(G[1],u.N.baseUrl),X=localStorage.getItem("resId"),ee=function(){var e=(0,c.Z)((0,n.Z)().mark((function e(){var t,s,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d()({url:Q+"/CostMS/cost/getDepartments"});case 2:t=e.sent,(s=t.data).push({value:999,label:"Non-Revenue Units"}),g(s),b(s),c=[],s.forEach((function(e){c.push(e.value)})),q((function(e){return(0,o.Z)((0,o.Z)({},e),{},(0,r.Z)({},"departments",c.toString()))})),ne(c.toString());case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){d()({url:Q+"/CostMS/cost/getCountries"}).then((function(e){v(e.data)})),ee(),d()({url:Q+"/CostMS/cost/getRoleTypes"}).then((function(e){var t=e.data;N(t),E(t)})),te()}),[]),(0,a.useEffect)((function(){}),[m,w,y]);var te=function(){var e=(0,c.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://geolocation-db.com/json/").then((function(e){return e.json()}),"jsonp").then((function(e){se(e.IPv4)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(e){var s={},n=t.split("#");s.ipAddress=e,s.userId=X,s.url=n[1],d()({method:"POST",url:Q+"/CostMS/cost/saveLoginTracks",data:s}).then((function(e){}))},ne=function(e){void 0!==e&&($.departments=e),$.roleType="0",P(!0),d()({method:"POST",url:Q+"/CostMS/cost/roleWiseView",data:$}).then((function(e){for(var t=e.data.roleWiseComputedCost,s=e.data.computedCostColumns.split(","),n=[],r={},o={},c=0;c<s.length-1;c++){var l;if(!1===s[c].includes("id"))r[s[c]]=null===(l=s[c])||void 0===l?void 0:l.replaceAll("_ComputedCost","").replaceAll("_"," "),o[s[c]]="ComputedCost"}n.push(r),n.push(o),H(n);for(var a=[],i=0;i<t.length;i++){t[i];for(var d={},u=0;u<s.length-1;u++)d[s[u]]=t[i][s[u]];a.push(d)}I(a),P(!1)}))};return(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"col-md-12 pageHeading ",children:"Cost"}),F?(0,f.jsx)(p.Z,{}):"",(0,f.jsx)("div",{className:"col-md-12 p0"}),t.includes("roleView")?(0,f.jsx)("div",{children:(0,f.jsx)(h.Z,{country:m,departments:y,selectedDepartments:S,setSelectedDepartments:b,roleTypes:w,selectedRoleTypes:W,setSelectedRoleTypes:E,formData:$,setFormData:q,type:"roleWiseView",roleWiseViewAxios:ne,roleWiseViewState:A,columnData:V,validator:K})}):""]})}}}]);
//# sourceMappingURL=2568.e7620909.chunk.js.map