"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[1350],{92333:function(e,t,s){s.d(t,{Z:function(){return v}});var n=s(74569),r=s.n(n),o=s(72791),c=s(34831),a=s(76683),l=s(29439),i=s(3555),d=s(78820),u=s(72426),p=s.n(u),h=s(80184),f=(0,i.td)([]);var m=function(e){var t=e.roleWiseComputedCostData,s=e.getRoleWiseComputedCost,n=e.setLoader,a=localStorage.getItem("resId"),i=c.N.baseUrl,u=(0,o.useState)(null),m=(0,l.Z)(u,2),v=m[0],x=m[1],j=(0,o.useState)(!1),y=(0,l.Z)(j,2),g=(y[0],y[1],(0,o.useState)(!0)),C=(0,l.Z)(g,2),_=C[0],S=C[1],b=(0,o.useState)(!1),Z=(0,l.Z)(b,2),k=Z[0],w=Z[1],T=["check","roleType","department","country_name","computed_cost"],N=["computed_cost","effective_start_date","effective_end_date"],D=(0,o.useRef)(null);(0,o.useEffect)((function(){E()}),[t]);var E=function(){x((function(){return t.length>0?t.map((function(e,t){var s=e.roleWiseComputedCost,n=e.roleWiseComputedCostHistory,r=[];return T.forEach((function(e,n){switch(e){case"check":r.push((0,h.jsx)("td",{align:"center",children:(0,h.jsx)("input",{type:"checkBox",onClick:function(e){B(e,s)}})}));break;case"computed_cost":r.push((0,h.jsx)("td",{align:"right",children:s[e]}));break;case"roleType":r.push((0,h.jsxs)("td",{children:[(0,h.jsx)("span",{children:s[e]}),(0,h.jsx)("span",{align:"right",children:(0,h.jsx)(d.wYb,{title:"Computed Cost History",style:{color:"blue",cursor:"pointer"},onClick:function(e){W(e,t)}})})]}));break;default:r.push((0,h.jsx)("td",{children:s[e]}))}})),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("tr",{id:t,children:r},t),(0,h.jsx)("tr",{className:"hideEle",children:(0,h.jsx)("td",{colSpan:"5",children:(0,h.jsx)(R,{roleWiseHistoryData:n})})})]})})):(0,h.jsx)("td",{colSpan:"5",align:"center",children:"No Rows to Show"})}))},R=function(e){var t=e.roleWiseHistoryData,s=t.length>0?t.map((function(e,t){var s=[];return N.forEach((function(t,n){switch(t){case"effective_start_date":case"effective_end_date":s.push((0,h.jsx)("td",{align:"center",children:null!=e[t]?p()(e[t]).format("DD-MMM-yyyy"):"N/A"}));break;default:s.push((0,h.jsx)("td",{align:"right",children:e[t]}))}})),(0,h.jsx)("tr",{children:s})})):(0,h.jsx)("td",{colSpan:"5",align:"center",children:"No Rows to Show"});return(0,h.jsx)("table",{style:{width:"90%",marginLeft:"4rem"},className:"table table-bordered table-striped",children:(0,h.jsxs)("tbody",{children:[(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:"Computed Cost"}),(0,h.jsx)("th",{children:"Effective From"}),(0,h.jsx)("th",{children:"Effective To"})]}),s]})})},W=function(e,t){var s=document.getElementById(t).nextSibling.classList;s.contains("hideEle")?s.remove("hideEle"):s.add("hideEle")},B=function(e,t){for(var s=document.getElementsByTagName("input"),n=[],r=f.value,o=0;o<s.length;o++)"checkbox"==s[o].type&&o>0&&n.push(s[o].checked);var c=r.some((function(e){return e.resource_cost_data_id===t.resource_cost_data_id}));if(e.target.checked&&!1===c)r.push({department_id:t.department_id,role_type_id:t.role_type_id,country_id:t.country_id,computed_cost:t.computed_cost,resource_cost_data_id:t.resource_cost_data_id});else if(!1===e.target.checked&&c){var a=r.filter((function(e){return e.resource_cost_data_id!==t.resource_cost_data_id}));r=a}f.value=r;var l=document.getElementById("parentCheckBox");n.includes(!1)?l.checked=!1:l.checked=!0,A()},M=function(){var e={computedRoleCostData:f.value,loggedUserId:a};n(!0),r()({method:"POST",url:i+"/CostMS/cost/saveComputedRoleCosts",data:e}).then((function(e){!0===e.data.status&&(n(!1),w(!0),setTimeout((function(){w(!1)}),3e3)),s()}))},A=function(){var e,t;f.value.length>0?S(!1):S(!0);var s=D.current;s.disabled?null===(e=s.classList)||void 0===e||e.add("blockButton"):null===(t=s.classList)||void 0===t||t.remove("blockButton")};return(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12 mt-1 customCard",children:[k?(0,h.jsx)("div",{className:"successMsg",children:(0,h.jsx)("span",{children:"Approved Successfully."})}):"",(0,h.jsx)("div",{id:"roleApprovals",children:(0,h.jsx)("table",{className:"table table-bordered table-striped",children:(0,h.jsxs)("tbody",{children:[(0,h.jsxs)("tr",{className:"headerSticky",children:[(0,h.jsx)("th",{children:(0,h.jsx)("input",{id:"parentCheckBox",type:"checkBox",onClick:function(e){var s=document.getElementsByTagName("input"),n=t,r=[];if(e.target.checked){for(var o=0;o<s.length;o++)"checkbox"==s[o].type&&(s[o].checked=!0),void 0!==n[o]&&r.push({department_id:n[o].roleWiseComputedCost.department_id,role_type_id:n[o].roleWiseComputedCost.role_type_id,country_id:n[o].roleWiseComputedCost.country_id,computed_cost:n[o].roleWiseComputedCost.computed_cost,resource_cost_data_id:n[o].roleWiseComputedCost.resource_cost_data_id});f.value=r}else{for(o=0;o<s.length;o++)"checkbox"==s[o].type&&(s[o].checked=!1);f.value=[]}A()}})}),(0,h.jsx)("th",{children:"Role Type"}),(0,h.jsx)("th",{children:"Department"}),(0,h.jsx)("th",{children:"Country"}),(0,h.jsx)("th",{children:"Computed Cost"})]}),v]})})})]}),(0,h.jsx)("div",{align:"center",className:" col-md-12 mt-2",children:(0,h.jsx)("button",{ref:D,className:"btn btn-primary ".concat(_?"disabledIcon":""),disabled:_,onClick:function(e){M()},children:"Approve"})})]})};var v=function(e){var t=e.country,s=e.departments,n=e.selectedDepartments,r=e.setSelectedDepartments,o=e.roleTypes,l=e.selectedRoleTypes,i=e.setSelectedRoleTypes,d=e.formData,u=e.setFormData,p=e.getRoleWiseComputedCost,f=e.roleWiseComputedCostData,v=e.validator,x=e.setLoader;return c.N.baseUrl,(0,h.jsxs)("div",{children:[(0,h.jsx)(a.Z,{country:t,departments:s,selectedDepartments:n,setSelectedDepartments:r,roleTypes:o,formData:d,setFormData:u,selectedRoleTypes:l,setSelectedRoleTypes:i,costApprovalButtonHandler:function(){p()},validator:v}),(0,h.jsx)(m,{roleWiseComputedCostData:f,getRoleWiseComputedCost:p,setLoader:x})]})}},76683:function(e,t,s){s.d(t,{Z:function(){return p}});var n=s(4942),r=s(1413),o=s(29439),c=s(72791),a=s(36167),l=s(32125),i=s(80184);var d=function(e){var t=e.roleWiseViewState,s=e.columnData,n=(0,c.useState)([]),r=(0,o.Z)(n,2),a=r[0],l=r[1],d=(0,c.useState)(null),u=(0,o.Z)(d,2),p=u[0],h=u[1],f=(0,c.useState)([]),m=(0,o.Z)(f,2),v=m[0],x=m[1];(0,c.useEffect)((function(){void 0!==t&&l(JSON.parse(JSON.stringify(t)))}),[t]),(0,c.useEffect)((function(){j(),y()}),[a]);var j=function(){h((function(){return null===a||void 0===a?void 0:a.map((function(e,t){var s=[];return Object.keys(e).forEach((function(t,n){!1===t.includes("id")&&(null===e[t]?s.push((0,i.jsx)("td",{className:"ellpss",title:"",children:""})):t.includes("Cadre")||t.includes("Role Type")?s.push((0,i.jsx)("td",{className:"ellpss",title:e[t],children:e[t]})):s.push((0,i.jsxs)("td",{className:"ellpss",title:e[t],align:"right",children:[(0,i.jsx)("span",{style:{float:"left"},children:"$"}),(0,i.jsx)("span",{align:"right",children:e[t]})]})))})),(0,i.jsx)("tr",{children:s})}))}))},y=function(){x((function(){return s.map((function(e,t){var s=[];return Object.keys(e).forEach((function(n,r){0===t&&s.push((0,i.jsx)("th",{className:"ellpss",title:e[n],children:e[n]}))})),(0,i.jsx)("tr",{className:"headerSticky",children:s})}))}))};return(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"col-md-12 mt-2",style:{overflow:"auto",maxHeight:"450px"},children:(0,i.jsx)("table",{className:"table table-bordered table-striped pipelinetable",children:(0,i.jsxs)("tbody",{children:[v,p]})})})})},u=s(78820);var p=function(e){var t=e.country,s=e.departments,p=e.selectedDepartments,h=e.setSelectedDepartments,f=e.roleTypes,m=e.selectedRoleTypes,v=e.setSelectedRoleTypes,x=e.costApprovalButtonHandler,j=e.formData,y=e.setFormData,g=e.type,C=e.roleWiseViewAxios,_=e.roleWiseViewState,S=e.columnData,b=(e.validator,(0,c.useState)("")),Z=(0,o.Z)(b,2),k=Z[0],w=Z[1],T=(0,c.useRef)([]),N=(0,c.useRef)([]);(0,c.useEffect)((function(){}),[j]),(0,c.useEffect)((function(){}),[p]);var D=function(e,t){return e.length===s.length?"<< ALL >>":0===e.length?"<< Please Select >>":e.map((function(t){return e.length>1?t.label+",":t.label}))};return(0,i.jsxs)("div",{className:"col-xs-12 col-sm-12 col-md-12 col-lg-12 customCard",children:[k,(0,i.jsxs)("div",{class:"group-content row",children:["roleWiseView"!==g?(0,i.jsx)("div",{class:"col-md-3 mb-2",children:(0,i.jsxs)("div",{class:"form-group row",children:[(0,i.jsxs)("label",{class:"col-5",for:"BuIds",children:["Role Types",(0,i.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,i.jsx)("span",{class:"col-1 p-0",children:":"}),(0,i.jsxs)("div",{class:"col-6 multiselect",ref:function(e){T.current[0]=e},children:[" ",(0,i.jsx)(a.NU,{id:"roleTypes",options:f,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,valueRenderer:D,value:m,disabled:!1,onChange:function(e){v(e);var t=[];e.forEach((function(e){t.push(e.value)})),y((function(e){return(0,r.Z)((0,r.Z)({},e),{},(0,n.Z)({},"roleType",t.toString()))}))}})]})]})}):"",(0,i.jsx)("div",{class:"col-md-3 mb-2",children:(0,i.jsxs)("div",{class:"form-group row",children:[(0,i.jsxs)("label",{class:"col-5",for:"BuIds",children:["Country ",(0,i.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,i.jsx)("span",{class:"col-1 p-0",children:":"}),(0,i.jsxs)("div",{class:"col-6",children:[" ",(0,i.jsx)("select",{id:"country",onChange:function(e){return function(e){var t=e.target,s=t.id,o=t.value;y((function(e){return(0,r.Z)((0,r.Z)({},e),{},(0,n.Z)({},s,o))}))}(e)},style:{width:"100%"},children:t.map((function(e){return(0,i.jsx)("option",{value:e.id,selected:"India"==e.country_name,children:e.country_name},e.id)}))})]})]})}),(0,i.jsx)("div",{class:"col-md-3 mb-2",children:(0,i.jsxs)("div",{class:"form-group row",children:[(0,i.jsxs)("label",{class:"col-5",for:"BuIds",children:["Business Unit ",(0,i.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,i.jsx)("span",{class:"col-1 p-0",children:":"}),(0,i.jsx)("div",{class:"col-6 multiselect",ref:function(e){T.current[1]=e},children:(0,i.jsx)(a.NU,{id:"businessUnit",options:s,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,valueRenderer:D,value:p,disabled:!1,onChange:function(e){h(e);var t=[];e.forEach((function(e){t.push(e.value)})),y((function(e){return(0,r.Z)((0,r.Z)({},e),{},(0,n.Z)({},"departments",t.toString()))}))}})})]})}),(0,i.jsx)("div",{class:"col-md-12 col-sm-12 col-xs-12 btn-container center my-3 mb-2",children:(0,i.jsx)("button",{type:"submit",class:"btn btn-primary",title:"Search",onClick:function(){"roleWiseView"===g?function(){var e=T.current.filter((function(e){return void 0!=e}));N.current=e,(0,l.Z)(N)?w((0,i.jsxs)("div",{className:"col-md-12 statusMsg error",children:[(0,i.jsx)(u.CSE,{}),(0,i.jsx)("span",{children:"Please Select Mandatory Fields"})]})):(w(""),C())}():function(){var e=T.current.filter((function(e){return void 0!=e}));N.current=e,(0,l.Z)(N)?w((0,i.jsxs)("div",{className:"col-md-12 statusMsg error",children:[(0,i.jsx)(u.CSE,{}),(0,i.jsx)("span",{children:"Please Select Mandatory Fields"})]})):(w(""),x())}()},children:"Search"})})]}),"roleWiseView"===g&&S.length>0&&(0,i.jsx)(d,{roleWiseViewState:_,columnData:S})]})}},61350:function(e,t,s){s.r(t);var n=s(74165),r=s(15861),o=s(29439),c=s(74569),a=s.n(c),l=s(72791),i=s(34831),d=s(83854),u=s(92333),p=(s(85565),s(80184));t.default=function(){var e=window.location.href,t=(0,l.useState)([]),s=(0,o.Z)(t,2),c=s[0],h=s[1],f=(0,l.useState)([]),m=(0,o.Z)(f,2),v=m[0],x=m[1],j=(0,l.useState)([]),y=(0,o.Z)(j,2),g=y[0],C=y[1],_=(0,l.useState)([]),S=(0,o.Z)(_,2),b=(S[0],S[1]),Z=(0,l.useState)([]),k=(0,o.Z)(Z,2),w=(k[0],k[1]),T=(0,l.useState)([]),N=(0,o.Z)(T,2),D=N[0],E=N[1],R=(0,l.useState)([]),W=(0,o.Z)(R,2),B=W[0],M=W[1],A=(0,l.useState)([]),I=(0,o.Z)(A,2),L=I[0],O=I[1],H=(0,l.useState)(!1),U=(0,o.Z)(H,2),F=U[0],P=U[1],V=(document.getElementsByClassName("container-fluid"),(0,l.useState)({roleType:"",country:3,departments:""})),J=(0,o.Z)(V,2),Y=J[0],$=J[1],q=(0,l.useState)(!1),z=(0,o.Z)(q,2),G=z[0],K=z[1],Q=localStorage.getItem("resId"),X=i.N.baseUrl,ee=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,s,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a()({url:X+"/CostMS/cost/getDepartments"});case 2:t=e.sent,(s=t.data).push({value:999,label:"Non-Revenue Units"}),x(s),C(s),r=[],s.forEach((function(e){r.push(e.value)})),Y.departments=r.toString();case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){ne(),te()}),[]);var te=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://geolocation-db.com/json/").then((function(e){return e.json()}),"jsonp").then((function(e){se(e.IPv4)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(t){var s={},n=e.split("#");s.ipAddress=t,s.userId=Q,s.url=n[1],a()({method:"POST",url:X+"/CostMS/cost/saveLoginTracks",data:s}).then((function(e){}))},ne=function(){var t=(0,r.Z)((0,n.Z)().mark((function t(){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,oe();case 2:return t.next=4,ee();case 4:return t.next=6,void a()({url:X+"/CostMS/cost/getCountries"}).then((function(e){h(e.data)}));case 6:if(!e.includes("roleApprovals")){t.next=11;break}return t.next=9,re();case 9:t.next=13;break;case 11:return t.next=13,ce();case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),re=function(){K(!1),P(!0),a()({method:"POST",url:X+"/CostMS/cost/getRoleWiseComputedCost",data:Y}).then((function(e){O(e.data),P(!1)}))};(0,l.useEffect)((function(){}),[L]);var oe=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,s,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a()({url:X+"/CostMS/cost/getRoleTypes"});case 2:t=e.sent,s=t.data,M(s),E(s),r=[],s.forEach((function(e){r.push(e.value)})),Y.roleType=r.toString();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=function(e){void 0!==e&&(Y.departments=e),Y.roleType="0",a()({method:"POST",url:X+"/CostMS/cost/roleWiseView",data:Y}).then((function(e){for(var t=e.data.roleWiseComputedCost,s=e.data.computedCostColumns.split(","),n=[],r={},o={},c=0;c<s.length-1;c++){var a;if(!1===s[c].includes("id"))r[s[c]]=null===(a=s[c])||void 0===a?void 0:a.replaceAll("_ComputedCost","").replaceAll("_"," "),o[s[c]]="ComputedCost"}n.push(r),n.push(o),b(n);for(var l=[],i=0;i<t.length;i++){t[i];for(var d={},u=0;u<s.length-1;u++)d[s[u]]=t[i][s[u]];l.push(d)}w(l)}))};return(0,p.jsxs)("div",{children:[F?(0,p.jsx)(d.Z,{}):"",(0,p.jsx)(u.Z,{country:c,departments:v,selectedDepartments:g,setSelectedDepartments:C,roleTypes:B,selectedRoleTypes:D,setSelectedRoleTypes:E,formData:Y,setFormData:$,getRoleWiseComputedCost:re,roleWiseComputedCostData:L,validator:G,setLoader:P})]})}}}]);
//# sourceMappingURL=1350.824c446c.chunk.js.map