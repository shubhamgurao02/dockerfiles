"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[3586],{83586:function(e,t,n){n.r(t);var a=n(4942),l=n(1413),s=n(29439),i=n(72791),r=n(36167),o=n(59513),c=n.n(o),u=n(56355),d=n(78983),m=n(72426),h=n.n(m),p=n(74569),f=n.n(p),x=n(34831),v=n(83854),g=n(78820),j=n(32125),b=n(224),S=n(17425),N=n(39126),y=n(38262),Z=n(25415),E=n.n(Z),D=n(80184);t.default=function(){var e=x.N.baseUrl,t=(0,i.useState)(!1),n=(0,s.Z)(t,2),o=n[0],m=n[1],p=(0,i.useState)(u.UdN),Z=(0,s.Z)(p,2),w=Z[0],_=Z[1],C=(0,i.useState)([]),k=(0,s.Z)(C,2),A=k[0],M=k[1],I=(0,i.useState)([]),R=(0,s.Z)(I,2),U=R[0],T=R[1],F=(0,i.useState)([]),P=(0,s.Z)(F,2),z=P[0],H=P[1],O=(0,i.useState)([]),V=(0,s.Z)(O,2),B=V[0],L=V[1],W=(0,i.useState)(!1),q=(0,s.Z)(W,2),Y=q[0],K=q[1],$=(0,i.useState)([]),G=(0,s.Z)($,2),J=G[0],Q=G[1],X=(0,i.useState)(!1),ee=(0,s.Z)(X,2),te=ee[0],ne=ee[1],ae=(0,i.useState)(!1),le=(0,s.Z)(ae,2),se=le[0],ie=le[1],re=(0,i.useState)([]),oe=(0,s.Z)(re,2),ce=oe[0],ue=oe[1],de=(0,i.useState)([]),me=(0,s.Z)(de,2),he=(me[0],me[1]),pe=(0,i.useState)([]),fe=(0,s.Z)(pe,2),xe=(fe[0],fe[1]),ve=localStorage.getItem("resId"),ge=(0,i.useState)(!1),je=(0,s.Z)(ge,2),be=je[0],Se=je[1];console.log(te,"loader"),console.log(be,"tableVisible");var Ne=(0,i.useRef)([]),ye=(0,i.useRef)(null),Ze=function(){var e=new Date,t=e.getDay(),n=e.getDate()-t+(0===t?-6:1);return new Date(e.setDate(n))}(),Ee=(0,i.useState)(Ze),De=(0,s.Z)(Ee,2),we=De[0],_e=De[1],Ce={businessUnit:"-1",customer:"",StartDt:h()(we).format("yyyy-MM-DD"),duration:"1",isExport:"0"},ke=(0,i.useState)(Ce),Ae=(0,s.Z)(ke,2),Me=Ae[0],Ie=Ae[1],Re=(0,i.useState)([]),Ue=(0,s.Z)(Re,2),Te=Ue[0],Fe=Ue[1],Pe=document.getElementById("customer");if(Pe){Pe.addEventListener("change",(function(){var e=Pe.options[Pe.selectedIndex];if(e){var t=e.getAttribute("title");Pe.setAttribute("title",t)}else Pe.removeAttribute("title")}))}var ze=(0,i.useState)([]),He=(0,s.Z)(ze,2),Oe=He[0],Ve=He[1];(0,i.useEffect)((function(){f().get(e+"/CostMS/cost/getDepartments").then((function(e){var t=[],n=e.data;n.length>0&&n.forEach((function(e){var n={label:e.label,value:e.value};t.push(n)})),T(t),M(t)})),f().get(e+"/CommonMS/master/getMenus?loggedUserId=".concat(ve)).then((function(e){var t=e.data;he(t),t.filter((function(e){return!!e.subMenus&&e.subMenus.some((function(e){return"Engagement Allocations"===e.display_name}))})),t.forEach((function(e){"Delivery"===e.display_name&&Ve([e])}));var n=t.find((function(e){return"Delivery"===e.display_name})).subMenus.find((function(e){return"Engagement Allocations"===e.display_name}));xe(n.access_level);var a=n?n.userRoles.includes("690")?690:n.userRoles.includes("641")?641:n.userRoles.includes("46")?46:n.userRoles.includes("930")&&930:null;ue(a)})),Be()}),[]);var Be=function(){f().get(641==ce||690==ce||930==ce?e+"/dashboardsms/allocationDashboard/getCustomers?loggedUserId=".concat(ve):46==ce?e+"/CommonMS/master/getPMCustomers?loggedUserId=".concat(ve):e+"/customersms/Customers/getCustomers").then((function(e){var t=e.data.filter((function(e){return 81084541!==e.id}));H(t)}))};(0,i.useEffect)((function(){641!=ce&&690!=ce&&930!=ce&&46!=ce||Be()}),[ce]);var Le=function(e){var t=e.target,n=t.name,s=t.value;Ie((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,a.Z)({},n,s))}))},We=function(e){var t=e.value,n=e.onClick;return(0,D.jsx)("input",{type:"text",className:"",value:t,placeholder:"",readOnly:!0,onClick:n})};return(0,D.jsxs)("div",{children:[Y?(0,D.jsxs)("div",{className:"statusMsg error",children:[" ",(0,D.jsx)(g.CSE,{})," Please select valid values for highlighted fields"]}):"",(0,D.jsx)("div",{className:"col-md-12",children:(0,D.jsxs)("div",{className:"pageTitle",children:[(0,D.jsx)("div",{className:"childOne"}),(0,D.jsx)("div",{className:"childTwo",children:(0,D.jsx)("h2",{children:"Engagement Allocations"})}),(0,D.jsx)("div",{className:"childThree"})]})}),(0,D.jsx)(y.Z,{routes:Oe,currentScreenName:["Engagement Allocations"]}),(0,D.jsxs)("div",{className:"group mb-3 customCard ",children:[(0,D.jsxs)("div",{className:"col-md-12 collapseHeader",children:[(0,D.jsx)("h2",{children:"Search Filters"}),(0,D.jsx)("div",{onClick:function(){m(!o),_(o?u.UdN:u.NR5)},children:(0,D.jsx)("span",{children:w})})]}),(0,D.jsx)(d.V9,{visible:!o,children:(0,D.jsxs)("div",{className:"group-content row",children:[(0,D.jsx)("div",{className:" col-md-3 mb-2",children:(0,D.jsxs)("div",{className:"form-group row",children:[(0,D.jsxs)("label",{className:"col-5",htmlFor:"businessunit",children:["Business Unit\xa0",(0,D.jsx)("span",{className:"error-text",children:" *"})]}),(0,D.jsx)("span",{className:"col-1 p-0",children:":"}),(0,D.jsx)("div",{className:"col-6 multiselect",ref:function(e){Ne.current[0]=e},children:(0,D.jsx)(r.NU,{ArrowRenderer:function(e){e.expanded;return(0,D.jsx)(D.Fragment,{children:(0,D.jsx)(u.qL$,{className:"chevronIcon"})})},id:"businessUnit",options:U,value:A,disabled:!1,valueRenderer:function(e,t){var n=e.map((function(e){return e.value})),a=t.map((function(e){return e.value}));return n.length===a.length?"<< ALL >>":e.map((function(e){return e.label})).join(", ")},onChange:function(e){M(e);var t=[];e.forEach((function(e){t.push(e.value)})),Ie((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,a.Z)({},"businessUnit",t.toString()))}))}})})]})}),(0,D.jsx)("div",{className:" col-md-3 mb-2",children:(0,D.jsxs)("div",{className:"form-group row",children:[(0,D.jsxs)("label",{className:"col-5",htmlFor:"customers ",children:["Customers\xa0",(0,D.jsx)("span",{className:"error-text",children:"*"})]}),(0,D.jsx)("span",{className:"col-1 p-0",children:":"}),(0,D.jsx)("div",{className:"col-6",children:(0,D.jsxs)("select",{ref:function(e){Ne.current[1]=e},className:"cancel text ellipsis title",name:"customer",id:"customer",onChange:Le,children:[(0,D.jsx)("option",{value:"",children:" <<Please Select>>"}),null===z||void 0===z?void 0:z.map((function(e,t){return(0,D.jsx)("option",{value:e.id,title:e.full_name,children:e.name},t)}))]})})]})}),(0,D.jsx)("div",{className:"col-md-3 mb-2 ",children:(0,D.jsxs)("div",{className:"form-group row ",children:[(0,D.jsxs)("label",{className:"col-5",htmlFor:"StartDt",children:["Start Week\xa0",(0,D.jsx)("span",{className:"error-text",children:"*"})]}),(0,D.jsx)("span",{className:"col-1 p-0",children:":"}),(0,D.jsx)("div",{className:"col-6",children:(0,D.jsx)("div",{style:{position:"relative",zIndex:"999"},children:(0,D.jsx)(c(),{selected:we,showMonthDropdown:!0,showYearDropdown:!0,onChange:function(e){Ie((function(t){return(0,l.Z)((0,l.Z)({},t),{},(0,a.Z)({},"StartDt",h()(e).format("yyyy-MM-DD")))})),_e(e)},filterDate:function(e){return 1===e.getDay()},dateFormat:"dd-MMM-yyyy",dropdownMode:"select",customInput:(0,D.jsx)(We,{})})})})]})}),(0,D.jsx)("div",{className:" col-md-3 mb-3",children:(0,D.jsxs)("div",{className:"form-group row",children:[(0,D.jsxs)("label",{className:"col-5",htmlFor:"duration",children:["Duration\xa0",(0,D.jsx)("span",{className:"error-text",children:"*"})]}),(0,D.jsx)("span",{className:"col-1 p-0",children:":"}),(0,D.jsx)("div",{className:"col-6",children:(0,D.jsxs)("select",{name:"duration",id:"duration",onChange:Le,children:[(0,D.jsx)("option",{value:"1",children:"1"}),(0,D.jsx)("option",{value:"2",children:"2"}),(0,D.jsx)("option",{value:"3",children:"3"}),(0,D.jsx)("option",{value:"4",children:"4"}),(0,D.jsx)("option",{value:"5",children:"5"}),(0,D.jsx)("option",{value:"6",children:"6"}),(0,D.jsx)("option",{value:"7",children:"7"}),(0,D.jsx)("option",{value:"8",children:"8"}),(0,D.jsx)("option",{value:"9",children:"9"}),(0,D.jsx)("option",{value:"10",children:"10"}),(0,D.jsx)("option",{value:"11",children:"11"}),(0,D.jsx)("option",{value:"12",children:"12"})]})})]})}),(0,D.jsx)("div",{className:"col-md-12 col-sm-12 col-xs-12 btn-container center",children:(0,D.jsxs)("button",{type:"submit",className:"btn btn-primary",onClick:function(){var t=(0,j.Z)(Ne);t?K(!0):t||(ne(!1),ie(!0),Se(!1),ye.current=new AbortController,f()({method:"post",url:e+"/administrationms/engagementallocation/getengagementallocationtable?bu=".concat(Me.businessUnit,"&customerId=").concat(Me.customer,"&fromWeek=").concat(Me.StartDt,"&dur=").concat(Me.duration,"&isExport=0&userId=").concat(ve),signal:ye.current.signal}).then((function(e){var n,a=e.data.tableData,l=null===(n=e.data.columns)||void 0===n?void 0:n.replaceAll("'","").split(",");L(a),Fe(e.data),Q(l),ne(!1),Se(!0),K(!1),!t&&m(!o),_(o?u.UdN:u.NR5)})))},children:[(0,D.jsx)(u.U41,{})," Search"," "]})})]})}),te?(0,D.jsx)(v.Z,{handleAbort:function(){ye.current&&ye.current.abort(),ne(!1)}}):""]}),!0===se?(0,D.jsx)("div",{className:"col-md-12 clearfix",style:{height:"5px"},children:(0,D.jsx)("div",{children:(0,D.jsx)("span",{children:(0,D.jsxs)("span",{style:{color:"#9d7c42",fontStyle:"italic"},children:[(0,D.jsx)(N.Hfo,{style:{marginTop:"-5px"}})," All numbers are in hours"]})})})}):"",!0===se?(0,D.jsx)("div",{className:"mb-2",align:" right ",children:(0,D.jsx)(S.WlY,{size:"1.5em",title:"Export to Excel",style:{color:"green"},cursor:"pointer",onClick:function(){var e=[],t=J.join(",");e=t.split(",");var n=B.map((function(t){var n={};return e.forEach((function(e){var a=t[e];if("string"===typeof a){var l=a.split("^&"),i=(0,s.Z)(l,2)[0];n[e]=i}else n[e]=a})),n})),a=(n.map((function(t){var n=[];return e.forEach((function(e){n.push(t[e])})),n})),new(E().Workbook)),l=a.addWorksheet("Engagement Dashboard");n.forEach((function(e){l.addRow(Object.values(e))}));[1].forEach((function(e){l.getRow(e).font={bold:!0}})),a.xlsx.writeBuffer().then((function(e){saveAs(new Blob([e]),"Engagement Dashboard.xlsx")}))}})}):"",(0,D.jsx)("div",{className:"col-md-12 ",children:0==te&&1==be?(0,D.jsx)(b.Z,{data:Te,expandedCols:["engStatus","prjStatus","prjStartDt","prjEndDt","roleName","roleStDt","roleEdDt","prjMgr"],colExpandState:["0","0","name"]}):""})]})}},224:function(e,t,n){n.d(t,{Z:function(){return g}});var a=n(93433),l=n(1413),s=n(4942),i=n(29439),r=n(72791),o=n(11683),c=n(13400),u=n(49177),d=n(34911),m=n(56637),h=n(53824),p=n(48462),f=n(59170),x=n(7692),v=n(80184);function g(e){var t={fte0:(0,v.jsx)("img",{src:d,alt:"(fte_inactive_icon)",style:{height:"12px",float:"left"},title:"Ex-Employee"}),fte1:(0,v.jsx)("img",{src:u,alt:"(fte_active_icon)",style:{height:"12px",float:"left"},title:"Active Employee"}),fte2:(0,v.jsx)("img",{src:m,alt:"(fte_notice_icon)",style:{height:"12px",float:"left"},title:"Employee in notice period"}),subk0:(0,v.jsx)("img",{src:p,alt:"(subk_inactive_icon)",style:{height:"12px",float:"left"},title:"Ex-Contractor"}),subk1:(0,v.jsx)("img",{src:h,alt:"(subk_active_icon)",style:{height:"12px",width:"auto",float:"left"},title:"Active Contractor",size:"1em"}),subk2:(0,v.jsx)("img",{src:f,alt:"(subk_notice_icon)",style:{height:"12px",float:"left"},title:"Contractor in notice period"})},n=e.data,g=e.expandedCols,j=e.colExpandState,b=(0,r.useState)([]),S=(0,i.Z)(b,2),N=S[0],y=S[1],Z=(0,r.useState)(null),E=(0,i.Z)(Z,2),D=E[0],w=E[1],_=(0,r.useState)({}),C=(0,i.Z)(_,2),k=C[0],A=C[1],M=(0,r.useState)(!1),I=(0,i.Z)(M,2),R=I[0],U=I[1],T=(0,r.useState)([]),F=(0,i.Z)(T,2),P=(F[0],F[1]),z=function(e){var t=String(e);if(t.includes(".")){var n=Number(t),a=(null!=n&&n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:20})).split(".");return a[0]=a[0].replace(/(?<=\d)(?=(\d{3})+(?!\d|\.))/g,","),a.join(".")}return null!=t&&parseFloat(t).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:20}).replace(/(?<=\d)(?=(\d{3})+(?!\d|\.))/g,",")};(0,r.useEffect)((function(){H()}),[n]);var H=function(){var e,a;var l,r=n.tableData,o=null;null!==n&&void 0!==n&&null!==(e=n.columns)&&void 0!==e&&e.includes("'")?o=null===n||void 0===n||null===(l=n.columns)||void 0===l?void 0:l.replaceAll("'",""):o=null===n||void 0===n?void 0:n.columns;for(var u=null===(a=o)||void 0===a?void 0:a.split(","),d=[],m=[],h={},p=0;p<(null===u||void 0===u?void 0:u.length);p++){var f=u[p].trim(),b=r[0];h[f]=b[f]}var S=Object.entries(h).filter((function(e){var t=(0,i.Z)(e,2),n=(t[0],t[1]);return"string"===typeof n&&n.includes("^&")}));P(S),S.map((function(e){var t=(0,i.Z)(e,2),n=t[0];t[1];g.includes(n)&&m.push((0,s.Z)({},n,!1))})),A(Object.assign.apply(Object,[{}].concat(m))),S.map((function(e,n){var a=(0,i.Z)(e,2),l=a[0],s=a[1];d.push({accessorKey:l,header:s.split("^&")[0],enableColumnActions:!1,enableHiding:!0,Header:function(e){e.column;return(0,v.jsxs)("div",{children:[s.split("^&")[0]," ",l==j[2]?(0,v.jsx)(c.Z,{className:"expandIcon",title:"Show Details",onClick:function(){U((function(e){return!e}))},children:R?(0,v.jsx)(x.gbs,{}):(0,v.jsx)(x.lU2,{})}):""]})},Cell:function(e){var n=e.cell;return(0,v.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:n.getValue(),className:l.includes("_")?l.split("_")[1]%2==0?"":"odd":l.includes("total")?"total":("roleName"==l||"prjMgr"==l)&&"projManager",children:"name"==n.column.id&&null!=n.row.original.parentId?(0,v.jsxs)("span",{className:"rescolor",children:[t[n.row.original.empStatus],"\xa0",n.getValue()]}):l.includes("_")&&l.split("_")[2]||l.includes("total")?z(n.getValue()):n.getValue()})}})})),w(d);var N=[];null===r||void 0===r||r.map((function(e,t){return t>0&&-1!=e.id?N.push(e):""})),y(O(N,{children:"subRows"}))};(0,r.useEffect)((function(){R?(H(),A({})):H()}),[R]);var O=function(e,t){t=(0,l.Z)({id:"uniqueId",parentId:"parentId",children:"subRows"},t);var n={},i=[],r=t.children;return e.forEach((function(e){var a=e[t.id],i=e[t.parentId];n[a]=(0,l.Z)((0,l.Z)((0,s.Z)({},r,[]),e),n[a]),n[i]=n[i]||(0,s.Z)({},r,[]),n[i][r].push(n[a])})),Object.values(n).forEach((function(e){"undefined"===typeof e[t.id]&&i.push.apply(i,(0,a.Z)(e[r]))})),i};return(0,v.jsx)("div",{className:"materialReactExpandableTable engagementAllocationsTable darkHeader",children:null!==D&&void 0!==D&&D.length?(0,v.jsx)(o.ZP,{columns:D,data:N,enableExpandAll:!0,enableExpanding:!0,enablePagination:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!1,filterFromLeafRows:!0,initialState:{expanded:!1,density:"compact",columnVisibility:(0,l.Z)({},k),columnPinning:{right:["total"]}},state:{columnVisibility:(0,l.Z)({},k)},defaultColumn:{minSize:40,maxSize:1e3,size:40},enableStickyHeader:!0,muiTableContainerProps:{sx:{maxHeight:"70vh",width:"auto",maxWidth:"fit-content"}},muiTableBodyProps:{sx:{"&":{},"& td":{borderRight:"1px solid #ccc",height:"22px",fontSize:"11px",paddingTop:"0px",paddingBottom:"0px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",fontSize:"13px",padding:"0px 8px"}}}}):null})}}}]);
//# sourceMappingURL=3586.5e647933.chunk.js.map