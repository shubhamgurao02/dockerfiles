"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[6989],{36989:function(e,n,r){r.r(n),r.d(n,{default:function(){return K}});var s=r(74165),t=r(15861),i=r(4942),a=r(1413),l=r(29439),o=r(72791),c=r(36167),u=r(74569),d=r.n(u),p=r(34831),m=r(59513),f=r.n(m),g=(r(68639),r(72426)),h=r.n(g),v=r(59831),x=r(63521),y=r(56355),j=r(58617),b=r(32125),R=r(93433),Z=r(11683),T=(r(79122),r(83854)),w=r(17425),C=r(80184);var k=function(e){var n=e.tableData,s=e.column,t=e.departments,c=e.selectType,u=e.month,m=e.searchdata,f=e.project,g=e.customer,v=e.resources,x=e.sortBy,j=e.laterMeasureLabel,b=e.defaultMeasureLabel,k=p.N.baseUrl,N=(0,o.useRef)(null),I=(0,o.useState)(!1),S=(0,l.Z)(I,2),E=S[0],B=S[1],M=s[0],U=s[1],D=s.slice(2).sort(),V=[M,U].concat((0,R.Z)(D),["Total"]),P=(0,o.useState)(V),A=(0,l.Z)(P,2),F=A[0],L=A[1],G=(0,o.useState)([]),O=(0,l.Z)(G,2),_=O[0],z=O[1];(0,o.useEffect)((function(){L(e.column)}),[e.column]),(0,o.useEffect)((function(){for(var e=1,r=0;r<n.length;r++)n[r].id=e,++e%1e4==17&&(e+=9984);z(q(n))}),[n]);var K=h()(u).startOf("month").format("yyyy-MM-DD"),q=function(e,n){n=(0,a.Z)({id:"id",parentId:"parentId",children:"subRows"},n);var r={},s=[],t=n.children;return e.forEach((function(e){var s=e[n.id],l=e[n.parentId];r[s]=(0,a.Z)((0,a.Z)((0,i.Z)({},t,[]),e),r[s]),r[l]=r[l]||(0,i.Z)({},t,[]),r[l][t].push(r[s])})),Object.values(r).forEach((function(e){"undefined"===typeof e[n.id]&&s.push.apply(s,(0,R.Z)(e[t]))})),s},H=[{header:(0,C.jsxs)("div",{className:"legendContainer wrap",children:[(0,C.jsxs)("div",{className:"legend lightbrown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"BU"})})]}),(0,C.jsxs)("div",{className:"legend darkgreen",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Customer"})})]}),(0,C.jsxs)("div",{className:"legend purple",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Project"})})]}),(0,C.jsxs)("div",{className:"legend brown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Res"})})]})]}),accessorKey:"name",enableGrouping:!1,GroupedCell:function(e){var n=e.cell;if("BusinessUnit"==c){var r,s,u,p,h,Z,T=t.find((function(e){return e.label===n.getValue()})),w=(0,o.useState)({}),I=(0,l.Z)(w,2),S=I[0],E=I[1],M=function(){if(T){var e=T.value,n=T.label;_.some((function(n){return n.name.includes("*".concat(e))}))?(E((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),z((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(E((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r){console.log("ghjklkjhgfdsdfghjk"),N.current=new AbortController;var s=setTimeout((function(){B(!0)}),2e3);d()({method:"post",url:k+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:K,duration:m.duration,countries:m.countries,searchType:m.searchType,busUnits:m.busUnits,customers:"select"==m.customers?selectedCust:m.customers,srcType:m.searchType,srcTypeId:e,tarType:r,busUnitId:e,custId:m.custId,prjId:m.prjId,resId:m.resId,measures:m.measures,salesExecId:m.salesExecId,salesExecs:-1,sortBy:m.sortBy,custCountries:m.custCountries,source:m.source,resTyp:m.resTyp,engCountries:m.engCountries,contTerms:m.contTerms,engComp:m.engComp,cslRes:m.cslRes,cslResId:m.cslResId,dpRes:-1,dpResId:m.dpResId,indTypes:-1,indTypesId:m.indTypesId},signal:N.current.signal}).then((function(t){B(!1),clearTimeout(s);var i=t.data.data;i=(i=i.filter((function(e){return""!==e.name}))).map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r})})),z((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=m.measures?e.descr==("Head Count"==j?"hcsubk":"Billable Utilization"==j?"busubk":"Billed Utilization"==j?"bdusubk":j)&&e.name===n:-1==m.sortBy?e.kpi===b&&e.name===n:x.some((function(r){return e.kpi===(r.id==m.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){B(!1)}))}(e,n,"Customer"))}},U=g.find((function(e){if(e.fullName===n.getValue().split("*")[0]){var s=n.getValue().split("*")[1];r=s}return e.fullName===n.getValue().split("*")[0]})),D=(0,o.useState)({}),V=(0,l.Z)(D,2),P=V[0],A=V[1],F=function(){if(U){var e=U.id,n=U.fullName;_.some((function(n){return n.name.includes("*".concat(e))}))?(A((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),z((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(A((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t){var i=setTimeout((function(){B(!0)}),2e3);N.current=new AbortController,d()({method:"post",url:k+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:K,duration:m.duration,countries:m.countries,searchType:"BusinessUnit",busUnits:m.busUnits,customers:"select"==m.customers?selectedCust:m.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:t,custId:e,prjId:m.prjId,resId:m.resId,measures:m.measures,salesExecId:m.salesExecId,salesExecs:-1,sortBy:m.sortBy,custCountries:m.custCountries,source:m.source,resTyp:m.resTyp,engCountries:m.engCountries,contTerms:m.contTerms,engComp:m.engComp,cslRes:m.cslRes,cslResId:m.cslResId,dpRes:-1,dpResId:m.dpResId,indTypes:-1,indTypesId:m.indTypesId},signal:N.current.signal}).then((function(s){B(!1),clearTimeout(i);var l=s.data.data;l=l.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t})})),z((function(r){var s=r.findIndex((function(e){return-1==m.sortBy?e.kpi===b&&e.name.split("*")[0]===n:x.some((function(r){return e.kpi===(r.id==m.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(l.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){B(!1)}))}(e,n,"Project","Customer",r))}},L=f.find((function(e){if(e.name===n.getValue().split("*")[0]){var r=n.getValue().split("*")[3];s=r,u=n.getValue().split("*")[1]}return e.name===n.getValue().split("*")[0]})),G=(0,o.useState)({}),O=(0,l.Z)(G,2),q=O[0],H=O[1],$=function(){if(L){var e=L.id,n=L.name;_.some((function(n){return n.name.includes("*".concat(e))}))?(H((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),z((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(H((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t,i){var l=setTimeout((function(){B(!0)}),2e3);N.current=new AbortController,d()({method:"post",url:k+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:K,duration:m.duration,countries:m.countries,searchType:"BusinessUnit",busUnits:m.busUnits,customers:"select"==m.customers?selectedCust:m.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:t,custId:i,prjId:e,resId:m.resId,measures:m.measures,salesExecId:m.salesExecId,salesExecs:-1,sortBy:m.sortBy,custCountries:m.custCountries,source:m.source,resTyp:m.resTyp,engCountries:m.engCountries,contTerms:m.contTerms,engComp:m.engComp,cslRes:m.cslRes,cslResId:m.cslResId,dpRes:-1,dpResId:m.dpResId,indTypes:-1,indTypesId:m.indTypesId},signal:N.current.signal}).then((function(s){B(!1),clearTimeout(l);var o=s.data.data;o=o.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t+"*"+i})})),z((function(r){var s=r.findIndex((function(e){return-1==m.sortBy?e.kpi===b&&e.name.split("*")[0]===n:x.some((function(r){return e.kpi===(r.id==m.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(o.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){B(!1)}))}(e,n,"Res","Project",s,u))}},W=v.find((function(e){if(e.fullName===n.getValue().split("*")[0]){var r=n.getValue().split("*")[3];h=n.getValue().split("*")[1],Z=n.getValue().split("*")[4],p=r}var s=e.fullName.split("*")[0].split(" "),t=n.getValue().split("*")[0].split(" ");return""==n.getValue().split("*")[0]?"":t.every((function(e){return s.includes(e)}))})),Y=(0,o.useState)({}),J=(0,l.Z)(Y,2),X=J[0],Q=J[1],ee=function(){if(W){var e=W.id,n=W.fullName;_.some((function(n){return n.name.includes("*".concat(e))}))?(Q((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),z((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(Q((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t,i,l){var o=setTimeout((function(){B(!0)}),2e3);N.current=new AbortController,d()({method:"post",url:k+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:K,duration:m.duration,countries:m.countries,searchType:"BusinessUnit",busUnits:m.busUnits,customers:"select"==m.customers?selectedCust:m.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:t,custId:l,prjId:i,resId:-1,measures:m.measures,salesExecId:m.salesExecId,salesExecs:-1,sortBy:m.sortBy,custCountries:m.custCountries,source:m.source,resTyp:m.resTyp,engCountries:m.engCountries,contTerms:m.contTerms,engComp:m.engComp,cslRes:m.cslRes,cslResId:m.cslResId,dpRes:-1,dpResId:m.dpResId,indTypes:-1,indTypesId:m.indTypesId},signal:N.current.signal}).then((function(s){B(!1),clearTimeout(o);var i=s.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t})})),z((function(r){var s=r.findIndex((function(e){return-1==m.sortBy?e.kpi===b&&e.name.split("*")[0]===n:x.some((function(r){return e.kpi===(r.id==m.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){B(!1)}))}(e,n,"Leaf","Res",p,h,Z))}};if(T){var ne=S[T.value];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:T.value,onClick:function(){null!=n.row.original.count&&M()},className:"parent",children:[null==n.row.original.count?"":ne?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"buRM",title:T.label+(null==n.row.original.count?"":" ("+n.row.original.count+")"),children:[T.label," ",null==n.row.original.count||0==n.row.original.count?"":"("+n.row.original.count+")"]})]})}if(U){var re=P[U.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:U.id,onClick:function(){F()},className:"parent",children:[re?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"custRM",title:U.fullName+" ("+n.row.original.count+")",children:[U.fullName," (",n.row.original.count,")"]})]})}if(L){var se=q[L.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:L.id,onClick:function(){$()},className:"parent",children:[se?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"projRM",title:L.name+" ("+n.row.original.count+")",children:[L.name," (",n.row.original.count,")"]})]})}if(W){var te=X[W.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:W.id,onClick:function(){ee()},className:"parent",children:[te?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsx)("b",{className:"resRM",title:W.fullName+" ("+n.row.original.count+")",children:W.fullName})]})}return(0,C.jsxs)("span",{className:"child",title:""===n.row.original.name?"Summary":n.getValue().split("*")[0]+" ("+n.row.original.count+")",children:[(0,C.jsxs)("b",{className:"Customer"===n.getValue().split("*")[2]?"buRM":"Project"==n.getValue().split("*")[2]?"custRM":"Res"==n.getValue().split("*")[2]?"projRM":"Leaf"==n.getValue().split("*")[2]?"resRM":"",style:{display:""==n.row.original.name||""==n.getValue().split("*")[0]?"flex":"",justifyContent:""==n.row.original.name||""==n.getValue().split("*")[0]?"center":""},children:[""==n.row.original.name||""==n.getValue().split("*")[0]?"Summary":(0,C.jsxs)("div",{onClick:F,children:[(0,C.jsx)(y.jS6,{})," ",n.getValue().split("*")[0]]})," ",0===n.row.original.count?"":"(".concat(n.row.original.count,")")]})," "]})}}},{header:"",accessorKey:"kpi",Cell:function(e){var n=e.cell,r=t.find((function(e){return e.label===n.row.original.name})),s=g.find((function(e){return e.fullName===n.row.original.name.split("*")[0]})),i=f.find((function(e){return e.name===n.row.original.name.split("*")[0]})),a=v.find((function(e){var r=e.fullName.split("*")[0].split(" "),s=n.row.original.name.split("*")[0].split(" ");return""==n.row.original.name.split("*")[0]?"":s.every((function(e){return r.includes(e)}))}));return r?(0,C.jsx)("span",{children:(0,C.jsx)("b",{className:"buRMchild",children:n.getValue()})}):s?(0,C.jsx)("span",{children:(0,C.jsx)("b",{className:"custRMchild",children:n.getValue()})}):i?(0,C.jsx)("span",{children:(0,C.jsx)("b",{className:"projRMchild",children:n.getValue()})}):a?(0,C.jsx)("span",{children:(0,C.jsx)("b",{className:"resRMchild",children:n.getValue()})}):(0,C.jsx)("span",{children:(0,C.jsx)("b",{className:"Project"==n.row.original.name.split("*")[2]?"custRMchild":"Res"==n.row.original.name.split("*")[2]?"projRMchild":"Leaf"==n.row.original.name.split("*")[2]?"resRMchild":"",children:n.getValue()})})}}];F.forEach((function(e,n){if(n>1&&"Total"!==e){var r=new Date("".concat(e.slice(0,4),"-").concat(e.slice(5,7),"-").concat(e.slice(8,10))).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),s=(new Date).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),t=new Date(r)>=new Date(s);H.push({header:r,accessorKey:"".concat(e),className:"software",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)("span",{className:t?"greenColumn":"",children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:"$"}):"",(0,C.jsxs)("span",{style:{display:"block",float:"right"},children:[null==r.getValue()?0:null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:"%"}):""]})]})}})}}));var $=H.length,W={header:"Total",accessorKey:"Total",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)(C.Fragment,{children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:(0,C.jsx)("b",{children:"$"})}):"",(0,C.jsx)("span",{style:{display:"block",float:"right"},className:"total",children:(0,C.jsxs)("b",{children:[null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:null==r.getValue()?0:"%"}):""]})})]})}};return H.splice($,0,W),(0,C.jsxs)("div",{className:"materialReactExpandableTable headCountTable darkHeader",children:[(0,C.jsx)("div",{className:"mb-2",align:" right ",children:(0,C.jsx)(w.WlY,{size:"1.5em",title:"Export to Excel",style:{color:"green"},cursor:"pointer",onClick:function(){Promise.resolve().then(r.t.bind(r,25415,23)).then((function(e){var n=new e.Workbook,r=n.addWorksheet("Revenue Analysis"),s=[];(s=F).sort((function(e,n){var r=e.split("_"),s=(0,l.Z)(r,3),t=s[1],i=s[2],a=n.split("_"),o=(0,l.Z)(a,3),c=o[1],u=o[2];return t!==c?parseInt(t)-parseInt(c):parseInt(i)-parseInt(u)}));var t=F.concat(_).map((function(e){var n={};return F.forEach((function(r){var s=e[r];if(console.log(s),"string"===typeof s){var t=s.split("^&"),i=(0,l.Z)(t,2)[0];n[r]=i}else n[r]="number"===typeof s?s.toLocaleString("en-US"):s})),"name"in n&&""===n.name?n.name="Summary":"name"in n&&""!==n.name&&void 0!==n.name&&(n.name=""==n.name.split("*")[0]?"Summary":n.name.split("*")[0]),"Planned Revenue"===n.kpi||"Actual Revenue"===n.kpi||"Recognized Revenue"===n.kpi||"Resource Direct Cost"===n.kpi||"Other Direct Cost"===n.kpi||"Gross Margin"===n.kpi?Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]="$"+(null==n[e]?"":n[e]))})):"Gross Margin %"!==n.kpi&&"Billable Utilization"!==n.kpi&&"Billed Utilization"!==n.kpi&&"SUBK"!==n.kpi||Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]=(null==n[e]?0:n[e])+" %")})),n})),i=function(e){return e.match(/^\d{4}_\d{2}_\d{2}$/)?function(e){var n=e.split("_"),r=(0,l.Z)(n,3),s=r[0],t=r[1],i=(r[2],new Date("".concat(s,"-").concat(t,"-01")).toLocaleString("en-us",{month:"short"}));return"".concat(i,"-").concat(s)}(e):e},a={};Object.keys(t[0]).forEach((function(e){a[e]="name"==i(e)?"BU  Customer  Project  Res":"kpi"==i(e)?"":i(e)}));var o=t.filter((function(e){return Object.values(e).some((function(e){return null!==e&&void 0!==e&&""!==e}))}));o.unshift(a);var c=o.map((function(e){var n=[];return s.forEach((function(r){n.push(e[r])})),n}));c.forEach((function(e){r.addRow(e)})),[1].forEach((function(e){r.getRow(e).font={bold:!0}}));for(var u=s.indexOf("name"),d=1,p=c[0][u],m=1;m<c.length;m++){var f=c[m][u];f!==p&&(m-d>0&&r.mergeCells(d+1,u,m,u),d=m,p=f)}c.length-d>0&&r.mergeCells(d+1,u,c.length,u),n.xlsx.writeBuffer().then((function(e){saveAs(new Blob([e]),"Revenue Analysis.xlsx")}))}))}})}),(0,C.jsx)(Z.ZP,{columns:H,data:_,enableExpanding:function(e){return"name"===e.id},enableRowVirtualization:!0,enablePagination:!1,enableGlobalFilter:!0,enableDensityToggle:!1,enableFullScreenToggle:!1,enableHiding:!1,enableColumnFilters:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!1,filterFromLeafRows:!0,initialState:{showGlobalFilter:!0,grouping:["name"],expanded:!0,density:"compact",columnPinning:{right:["Total"]}},muiTableContainerProps:{},muiTableBodyProps:{sx:{"&":{borderRight:"1px solid #ccc",borderBottom:"1px solid #ccc"},"& td":{borderRight:"1px solid #ccc",height:"22px",padding:"0px 5px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",padding:"0 5px"}}}}),E?(0,C.jsx)(T.Z,{handleAbort:function(){N.current&&N.current.abort(),B(!1)}}):""]})};var N=function(e){var n=e.tableData,s=e.column,t=e.selectType,c=e.month,u=e.searchdata,m=e.project,f=e.customer,g=e.resources,v=e.custIndustry,x=e.sortBy,j=(e.laterMeasureLabel,e.defaultMeasureLabel),b=p.N.baseUrl,k=(0,o.useRef)(null),N=(0,o.useState)(!1),I=(0,l.Z)(N,2),S=I[0],E=I[1],B=s[0],M=s[1],U=s.slice(2).sort(),D=[B,M].concat((0,R.Z)(U),["Total"]),V=(0,o.useState)(D),P=(0,l.Z)(V,2),A=P[0],F=P[1],L=(0,o.useState)([]),G=(0,l.Z)(L,2),O=G[0],_=G[1];(0,o.useEffect)((function(){F(e.column)}),[e.column]),(0,o.useEffect)((function(){for(var e=1,r=0;r<n.length;r++)n[r].id=e,++e%1e4==17&&(e+=9984);_(K(n))}),[n]);var z=h()(c).startOf("month").format("yyyy-MM-DD"),K=function(e,n){n=(0,a.Z)({id:"id",parentId:"parentId",children:"subRows"},n);var r={},s=[],t=n.children;return e.forEach((function(e){var s=e[n.id],l=e[n.parentId];r[s]=(0,a.Z)((0,a.Z)((0,i.Z)({},t,[]),e),r[s]),r[l]=r[l]||(0,i.Z)({},t,[]),r[l][t].push(r[s])})),Object.values(r).forEach((function(e){"undefined"===typeof e[n.id]&&s.push.apply(s,(0,R.Z)(e[t]))})),s},q=[{header:(0,C.jsxs)("div",{className:"legendContainer wrap",children:[(0,C.jsxs)("div",{className:"legend lightbrown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Customer Industry"})})]}),(0,C.jsxs)("div",{className:"legend darkgreen",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Customer"})})]}),(0,C.jsxs)("div",{className:"legend purple",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Project"})})]}),(0,C.jsxs)("div",{className:"legend brown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Res"})})]})]}),accessorKey:"name",enableGrouping:!1,GroupedCell:function(e){var n=e.cell;if("CustIndustry"==t){var r,s,c,p,h,Z,T=v.map((function(e){return"Un Assigned"===e.label||""===e.label.trim()?(0,a.Z)((0,a.Z)({},e),{},{label:"UnAssigned"}):e})).find((function(e){return e.label===n.getValue()})),w=(0,o.useState)({}),N=(0,l.Z)(w,2),I=N[0],S=N[1],B=function(){if(T){var e=T.value,n=T.label;O.some((function(n){return n.name.includes("*".concat(e))}))?(S((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),_((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(S((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r){k.current=new AbortController;var s=setTimeout((function(){E(!0)}),2e3);d()({method:"post",url:b+"/revenuemetricsms/RevenueMarginAnalysis/GetGMACustIndustryFinancialsFinalData",data:{ownerDivisions:-1,month:z,duration:u.duration,countries:u.countries,searchType:u.searchType,busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:u.searchType,srcTypeId:e,tarType:r,busUnitId:-1,custId:u.custId,prjId:u.prjId,resId:u.resId,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:u.dpResId,indTypes:u.indTypes,indTypesId:e},signal:k.current.signal}).then((function(t){E(!1),clearTimeout(s);var i=t.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r})})),_((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===j&&e.name.split("*")[0]===n:-1==u.sortBy?e.kpi===j&&e.name.split("*")[0]===n:x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){E(!1)}))}(e,n,"Customer"))}},M=f.find((function(e){if(e.fullName===n.getValue().split("*")[0]){var s=n.getValue().split("*")[1];r=s}return e.fullName===n.getValue().split("*")[0]})),U=(0,o.useState)({}),D=(0,l.Z)(U,2),V=D[0],P=D[1],A=function(){if(M){var e=M.id,n=M.fullName;O.some((function(n){return n.name.includes("*".concat(e))}))?(P((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),_((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(P((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t){k.current=new AbortController;var i=setTimeout((function(){E(!0)}),2e3);d()({method:"post",url:b+"/revenuemetricsms/RevenueMarginAnalysis/GetGMACustIndustryFinancialsFinalData",data:{ownerDivisions:-1,month:z,duration:u.duration,countries:u.countries,searchType:"CustIndustry",busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:e,prjId:-1,resId:-1,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:u.dpResId,indTypes:u.indTypes,indTypesId:t},signal:k.current.signal}).then((function(s){E(!1),clearTimeout(i);var l=s.data.data;l=l.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t})})),_((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===j&&e.name.split("*")[0]===n:-1==u.sortBy?e.kpi===j&&e.name.split("*")[0]===n:x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(l.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){E(!1)}))}(e,n,"Project","Customer",r))}},F=m.find((function(e){if(e.name===n.getValue().split("*")[0]){var r=n.getValue().split("*")[3];s=r,c=n.getValue().split("*")[1]}return e.name===n.getValue().split("*")[0]||e.name===n.getValue().split("*")[0]})),L=(0,o.useState)({}),G=(0,l.Z)(L,2),K=G[0],q=G[1],H=function(){if(F){var e=F.id,n=F.name;O.some((function(n){return n.name.includes("*".concat(e))}))?(q((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),_((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(q((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t,i){k.current=new AbortController;var l=setTimeout((function(){E(!0)}),2e3);d()({method:"post",url:b+"/revenuemetricsms/RevenueMarginAnalysis/GetGMACustIndustryFinancialsFinalData",data:{ownerDivisions:-1,month:z,duration:u.duration,countries:u.countries,searchType:"CustIndustry",busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:i,prjId:e,resId:u.resId,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:u.dpResId,indTypes:u.indTypes,indTypesId:t},signal:k.current.signal}).then((function(s){E(!1),clearTimeout(l);var o=s.data.data;o=o.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t+"*"+i})})),_((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===j&&e.name.split("*")[0]===n:-1==u.sortBy?e.kpi===j&&e.name.split("*")[0]===n:x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(o.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){E(!1)}))}(e,n,"Res","Project",s,c))}},$=g.find((function(e){if(e.fullName===n.getValue().split("*")[0]){var r=n.getValue().split("*")[3];h=n.getValue().split("*")[1],Z=n.getValue().split("*")[4],p=r}var s=e.fullName.split("*")[0].split(" "),t=n.getValue().split("*")[0].split(" ");return""==n.getValue().split("*")[0]?"":t.every((function(e){return s.includes(e)}))})),W=(0,o.useState)({}),Y=(0,l.Z)(W,2),J=Y[0],X=Y[1],Q=function(){if($){var e=$.id,n=$.fullName;O.some((function(n){return n.name.includes("*".concat(e))}))?(X((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),_((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(X((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t,i,l){k.current=new AbortController;var o=setTimeout((function(){E(!0)}),2e3);d()({method:"post",url:b+"/revenuemetricsms/RevenueMarginAnalysis/GetGMACustIndustryFinancialsFinalData",data:{ownerDivisions:-1,month:z,duration:u.duration,countries:u.countries,searchType:"CustIndustry",busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:l,prjId:i,resId:-1,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:u.dpResId,indTypes:u.indTypes,indTypesId:t},signal:k.current.signal}).then((function(s){E(!1),clearTimeout(o);var i=s.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t})})),_((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")})):e.kpi===j&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," "):-1==u.sortBy?e.kpi===j&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," "):x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){E(!1)}))}(e,n,"Leaf","Res",p,h,Z))}};if(T){var ee=I[T.value];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:T.value,onClick:function(){B()},className:"parent",children:[ee?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"buRM",title:T.label+" ("+n.row.original.count+")",children:[T.label," (",n.row.original.count,")"]})]})}if(M){var ne=V[M.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:M.id,onClick:function(){A()},className:"parent",children:[ne?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"custRM",title:M.fullName+" ("+n.row.original.count+")",children:[M.fullName," (",n.row.original.count,")"]})]})}if(F){var re=K[F.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:F.id,onClick:function(){H()},className:"parent",children:[console.log(n.row.original),re?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"projRM",title:F.name+" ("+n.row.original.count+")",children:[F.name," (",n.row.original.count,")"]})]})}if($){var se=J[$.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:$.id,onClick:function(){Q()},className:"parent",children:[se?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsx)("b",{className:"resRM",title:$.fullName+" ("+n.row.original.count+")",children:$.fullName})]})}return(0,C.jsxs)("span",{className:"child",title:""===n.row.original.name?"Summary":n.getValue().split("*")[0]+" ("+n.row.original.count+")",children:[(0,C.jsxs)("b",{className:"Customer"==n.getValue().split("*")[2]?"buRM":"Project"==n.getValue().split("*")[2]?"custRM":"Res"==n.getValue().split("*")[2]?"projRM":"Leaf"==n.getValue().split("*")[2]?"resRM":"",style:{display:""==n.row.original.name||""==n.getValue().split("*")[0]?"flex":"",justifyContent:""==n.row.original.name||""==n.getValue().split("*")[0]?"center":""},children:[""==n.row.original.name||""==n.getValue().split("*")[0]?"Summary":(0,C.jsxs)("div",{onClick:A,children:[(0,C.jsx)(y.jS6,{})," ",n.getValue().split("*")[0]]})," ",0===n.row.original.count?"":"(".concat(n.row.original.count,")")]})," "]})}}},{header:"",accessorKey:"kpi",Cell:function(e){var n=e.cell,r=v.map((function(e){return"Un Assigned"===e.label||""===e.label.trim()?(0,a.Z)((0,a.Z)({},e),{},{label:"UnAssigned"}):e})).find((function(e){return e.label===n.row.original.name})),s=f.find((function(e){return e.fullName===n.row.original.name.split("*")[0]})),t=m.find((function(e){return e.name===n.row.original.name.split("*")[0]})),i=g.find((function(e){var r=e.fullName.split("*")[0].split(" "),s=n.row.original.name.split("*")[0].split(" ");return""==n.row.original.name.split("*")[0]?"":s.every((function(e){return r.includes(e)}))}));return(0,C.jsx)("span",{children:(0,C.jsx)("b",{className:r?"buRMchild":s?"custRMchild":t?"projRMchild":i?"resRMchild":"Customer"==n.row.original.name.split("*")[2]?"buRMchild":"Project"==n.row.original.name.split("*")[2]?"custRMchild":"Res"==n.row.original.name.split("*")[2]?"projRMchild":"Leaf"==n.row.original.name.split("*")[2]?"resRMchild":"",children:n.getValue()})})}}];A.forEach((function(e,n){if(n>1&&"Total"!==e){var r=new Date("".concat(e.slice(0,4),"-").concat(e.slice(5,7),"-").concat(e.slice(8,10))).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),s=(new Date).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),t=new Date(r)>=new Date(s);q.push({header:r,accessorKey:"".concat(e),className:"software",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)("span",{className:t?"greenColumn":"",children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:"$"}):"",(0,C.jsxs)("span",{style:{display:"block",float:"right"},children:[null==r.getValue()?0:null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:"%"}):""]})]})}})}}));var H=q.length,$={header:"Total",accessorKey:"Total",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)(C.Fragment,{children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:(0,C.jsx)("b",{children:"$"})}):"",(0,C.jsx)("span",{style:{display:"block",float:"right"},className:"total",children:(0,C.jsxs)("b",{children:[null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:null==r.getValue()?0:"%"}):""]})})]})}};return q.splice(H,0,$),(0,C.jsxs)("div",{className:"materialReactExpandableTable headCountTable darkHeader",children:[(0,C.jsx)("div",{className:"mb-2",align:" right ",children:(0,C.jsx)(w.WlY,{size:"1.5em",title:"Export to Excel",style:{color:"green"},cursor:"pointer",onClick:function(){Promise.resolve().then(r.t.bind(r,25415,23)).then((function(e){var n=new e.Workbook,r=n.addWorksheet("Revenue Analysis"),s=[];(s=A).sort((function(e,n){var r=e.split("_"),s=(0,l.Z)(r,3),t=s[1],i=s[2],a=n.split("_"),o=(0,l.Z)(a,3),c=o[1],u=o[2];return t!==c?parseInt(t)-parseInt(c):parseInt(i)-parseInt(u)}));var t=A.concat(O).map((function(e){var n={};return A.forEach((function(r){var s=e[r];if("string"===typeof s){var t=s.split("^&"),i=(0,l.Z)(t,2)[0];n[r]=i}else n[r]="number"===typeof s?s.toLocaleString("en-US"):s})),"name"in n&&""===n.name?n.name="Summary":"name"in n&&""!==n.name&&void 0!==n.name&&(n.name=""==n.name.split("*")[0]?"Summary":n.name.split("*")[0]),"Planned Revenue"===n.kpi||"Actual Revenue"===n.kpi||"Recognized Revenue"===n.kpi||"Resource Direct Cost"===n.kpi||"Other Direct Cost"===n.kpi||"Gross Margin"===n.kpi?Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]="$"+(null==n[e]?"":n[e]))})):"Gross Margin %"!==n.kpi&&"Billable Utilization"!==n.kpi&&"Billed Utilization"!==n.kpi&&"FTE"!==n.kpi&&"SUBK"!==n.kpi||Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]=(null==n[e]?0:n[e])+" %")})),n})),i=function(e){return e.match(/^\d{4}_\d{2}_\d{2}$/)?function(e){var n=e.split("_"),r=(0,l.Z)(n,3),s=r[0],t=r[1],i=(r[2],new Date("".concat(s,"-").concat(t,"-01")).toLocaleString("en-us",{month:"short"}));return"".concat(i,"-").concat(s)}(e):e},a={};Object.keys(t[0]).forEach((function(e){a[e]="name"==i(e)?"Customer  Industry  Customer  Project  Res":"kpi"==i(e)?"":i(e)}));var o=t.filter((function(e){return Object.values(e).some((function(e){return null!==e&&void 0!==e&&""!==e}))}));o.unshift(a);var c=o.map((function(e){var n=[];return s.forEach((function(r){n.push(e[r])})),n}));c.forEach((function(e){r.addRow(e)})),[1].forEach((function(e){r.getRow(e).font={bold:!0}}));for(var u=s.indexOf("name"),d=1,p=c[0][u],m=1;m<c.length;m++){var f=c[m][u];f!==p&&(m-d>0&&r.mergeCells(d+1,u,m,u),d=m,p=f)}c.length-d>0&&r.mergeCells(d+1,u,c.length,u),n.xlsx.writeBuffer().then((function(e){saveAs(new Blob([e]),"Revenue Analysis.xlsx")}))}))}})}),(0,C.jsx)(Z.ZP,{columns:q,data:O,enableExpanding:function(e){return"name"===e.id},enableRowVirtualization:!0,enablePagination:!1,enableGlobalFilter:!0,enableDensityToggle:!1,enableFullScreenToggle:!1,enableHiding:!1,enableColumnFilters:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!1,filterFromLeafRows:!0,initialState:{showGlobalFilter:!0,grouping:["name"],expanded:!0,density:"compact",columnPinning:{right:["Total"]}},muiTableContainerProps:{},muiTableBodyProps:{sx:{"&":{borderRight:"1px solid #ccc",borderBottom:"1px solid #ccc"},"& td":{borderRight:"1px solid #ccc",height:"22px",padding:"0px 5px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",padding:"0 5px"}}}}),S?(0,C.jsx)(T.Z,{handleAbort:function(){k.current&&k.current.abort(),E(!1)}}):""]})};var I=function(e){var n=e.tableData,s=e.column,t=e.selectType,c=e.month,u=e.searchdata,m=e.project,f=e.customer,g=e.resources,v=e.dpList,x=e.sortBy,j=(e.laterMeasureLabel,e.defaultMeasureLabel),b=p.N.baseUrl,k=(0,o.useRef)(null),N=(0,o.useState)(!1),I=(0,l.Z)(N,2),S=I[0],E=I[1],B=s[0],M=s[1],U=s.slice(2).sort(),D=[B,M].concat((0,R.Z)(U),["Total"]),V=(0,o.useState)(D),P=(0,l.Z)(V,2),A=P[0],F=P[1],L=(0,o.useState)([]),G=(0,l.Z)(L,2),O=G[0],_=G[1];(0,o.useEffect)((function(){F(e.column)}),[e.column]),(0,o.useEffect)((function(){for(var e=1,r=0;r<n.length;r++)n[r].id=e,++e%1e4==17&&(e+=9984);_(K(n))}),[n]);var z=h()(c).startOf("month").format("yyyy-MM-DD"),K=function(e,n){n=(0,a.Z)({id:"id",parentId:"parentId",children:"subRows"},n);var r={},s=[],t=n.children;return e.forEach((function(e){var s=e[n.id],l=e[n.parentId];r[s]=(0,a.Z)((0,a.Z)((0,i.Z)({},t,[]),e),r[s]),r[l]=r[l]||(0,i.Z)({},t,[]),r[l][t].push(r[s])})),Object.values(r).forEach((function(e){"undefined"===typeof e[n.id]&&s.push.apply(s,(0,R.Z)(e[t]))})),s},q=[{header:(0,C.jsxs)("div",{className:"legendContainer wrap",children:[(0,C.jsxs)("div",{className:"legend lightbrown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"DP"})})]}),(0,C.jsxs)("div",{className:"legend darkgreen",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Customer"})})]}),(0,C.jsxs)("div",{className:"legend purple",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Project"})})]}),(0,C.jsxs)("div",{className:"legend brown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Res"})})]})]}),accessorKey:"name",enableGrouping:!1,GroupedCell:function(e){var n=e.cell;if("DP"==t){var r,s,c,p,h,Z,T=v.find((function(e){return e.label===n.getValue()})),w=(0,o.useState)({}),N=(0,l.Z)(w,2),I=N[0],S=N[1],B=function(){if(T){var e=T.value,n=T.label;O.some((function(n){return n.name.includes("*".concat(e))}))?(S((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),_((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(S((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r){k.current=new AbortController;var s=setTimeout((function(){E(!0)}),2e3);d()({method:"post",url:b+"/revenuemetricsms/RevenueMarginAnalysis/GetGMADPFinancialsFinalData",data:{ownerDivisions:-1,month:z,duration:u.duration,countries:u.countries,searchType:u.searchType,busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:u.searchType,srcTypeId:e,tarType:r,busUnitId:-1,custId:u.custId,prjId:u.prjId,resId:u.resId,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:u.dpRes,dpResId:e,indTypes:-1,indTypesId:-1},signal:k.current.signal}).then((function(t){E(!1),clearTimeout(s);var i=t.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r})})),_((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===j&&e.name.split("*")[0]===n:-1==u.sortBy?e.kpi===j&&e.name.split("*")[0]===n:x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){E(!1)}))}(e,n,"Customer"))}},M=f.find((function(e){if(e.fullName===n.getValue().split("*")[0]){var s=n.getValue().split("*")[1];r=s}return e.fullName===n.getValue().split("*")[0]})),U=(0,o.useState)({}),D=(0,l.Z)(U,2),V=D[0],P=D[1],A=function(){if(M){var e=M.id,n=M.fullName;O.some((function(n){return n.name.includes("*".concat(e))}))?(P((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),_((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(P((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t){k.current=new AbortController;var i=setTimeout((function(){E(!0)}),2e3);d()({method:"post",url:b+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:z,duration:u.duration,countries:u.countries,searchType:"DP",busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:e,prjId:u.prjId,resId:u.resId,measures:u.measures,salesExecId:-1,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:u.dpRes,dpResId:t,indTypes:-1,indTypesId:-1},signal:k.current.signal}).then((function(s){E(!1),clearTimeout(i);var l=s.data.data;l=l.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t})})),_((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===j&&e.name.split("*")[0]===n:-1==u.sortBy?e.kpi===j&&e.name.split("*")[0]===n:x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(l.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){E(!1)}))}(e,n,"Project","Customer",r))}},F=m.find((function(e){if(e.name===n.getValue().split("*")[0]){var r=n.getValue().split("*")[3];s=r,c=n.getValue().split("*")[1]}return e.name===n.getValue().split("*")[0]||e.name===n.getValue().split("*")[0]})),L=(0,o.useState)({}),G=(0,l.Z)(L,2),K=G[0],q=G[1],H=function(){if(F){var e=F.id,n=F.name;O.some((function(n){return n.name.includes("*".concat(e))}))?(q((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),_((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(q((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t,i){k.current=new AbortController;var l=setTimeout((function(){E(!0)}),2e3);d()({method:"post",url:b+"/revenuemetricsms/RevenueMarginAnalysis/GetGMADPFinancialsFinalData",data:{ownerDivisions:-1,month:z,duration:u.duration,countries:u.countries,searchType:"DP",busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:i,prjId:e,resId:u.resId,measures:u.measures,salesExecId:-1,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:u.dpRes,dpResId:t,indTypes:-1,indTypesId:-1},signal:k.current.signal}).then((function(s){E(!1),clearTimeout(l);var o=s.data.data;o=o.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t+"*"+i})})),_((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===j&&e.name.split("*")[0]===n:-1==u.sortBy?e.kpi===j&&e.name.split("*")[0]===n:x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(o.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){E(!1)}))}(e,n,"Res","Project",s,c))}},$=g.find((function(e){if(e.fullName===n.getValue().split("*")[0]){var r=n.getValue().split("*")[3];h=n.getValue().split("*")[1],Z=n.getValue().split("*")[4],p=r}var s=e.fullName.split("*")[0].split(" "),t=n.getValue().split("*")[0].split(" ");return""==n.getValue().split("*")[0]?"":t.every((function(e){return s.includes(e)}))})),W=(0,o.useState)({}),Y=(0,l.Z)(W,2),J=Y[0],X=Y[1],Q=function(){if($){var e=$.id,n=$.fullName;O.some((function(n){return n.name.includes("*".concat(e))}))?(X((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),_((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(X((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t,i,l){k.current=new AbortController;var o=setTimeout((function(){E(!0)}),2e3);d()({method:"post",url:b+"/revenuemetricsms/RevenueMarginAnalysis/GetGMADPFinancialsFinalData",data:{ownerDivisions:-1,month:z,duration:u.duration,countries:u.countries,searchType:"DP",busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:l,prjId:i,resId:-1,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:u.dpRes,dpResId:t,indTypes:-1,indTypesId:-1},signal:k.current.signal}).then((function(s){E(!1),clearTimeout(o);var i=s.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t})})),_((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")})):e.kpi===j&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," "):-1==u.sortBy?e.kpi===j&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," "):x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){E(!1)}))}(e,n,"Leaf","Res",p,h,Z))}};if(T){var ee=I[T.value];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:T.value,onClick:function(){B()},className:"parent",children:[ee?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"buRM",title:T.label+" ("+n.row.original.count+")",children:[T.label," (",n.row.original.count,")"]})]})}if(M){var ne=V[M.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:M.id,onClick:function(){A()},className:"parent",children:[ne?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"custRM",title:M.fullName+" ("+n.row.original.count+")",children:[M.fullName," (",n.row.original.count,")"]})]})}if(F){var re=K[F.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:F.id,onClick:function(){H()},className:"parent",children:[re?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"projRM",title:F.name+" ("+n.row.original.count+")",children:[F.name," (",n.row.original.count,")"]})]})}if($){var se=J[$.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:$.id,onClick:function(){Q()},className:"parent",children:[se?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsx)("b",{className:"resRM",title:$.fullName+" ("+n.row.original.count+")",children:$.fullName})]})}return(0,C.jsxs)("span",{className:"child",title:""===n.row.original.name?"Summary":n.getValue().split("*")[0]+" ("+n.row.original.count+")",children:[(0,C.jsxs)("b",{className:"Customer"==n.getValue().split("*")[2]?"buRM":"Project"==n.getValue().split("*")[2]?"custRM":"Res"==n.getValue().split("*")[2]?"projRM":"Leaf"==n.getValue().split("*")[2]?"resRM":"",style:{display:""==n.row.original.name||""==n.getValue().split("*")[0]?"flex":"",justifyContent:""==n.row.original.name||""==n.getValue().split("*")[0]?"center":""},children:[""==n.row.original.name||""==n.getValue().split("*")[0]?"Summary":(0,C.jsxs)("div",{onClick:A,children:[(0,C.jsx)(y.jS6,{})," ",n.getValue().split("*")[0]]})," ",0===n.row.original.count?"":"(".concat(n.row.original.count,")")]})," "]})}}},{header:"",accessorKey:"kpi",Cell:function(e){var n=e.cell,r=v.find((function(e){return e.label===n.row.original.name})),s=f.find((function(e){return e.fullName===n.row.original.name.split("*")[0]})),t=m.find((function(e){return e.name===n.row.original.name.split("*")[0]})),i=g.find((function(e){var r=e.fullName.split("*")[0].split(" "),s=n.row.original.name.split("*")[0].split(" ");return""==n.row.original.name.split("*")[0]?"":s.every((function(e){return r.includes(e)}))}));return(0,C.jsx)("span",{children:(0,C.jsx)("b",{className:r?"buRMchild":s?"custRMchild":t?"projRMchild":i?"resRMchild":"Customer"==n.row.original.name.split("*")[2]?"buRMchild":"Project"==n.row.original.name.split("*")[2]?"custRMchild":"Res"==n.row.original.name.split("*")[2]?"projRMchild":"Leaf"==n.row.original.name.split("*")[2]?"resRMchild":"",children:n.getValue()})})}}];A.forEach((function(e,n){if(n>1&&"Total"!==e){var r=new Date("".concat(e.slice(0,4),"-").concat(e.slice(5,7),"-").concat(e.slice(8,10))).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),s=(new Date).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),t=new Date(r)>=new Date(s);q.push({header:r,accessorKey:"".concat(e),className:"software",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)("span",{className:t?"greenColumn":"",children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:"$"}):"",(0,C.jsxs)("span",{style:{display:"block",float:"right"},children:[null==r.getValue()?0:null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:"%"}):""]})]})}})}}));var H=q.length,$={header:"Total",accessorKey:"Total",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)(C.Fragment,{children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:(0,C.jsx)("b",{children:"$"})}):"",(0,C.jsx)("span",{style:{display:"block",float:"right"},className:"total",children:(0,C.jsxs)("b",{children:[null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:null==r.getValue()?0:"%"}):""]})})]})}};return q.splice(H,0,$),(0,C.jsxs)("div",{className:"materialReactExpandableTable headCountTable darkHeader",children:[(0,C.jsx)("div",{className:"mb-2",align:" right ",children:(0,C.jsx)(w.WlY,{size:"1.5em",title:"Export to Excel",style:{color:"green"},cursor:"pointer",onClick:function(){Promise.resolve().then(r.t.bind(r,25415,23)).then((function(e){var n=new e.Workbook,r=n.addWorksheet("Revenue Analysis"),s=[];(s=A).sort((function(e,n){var r=e.split("_"),s=(0,l.Z)(r,3),t=s[1],i=s[2],a=n.split("_"),o=(0,l.Z)(a,3),c=o[1],u=o[2];return t!==c?parseInt(t)-parseInt(c):parseInt(i)-parseInt(u)}));var t=A.concat(O).map((function(e){var n={};return A.forEach((function(r){var s=e[r];if("string"===typeof s){var t=s.split("^&"),i=(0,l.Z)(t,2)[0];n[r]=i}else n[r]="number"===typeof s?s.toLocaleString("en-US"):s})),"name"in n&&""===n.name?n.name="Summary":"name"in n&&""!==n.name&&void 0!==n.name&&(n.name=""==n.name.split("*")[0]?"Summary":n.name.split("*")[0]),"Planned Revenue"===n.kpi||"Actual Revenue"===n.kpi||"Recognized Revenue"===n.kpi||"Resource Direct Cost"===n.kpi||"Other Direct Cost"===n.kpi||"Gross Margin"===n.kpi?Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]="$"+(null==n[e]?"":n[e]))})):"Gross Margin %"!==n.kpi&&"Billable Utilization"!==n.kpi&&"Billed Utilization"!==n.kpi&&"FTE"!==n.kpi&&"SUBK"!==n.kpi||Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]=(null==n[e]?0:n[e])+" %")})),n})),i=function(e){return e.match(/^\d{4}_\d{2}_\d{2}$/)?function(e){var n=e.split("_"),r=(0,l.Z)(n,3),s=r[0],t=r[1],i=(r[2],new Date("".concat(s,"-").concat(t,"-01")).toLocaleString("en-us",{month:"short"}));return"".concat(i,"-").concat(s)}(e):e},a={};Object.keys(t[0]).forEach((function(e){a[e]="name"==i(e)?"DP  Customer  Project  Res":"kpi"==i(e)?"":i(e)}));var o=t.filter((function(e){return Object.values(e).some((function(e){return null!==e&&void 0!==e&&""!==e}))}));o.unshift(a);var c=o.map((function(e){var n=[];return s.forEach((function(r){n.push(e[r])})),n}));c.forEach((function(e){r.addRow(e)})),[1].forEach((function(e){r.getRow(e).font={bold:!0}}));for(var u=s.indexOf("name"),d=1,p=c[0][u],m=1;m<c.length;m++){var f=c[m][u];f!==p&&(m-d>0&&r.mergeCells(d+1,u,m,u),d=m,p=f)}c.length-d>0&&r.mergeCells(d+1,u,c.length,u),n.xlsx.writeBuffer().then((function(e){saveAs(new Blob([e]),"Revenue Analysis.xlsx")}))}))}})}),(0,C.jsx)(Z.ZP,{columns:q,data:O,enableExpanding:function(e){return"name"===e.id},enableRowVirtualization:!0,enablePagination:!1,enableGlobalFilter:!0,enableDensityToggle:!1,enableFullScreenToggle:!1,enableHiding:!1,enableColumnFilters:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!1,filterFromLeafRows:!0,initialState:{showGlobalFilter:!0,grouping:["name"],expanded:!0,density:"compact",columnPinning:{right:["Total"]}},muiTableContainerProps:{},muiTableBodyProps:{sx:{"&":{borderRight:"1px solid #ccc",borderBottom:"1px solid #ccc"},"& td":{borderRight:"1px solid #ccc",height:"22px",padding:"0px 5px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",padding:"0 5px"}}}}),S?(0,C.jsx)(T.Z,{handleAbort:function(){k.current&&k.current.abort(),E(!1)}}):""]})};var S=function(e){var n=e.tableData,s=e.column,t=e.selectType,c=e.month,u=e.searchdata,m=e.project,f=e.customer,g=e.resources,v=e.cslList,x=e.sortBy,j=(e.laterMeasureLabel,e.defaultMeasureLabel),b=p.N.baseUrl,k=(0,o.useRef)(null),N=(0,o.useState)(!1),I=(0,l.Z)(N,2),S=I[0],E=I[1],B=s[0],M=s[1],U=s.slice(2).sort(),D=[B,M].concat((0,R.Z)(U),["Total"]),V=(0,o.useState)(D),P=(0,l.Z)(V,2),A=P[0],F=P[1],L=(0,o.useState)([]),G=(0,l.Z)(L,2),O=G[0],_=G[1];(0,o.useEffect)((function(){F(e.column)}),[e.column]),(0,o.useEffect)((function(){for(var e=1,r=0;r<n.length;r++)n[r].id=e,++e%1e4==17&&(e+=9984);_(K(n))}),[n]);var z=h()(c).startOf("month").format("yyyy-MM-DD"),K=function(e,n){n=(0,a.Z)({id:"id",parentId:"parentId",children:"subRows"},n);var r={},s=[],t=n.children;return e.forEach((function(e){var s=e[n.id],l=e[n.parentId];r[s]=(0,a.Z)((0,a.Z)((0,i.Z)({},t,[]),e),r[s]),r[l]=r[l]||(0,i.Z)({},t,[]),r[l][t].push(r[s])})),Object.values(r).forEach((function(e){"undefined"===typeof e[n.id]&&s.push.apply(s,(0,R.Z)(e[t]))})),s},q=[{header:(0,C.jsxs)("div",{className:"legendContainer wrap",children:[(0,C.jsxs)("div",{className:"legend lightbrown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"CSL"})})]}),(0,C.jsxs)("div",{className:"legend darkgreen",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Customer"})})]}),(0,C.jsxs)("div",{className:"legend purple",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Project"})})]}),(0,C.jsxs)("div",{className:"legend brown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Res"})})]})]}),accessorKey:"name",enableGrouping:!1,GroupedCell:function(e){var n=e.cell;if("CSL"==t){var r,s,c,p,h,Z,T=v.find((function(e){return e.label===n.getValue()})),w=(0,o.useState)({}),N=(0,l.Z)(w,2),I=N[0],S=N[1],B=function(){if(T){var e=T.value,n=T.label;O.some((function(n){return n.name.includes("*".concat(e))}))?(S((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),_((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(S((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r){k.current=new AbortController;var s=setTimeout((function(){E(!0)}),2e3);d()({method:"post",url:b+"/revenuemetricsms/RevenueMarginAnalysis/GetGMACSLFinancialsFinalData",data:{ownerDivisions:-1,month:z,duration:u.duration,countries:u.countries,searchType:u.searchType,busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:u.searchType,srcTypeId:e,tarType:r,busUnitId:-1,custId:u.custId,prjId:u.prjId,resId:u.resId,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:-1==u.cslRes?"104869169,199,235,257,825,881,1115,1165,130391575,91335222,1375,81587,106940587,81651,2627272,2607,2889,96657988,3129,4452476,3887,123558264,112875977,2120153,5019,117718248,5201":u.cslRes,cslResId:e,dpRes:-1,dpResId:-1,indTypes:-1,indTypesId:-1},signal:k.current.signal}).then((function(t){E(!1),clearTimeout(s);var i=t.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r})})),_((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===j&&e.name.split("*")[0]===n:-1==u.sortBy?e.kpi===j&&e.name.split("*")[0]===n:x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){E(!1)}))}(e,n,"Customer"))}},M=f.find((function(e){if(e.fullName===n.getValue().split("*")[0]){var s=n.getValue().split("*")[1];r=s}return e.fullName===n.getValue().split("*")[0]})),U=(0,o.useState)({}),D=(0,l.Z)(U,2),V=D[0],P=D[1],A=function(){if(M){var e=M.id,n=M.fullName;O.some((function(n){return n.name.includes("*".concat(e))}))?(P((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),_((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(P((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t){k.current=new AbortController;var i=setTimeout((function(){E(!0)}),2e3);d()({method:"post",url:b+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:z,duration:u.duration,countries:u.countries,searchType:"CSL",busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:e,prjId:u.prjId,resId:-1,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:-1==u.cslRes?"104869169,199,235,257,825,881,1115,1165,130391575,91335222,1375,81587,106940587,81651,2627272,2607,2889,96657988,3129,4452476,3887,123558264,112875977,2120153,5019,117718248,5201":u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:t,indTypes:-1,indTypesId:-1},signal:k.current.signal}).then((function(s){E(!1),clearTimeout(i);var l=s.data.data;l=l.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t})})),_((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===j&&e.name.split("*")[0]===n:-1==u.sortBy?e.kpi===j&&e.name.split("*")[0]===n:x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(l.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){E(!1)}))}(e,n,"Project","Customer",r))}},F=m.find((function(e){if(e.name===n.getValue().split("*")[0]){var r=n.getValue().split("*")[3];s=r,c=n.getValue().split("*")[1]}return e.name===n.getValue().split("*")[0]||e.name===n.getValue().split("*")[0]})),L=(0,o.useState)({}),G=(0,l.Z)(L,2),K=G[0],q=G[1],H=function(){if(F){var e=F.id,n=F.name;O.some((function(n){return n.name.includes("*".concat(e))}))?(q((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),_((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(q((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t,i){k.current=new AbortController;var l=setTimeout((function(){E(!0)}),2e3);d()({method:"post",url:b+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:z,duration:u.duration,countries:u.countries,searchType:"CSL",busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:i,prjId:e,resId:-1,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:-1==u.cslRes?"104869169,199,235,257,825,881,1115,1165,130391575,91335222,1375,81587,106940587,81651,2627272,2607,2889,96657988,3129,4452476,3887,123558264,112875977,2120153,5019,117718248,5201":u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:t,indTypes:-1,indTypesId:-1},signal:k.current.signal}).then((function(s){E(!1),clearTimeout(l);var o=s.data.data;o=o.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t+"*"+i})})),_((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===j&&e.name.split("*")[0]===n:-1==u.sortBy?e.kpi===j&&e.name.split("*")[0]===n:x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(o.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){E(!1)}))}(e,n,"Res","Project",s,c))}},$=g.find((function(e){if(e.fullName===n.getValue().split("*")[0]){var r=n.getValue().split("*")[3];h=n.getValue().split("*")[1],Z=n.getValue().split("*")[4],p=r}var s=e.fullName.split("*")[0].split(" "),t=n.getValue().split("*")[0].split(" ");return""==n.getValue().split("*")[0]?"":t.every((function(e){return s.includes(e)}))})),W=(0,o.useState)({}),Y=(0,l.Z)(W,2),J=Y[0],X=Y[1],Q=function(){if($){var e=$.id,n=$.fullName;O.some((function(n){return n.name.includes("*".concat(e))}))?(X((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),_((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(X((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t,i,l){k.current=new AbortController;var o=setTimeout((function(){E(!0)}),2e3);d()({method:"post",url:b+"/revenuemetricsms/RevenueMarginAnalysis/GetGMACSLFinancialsFinalData",data:{ownerDivisions:-1,month:z,duration:u.duration,countries:u.countries,searchType:"CSL",busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:l,prjId:i,resId:-1,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:-1==u.cslRes?"104869169,199,235,257,825,881,1115,1165,130391575,91335222,1375,81587,106940587,81651,2627272,2607,2889,96657988,3129,4452476,3887,123558264,112875977,2120153,5019,117718248,5201":u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:t,indTypes:-1,indTypesId:-1},signal:k.current.signal}).then((function(s){E(!1),clearTimeout(o);var i=s.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t})})),_((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")})):e.kpi===j&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," "):-1==u.sortBy?e.kpi===j&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," "):x.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){E(!1)}))}(e,n,"Leaf","Res",p,h,Z))}};if(T){var ee=I[T.value];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:T.value,onClick:function(){B()},className:"parent",children:[ee?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"buRM",title:T.label+" ("+n.row.original.count+")",children:[T.label," (",n.row.original.count,")"]})]})}if(M){var ne=V[M.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:M.id,onClick:function(){A()},className:"parent",children:[ne?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"custRM",title:M.fullName+" ("+n.row.original.count+")",children:[M.fullName," (",n.row.original.count,")"]})]})}if(F){var re=K[F.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:F.id,onClick:function(){H()},className:"parent",children:[re?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"projRM",title:F.name+" ("+n.row.original.count+")",children:[F.name," (",n.row.original.count,")"]})]})}if($){var se=J[$.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:$.id,onClick:function(){Q()},className:"parent",children:[se?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsx)("b",{className:"resRM",title:$.fullName+" ("+n.row.original.count+")",children:$.fullName})]})}return(0,C.jsxs)("span",{className:"child",title:""===n.row.original.name?"Summary":n.getValue().split("*")[0]+" ("+n.row.original.count+")",children:[(0,C.jsxs)("b",{className:"Customer"==n.getValue().split("*")[2]?"buRM":"Project"==n.getValue().split("*")[2]?"custRM":"Res"==n.getValue().split("*")[2]?"projRM":"Leaf"==n.getValue().split("*")[2]?"resRM":"",style:{display:""==n.row.original.name||""==n.getValue().split("*")[0]?"flex":"",justifyContent:""==n.row.original.name||""==n.getValue().split("*")[0]?"center":""},children:[""==n.row.original.name||""==n.getValue().split("*")[0]?"Summary":(0,C.jsxs)("div",{onClick:A,children:[(0,C.jsx)(y.jS6,{})," ",n.getValue().split("*")[0]]})," ",0===n.row.original.count?"":"(".concat(n.row.original.count,")")]})," "]})}}},{header:"",accessorKey:"kpi",Cell:function(e){var n=e.cell,r=v.find((function(e){return e.label===n.row.original.name})),s=f.find((function(e){return e.fullName===n.row.original.name.split("*")[0]})),t=m.find((function(e){return e.name===n.row.original.name.split("*")[0]})),i=g.find((function(e){var r=e.fullName.split("*")[0].split(" "),s=n.row.original.name.split("*")[0].split(" ");return""==n.row.original.name.split("*")[0]?"":s.every((function(e){return r.includes(e)}))}));return(0,C.jsx)("span",{children:(0,C.jsx)("b",{className:r?"buRM":s?"custRM":t?"projRM":i?"resRM":"Customer"==n.row.original.name.split("*")[2]?"buRM":"Project"==n.row.original.name.split("*")[2]?"custRM":"Res"==n.row.original.name.split("*")[2]?"projRM":"Leaf"==n.row.original.name.split("*")[2]?"resRM":"",children:n.getValue()})})}}];A.forEach((function(e,n){if(n>1&&"Total"!==e){var r=new Date("".concat(e.slice(0,4),"-").concat(e.slice(5,7),"-").concat(e.slice(8,10))).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),s=(new Date).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),t=new Date(r)>=new Date(s);q.push({header:r,accessorKey:"".concat(e),className:"software",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)("span",{className:t?"greenColumn":"",children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:"$"}):"",(0,C.jsxs)("span",{style:{display:"block",float:"right"},children:[null==r.getValue()?0:null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:"%"}):""]})]})}})}}));var H=q.length,$={header:"Total",accessorKey:"Total",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)(C.Fragment,{children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:(0,C.jsx)("b",{children:"$"})}):"",(0,C.jsx)("span",{style:{display:"block",float:"right"},className:"total",children:(0,C.jsxs)("b",{children:[null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:null==r.getValue()?0:"%"}):""]})})]})}};return q.splice(H,0,$),(0,C.jsxs)("div",{className:"materialReactExpandableTable headCountTable darkHeader",children:[(0,C.jsx)("div",{className:"mb-2",align:" right ",children:(0,C.jsx)(w.WlY,{size:"1.5em",title:"Export to Excel",style:{color:"green"},cursor:"pointer",onClick:function(){Promise.resolve().then(r.t.bind(r,25415,23)).then((function(e){var n=new e.Workbook,r=n.addWorksheet("Revenue Analysis"),s=[];(s=A).sort((function(e,n){var r=e.split("_"),s=(0,l.Z)(r,3),t=s[1],i=s[2],a=n.split("_"),o=(0,l.Z)(a,3),c=o[1],u=o[2];return t!==c?parseInt(t)-parseInt(c):parseInt(i)-parseInt(u)}));var t=A.concat(O).map((function(e){var n={};return A.forEach((function(r){var s=e[r];if("string"===typeof s){var t=s.split("^&"),i=(0,l.Z)(t,2)[0];n[r]=i}else n[r]="number"===typeof s?s.toLocaleString("en-US"):s})),"name"in n&&""===n.name?n.name="Summary":"name"in n&&""!==n.name&&void 0!==n.name&&(n.name=""==n.name.split("*")[0]?"Summary":n.name.split("*")[0]),"Planned Revenue"===n.kpi||"Actual Revenue"===n.kpi||"Recognized Revenue"===n.kpi||"Resource Direct Cost"===n.kpi||"Other Direct Cost"===n.kpi||"Gross Margin"===n.kpi?Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]="$"+(null==n[e]?"":n[e]))})):"Gross Margin %"!==n.kpi&&"Billable Utilization"!==n.kpi&&"Billed Utilization"!==n.kpi&&"FTE"!==n.kpi&&"SUBK"!==n.kpi||Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]=(null==n[e]?0:n[e])+" %")})),n})),i=function(e){return e.match(/^\d{4}_\d{2}_\d{2}$/)?function(e){var n=e.split("_"),r=(0,l.Z)(n,3),s=r[0],t=r[1],i=(r[2],new Date("".concat(s,"-").concat(t,"-01")).toLocaleString("en-us",{month:"short"}));return"".concat(i,"-").concat(s)}(e):e},a={};Object.keys(t[0]).forEach((function(e){a[e]="name"==i(e)?"CSL  Customer  Project  Res":"kpi"==i(e)?"":i(e)}));var o=t.filter((function(e){return Object.values(e).some((function(e){return null!==e&&void 0!==e&&""!==e}))}));o.unshift(a);var c=o.map((function(e){var n=[];return s.forEach((function(r){n.push(e[r])})),n}));c.forEach((function(e){r.addRow(e)})),[1].forEach((function(e){r.getRow(e).font={bold:!0}}));for(var u=s.indexOf("name"),d=1,p=c[0][u],m=1;m<c.length;m++){var f=c[m][u];f!==p&&(m-d>0&&r.mergeCells(d+1,u,m,u),d=m,p=f)}c.length-d>0&&r.mergeCells(d+1,u,c.length,u),n.xlsx.writeBuffer().then((function(e){saveAs(new Blob([e]),"Revenue Analysis.xlsx")}))}))}})}),(0,C.jsx)(Z.ZP,{columns:q,data:O,enableExpanding:function(e){return"name"===e.id},enableRowVirtualization:!0,enablePagination:!1,enableGlobalFilter:!0,enableDensityToggle:!1,enableFullScreenToggle:!1,enableHiding:!1,enableColumnFilters:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!1,filterFromLeafRows:!0,initialState:{showGlobalFilter:!0,grouping:["name"],expanded:!0,density:"compact",columnPinning:{right:["Total"]}},muiTableContainerProps:{},muiTableBodyProps:{sx:{"&":{borderRight:"1px solid #ccc",borderBottom:"1px solid #ccc"},"& td":{borderRight:"1px solid #ccc",height:"22px",padding:"0px 5px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",padding:"0 5px"}}}}),S?(0,C.jsx)(T.Z,{handleAbort:function(){k.current&&k.current.abort(),E(!1)}}):""]})};var E=function(e){var n=e.tableData,s=e.column,t=e.selectType,c=e.month,u=e.searchdata,m=e.project,f=e.customer,g=e.resources,v=e.SalesExe,x=e.selectedCust,j=e.sortBy,b=(e.laterMeasureLabel,e.defaultMeasureLabel),k=p.N.baseUrl,N=(0,o.useRef)(null),I=(0,o.useState)(!1),S=(0,l.Z)(I,2),E=S[0],B=S[1],M=s[0],U=s[1],D=s.slice(2).sort(),V=[M,U].concat((0,R.Z)(D),["Total"]),P=(0,o.useState)(V),A=(0,l.Z)(P,2),F=A[0],L=A[1],G=(0,o.useState)([]),O=(0,l.Z)(G,2),_=O[0],z=O[1];(0,o.useEffect)((function(){L(e.column)}),[e.column]),(0,o.useEffect)((function(){for(var e=1,r=0;r<n.length;r++)n[r].id=e,++e%1e4==17&&(e+=9984);z(q(n))}),[n]);var K=h()(c).startOf("month").format("yyyy-MM-DD"),q=function(e,n){n=(0,a.Z)({id:"id",parentId:"parentId",children:"subRows"},n);var r={},s=[],t=n.children;return e.forEach((function(e){var s=e[n.id],l=e[n.parentId];r[s]=(0,a.Z)((0,a.Z)((0,i.Z)({},t,[]),e),r[s]),r[l]=r[l]||(0,i.Z)({},t,[]),r[l][t].push(r[s])})),Object.values(r).forEach((function(e){"undefined"===typeof e[n.id]&&s.push.apply(s,(0,R.Z)(e[t]))})),s},H=[{header:(0,C.jsxs)("div",{className:"legendContainer wrap",children:[(0,C.jsxs)("div",{className:"legend lightbrown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"SE"})})]}),(0,C.jsxs)("div",{className:"legend darkgreen",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Customer"})})]}),(0,C.jsxs)("div",{className:"legend purple",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Project"})})]}),(0,C.jsxs)("div",{className:"legend brown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:(0,C.jsx)("b",{children:"Res"})})]})]}),accessorKey:"name",enableGrouping:!1,GroupedCell:function(e){var n=e.cell;if("Sales Executive"==t){var r,s,c,p,h=v.find((function(e){return e.label===n.getValue()})),Z=(0,o.useState)({}),T=(0,l.Z)(Z,2),w=T[0],I=T[1],S=function(){if(h){var e=h.value,n=h.label;_.some((function(n){return n.name.includes("*".concat(e))}))?(I((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),z((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(I((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r){N.current=new AbortController;var s=setTimeout((function(){B(!0)}),2e3);d()({method:"post",url:k+"/revenuemetricsms/RevenueMarginAnalysis/GetGMASalesExecutiveFinancialsFinalData",data:{ownerDivisions:-1,month:K,duration:u.duration,countries:u.countries,searchType:u.searchType,busUnits:-1,customers:"select"==u.customers?x:u.customers,srcType:u.searchType,srcTypeId:e,tarType:r,busUnitId:-1,custId:u.custId,prjId:u.prjId,resId:u.resId,measures:u.measures,salesExecId:e,salesExecs:u.salesExecs,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:-1,indTypes:-1,indTypesId:-1},signal:N.current.signal}).then((function(t){B(!1),clearTimeout(s);var i=t.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r})})),z((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?j.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===b&&e.name.split("*")[0]===n:-1==u.sortBy?e.kpi===b&&e.name.split("*")[0]===n:j.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){B(!1),console.log("Error :",e)}))}(e,n,"Customer"))}},E=f.find((function(e){if(e.fullName===n.getValue().split("*")[0]){var s=n.getValue().split("*")[1];r=s}return e.fullName===n.getValue().split("*")[0]})),M=(0,o.useState)({}),U=(0,l.Z)(M,2),D=U[0],V=U[1],P=function(){if(E){var e=E.id,n=E.fullName;_.some((function(n){return n.name.includes("*".concat(e))}))?(V((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),z((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(V((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t){N.current=new AbortController;var i=setTimeout((function(){B(!0)}),2e3);d()({method:"post",url:k+"/revenuemetricsms/RevenueMarginAnalysis/GetGMASalesExecutiveFinancialsFinalData",data:{ownerDivisions:-1,month:K,duration:u.duration,countries:u.countries,searchType:"Sales Executive",busUnits:-1,customers:"select"==u.customers?x:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:e,prjId:u.prjId,resId:u.resId,measures:u.measures,salesExecId:t,salesExecs:u.salesExecs,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:-1,indTypes:-1,indTypesId:-1},signal:N.current.signal}).then((function(s){B(!1),clearTimeout(i);var l=s.data.data;l=l.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t,ui:n.id})})),z((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?j.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===b&&e.name.split("*")[0]===n:-1==u.sortBy?e.kpi===b&&e.name.split("*")[0]===n:j.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(l.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){B(!1),console.log("Error :",e)}))}(e,n,"Project","Customer",r))}},A=m.find((function(e){return e.name===n.getValue().split("*")[0]||e.name.includes(n.getValue().split("*")[0])&&e.id==n.row.original.ui})),F=(0,o.useState)({}),L=(0,l.Z)(F,2),G=L[0],O=L[1],q=function(){if(A){var e=A.id,r=A.name;_.some((function(n){return n.name.includes("*".concat(e))}))?(O((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),z((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(O((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t,i){N.current=new AbortController;var l=setTimeout((function(){B(!0)}),2e3);d()({method:"post",url:k+"/revenuemetricsms/RevenueMarginAnalysis/GetGMASalesExecutiveFinancialsFinalData",data:{ownerDivisions:-1,month:K,duration:u.duration,countries:u.countries,searchType:"Sales Executive",busUnits:-1,customers:"select"==u.customers?x:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:i,prjId:e,resId:u.resId,measures:u.measures,salesExecId:t,salesExecs:u.salesExecs,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:-1,indTypes:-1,indTypesId:-1},signal:N.current.signal}).then((function(s){B(!1),clearTimeout(l);var o=s.data.data;o=o.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t+"*"+i})})),z((function(r){var s=r.findIndex((function(r){return console.log("first>",r.ui," second>",n),"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?j.some((function(s){return r.kpi===(s.id==u.sortBy?s.measures:"")&&n.includes(r.name.split("*")[0])&&r.ui==e})):r.kpi===b&&n.includes(r.name.split("*")[0])&&r.ui==e:-1==u.sortBy?r.kpi===b&&n.includes(r.name.split("*")[0])&&r.ui==e:j.some((function(s){return r.kpi===(s.id==u.sortBy?s.measures:"")&&n.includes(r.name.split("*")[0])&&r.ui==e}))}));return console.log(s),-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(o.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){B(!1),console.log("Error :",e)}))}(e,r,"Res","Project",n.getValue().split("*")[3],n.getValue().split("*")[1]))}},H=g.find((function(e){var r=e.full_name.split("*")[0].split(" ").filter((function(e){return""!==e})),t=n.getValue().split("*")[0].split(" ").filter((function(e){return""!==e})),i=""==n.getValue().split("*")[0]?"":t.every((function(e){return r.includes(e)}));if(i){var a=n.getValue().split("*")[3];c=n.getValue().split("*")[1],p=n.getValue().split("*")[4],s=a}return i})),$=(0,o.useState)({}),W=(0,l.Z)($,2),Y=W[0],J=W[1],X=function(){if(H){var e=H.id,n=H.full_name;_.some((function(n){return n.name.includes("*".concat(e))}))?(J((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),z((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(J((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t,i,l){N.current=new AbortController;var o=setTimeout((function(){B(!0)}),2e3);d()({method:"post",url:k+"/revenuemetricsms/RevenueMarginAnalysis/GetGMASalesExecutiveFinancialsFinalData",data:{ownerDivisions:-1,month:K,duration:u.duration,countries:u.countries,searchType:"Sales Executive",busUnits:-1,customers:"select"==u.customers?x:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:l,prjId:i,resId:-1,measures:u.measures,salesExecId:u.salesExecId,salesExecs:u.salesExecs,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:t,indTypes:-1,indTypesId:-1},signal:N.current.signal}).then((function(s){B(!1),clearTimeout(o);var i=s.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t})})),z((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?j.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")})):e.kpi===b&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," "):-1==u.sortBy?e.kpi===b&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," "):j.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){B(!1),console.log("Error :",e)}))}(e,n,"Leaf","Res",s,c,p))}};if(h){var Q=w[h.value];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:h.value,onClick:function(){S()},className:"parent",children:[Q?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"buRM",title:h.label+" ("+n.row.original.count+")",children:[h.label," (",n.row.original.count,")"]})]})}if(E){var ee=D[E.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:E.id,onClick:function(){P()},className:"parent",children:[ee?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"custBU custRM",title:E.fullName+" ("+n.row.original.count+")",children:[E.fullName," (",n.row.original.count,")"]})]})}if(A){var ne=G[A.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:A.id,onClick:function(){q()},className:"parent",children:[ne?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"projBU projRM",title:A.name+" ("+n.row.original.count+")",children:[A.name," (",n.row.original.count,")"]})]})}if(H){var re=Y[H.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:H.id,onClick:function(){X()},className:"parent",children:[re?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsx)("b",{className:"resBU resRM",title:H.full_name+" ("+n.row.original.count+")",children:H.full_name})]})}return(0,C.jsxs)("span",{className:"child",title:""===n.row.original.name?"Summary":n.getValue().split("*")[0]+" ("+n.row.original.count+")",children:[(0,C.jsxs)("b",{className:"Customer"==n.getValue().split("*")[2]?"buRM":"Project"==n.getValue().split("*")[2]?"custRM":"Res"==n.getValue().split("*")[2]?"projRM":"Leaf"==n.getValue().split("*")[2]?"resRM":"",style:{display:""==n.row.original.name||""==n.getValue().split("*")[0]?"flex":"",justifyContent:""==n.row.original.name||""==n.getValue().split("*")[0]?"center":""},children:[""==n.row.original.name||""==n.getValue().split("*")[0]?"Summary":(0,C.jsxs)("div",{onClick:P,children:[(0,C.jsx)(y.jS6,{})," ",n.getValue().split("*")[0]]})," ",0===n.row.original.count?"":"(".concat(n.row.original.count,")")]})," "]})}}},{header:"",accessorKey:"kpi",Cell:function(e){var n=e.cell,r=v.find((function(e){return e.label===n.row.original.name})),s=f.find((function(e){return e.fullName===n.row.original.name.split("*")[0]})),t=m.find((function(e){return e.name.includes(n.row.original.name.split("*")[0])&&e.id==n.row.original.ui})),i=g.find((function(e){var r=e.full_name.split("*")[0].split(" "),s=n.row.original.name.split("*")[0].split(" ");return""==n.row.original.name.split("*")[0]?"":s.every((function(e){return r.includes(e)}))}));return(0,C.jsx)("span",{children:(0,C.jsx)("b",{className:r?"buRMchild":s?"custRMchild":t?"projRMchild":i?"resRMchild":"Customer"==n.row.original.name.split("*")[2]?"buRMchild":"Project"==n.row.original.name.split("*")[2]?"custRMchild":"Res"==n.row.original.name.split("*")[2]?"projRMchild":"Leaf"==n.row.original.name.split("*")[2]?"resRMchild":"",children:n.getValue()})})}}];F.forEach((function(e,n){if(n>1&&"Total"!==e){var r=new Date("".concat(e.slice(0,4),"-").concat(e.slice(5,7),"-").concat(e.slice(8,10))).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),s=(new Date).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),t=new Date(r)>=new Date(s);H.push({header:r,accessorKey:"".concat(e),className:"software",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)("span",{className:t?"greenColumn":"",children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:"$"}):"",(0,C.jsxs)("span",{style:{display:"block",float:"right"},children:[null==r.getValue()?0:null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:"%"}):""]})]})}})}}));var $=H.length,W={header:"Total",accessorKey:"Total",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)(C.Fragment,{children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:(0,C.jsx)("b",{children:"$"})}):"",(0,C.jsx)("span",{style:{display:"block",float:"right"},className:"total",children:(0,C.jsxs)("b",{children:[null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:null==r.getValue()?0:"%"}):""]})})]})}};return H.splice($,0,W),(0,C.jsxs)("div",{className:"materialReactExpandableTable headCountTable darkHeader",children:[(0,C.jsx)("div",{className:"mb-2",align:" right ",children:(0,C.jsx)(w.WlY,{size:"1.5em",title:"Export to Excel",style:{color:"green"},cursor:"pointer",onClick:function(){Promise.resolve().then(r.t.bind(r,25415,23)).then((function(e){var n=new e.Workbook,r=n.addWorksheet("Revenue Analysis"),s=[];(s=F).sort((function(e,n){var r=e.split("_"),s=(0,l.Z)(r,3),t=s[1],i=s[2],a=n.split("_"),o=(0,l.Z)(a,3),c=o[1],u=o[2];return t!==c?parseInt(t)-parseInt(c):parseInt(i)-parseInt(u)}));var t=F.concat(_).map((function(e){var n={};return F.forEach((function(r){var s=e[r];if("string"===typeof s){var t=s.split("^&"),i=(0,l.Z)(t,2)[0];n[r]=i}else n[r]="number"===typeof s?s.toLocaleString("en-US"):s})),"name"in n&&""===n.name?n.name="Summary":"name"in n&&""!==n.name&&void 0!==n.name&&(n.name=""==n.name.split("*")[0]?"Summary":n.name.split("*")[0]),"Planned Revenue"===n.kpi||"Actual Revenue"===n.kpi||"Recognized Revenue"===n.kpi||"Resource Direct Cost"===n.kpi||"Other Direct Cost"===n.kpi||"Gross Margin"===n.kpi?Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]="$"+(null==n[e]?"":n[e]))})):"Gross Margin %"!==n.kpi&&"Billable Utilization"!==n.kpi&&"Billed Utilization"!==n.kpi&&"FTE"!==n.kpi&&"SUBK"!==n.kpi||Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]=(null==n[e]?0:n[e])+" %")})),n})),i=function(e){return e.match(/^\d{4}_\d{2}_\d{2}$/)?function(e){var n=e.split("_"),r=(0,l.Z)(n,3),s=r[0],t=r[1],i=(r[2],new Date("".concat(s,"-").concat(t,"-01")).toLocaleString("en-us",{month:"short"}));return"".concat(i,"-").concat(s)}(e):e},a={};Object.keys(t[0]).forEach((function(e){a[e]="name"==i(e)?"SE  Customer  Project  Res":"kpi"==i(e)?"":i(e)}));var o=t.filter((function(e){return Object.values(e).some((function(e){return null!==e&&void 0!==e&&""!==e}))}));o.unshift(a);var c=o.map((function(e){var n=[];return s.forEach((function(r){n.push(e[r])})),n}));c.forEach((function(e){r.addRow(e)})),[1].forEach((function(e){r.getRow(e).font={bold:!0}}));for(var u=s.indexOf("name"),d=1,p=c[0][u],m=1;m<c.length;m++){var f=c[m][u];f!==p&&(m-d>0&&r.mergeCells(d+1,u,m,u),d=m,p=f)}c.length-d>0&&r.mergeCells(d+1,u,c.length,u),n.xlsx.writeBuffer().then((function(e){saveAs(new Blob([e]),"Revenue Analysis.xlsx")}))}))}})}),(0,C.jsx)(Z.ZP,{columns:H,data:_,enableExpanding:function(e){return"name"===e.id},enableRowVirtualization:!0,enablePagination:!1,enableGlobalFilter:!0,enableDensityToggle:!1,enableFullScreenToggle:!1,enableHiding:!1,enableColumnFilters:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!1,filterFromLeafRows:!0,initialState:{showGlobalFilter:!0,grouping:["name"],expanded:!0,density:"compact",columnPinning:{right:["Total"]}},muiTableContainerProps:{},muiTableBodyProps:{sx:{"&":{borderRight:"1px solid #ccc",borderBottom:"1px solid #ccc"},"& td":{borderRight:"1px solid #ccc",height:"22px",padding:"0px 5px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",padding:"0 5px"}}}}),E?(0,C.jsx)(T.Z,{handleAbort:function(){N.current&&N.current.abort(),B(!1)}}):""]})};var B=function(e){var n=e.tableData,s=e.column,t=e.departments,c=e.selectType,u=e.month,m=e.searchdata,f=e.project,g=e.customer,v=e.resources,x=e.selectedCust,j=e.sortBy,b=(e.laterMeasureLabel,e.defaultMeasureLabel),k=p.N.baseUrl,N=(0,o.useRef)(null),I=(0,o.useState)(!1),S=(0,l.Z)(I,2),E=S[0],B=S[1],M=s[0],U=s[1];console.log(j);var D=s.slice(2).sort(),V=[M,U].concat((0,R.Z)(D),["Total"]),P=(0,o.useState)(V),A=(0,l.Z)(P,2),F=A[0],L=A[1],G=(0,o.useState)([]),O=(0,l.Z)(G,2),_=O[0],z=O[1];(0,o.useEffect)((function(){L(e.column)}),[e.column]),(0,o.useEffect)((function(){for(var e=1,r=0;r<n.length;r++)n[r].id=e,++e%1e4==17&&(e+=9984);z(q(n))}),[n]);var K=h()(u).startOf("month").format("yyyy-MM-DD"),q=function(e,n){n=(0,a.Z)({id:"id",parentId:"parentId",children:"subRows"},n);var r={},s=[],t=n.children;return e.forEach((function(e){var s=e[n.id],l=e[n.parentId];r[s]=(0,a.Z)((0,a.Z)((0,i.Z)({},t,[]),e),r[s]),r[l]=r[l]||(0,i.Z)({},t,[]),r[l][t].push(r[s])})),Object.values(r).forEach((function(e){"undefined"===typeof e[n.id]&&s.push.apply(s,(0,R.Z)(e[t]))})),s},H=[{header:(0,C.jsxs)("div",{className:"legendContainer wrap",children:[(0,C.jsxs)("div",{className:"legend darkgreen",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:"Customer"})]}),(0,C.jsxs)("div",{className:"legend  purple",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:"Project"})]}),(0,C.jsxs)("div",{className:"legend  lightbrown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:"BU"})]}),(0,C.jsxs)("div",{className:"legend brown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:"Res"})]})]}),accessorKey:"name",enableGrouping:!1,GroupedCell:function(e){var n=e.cell;if("Customer"==c){var r,s,u=g.find((function(e){return e.fullName===n.getValue()})),p=(0,o.useState)({}),h=(0,l.Z)(p,2),Z=h[0],T=h[1],w=function(){if(u){var e=u.id,n=u.fullName;_.some((function(n){return n.name.includes("*".concat(e))}))?(T((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),z((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(T((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r){N.current=new AbortController;var s=setTimeout((function(){B(!0)}),2e3);d()({method:"post",url:k+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:K,duration:m.duration,countries:m.countries,searchType:m.searchType,busUnits:m.busUnits,customers:"select"==m.customers?x:"0"==m.customers?m.activeCustomers:m.customers,srcType:m.searchType,srcTypeId:e,tarType:r,busUnitId:-1,custId:e,prjId:m.prjId,resId:m.resId,measures:m.measures,salesExecId:m.salesExecId,salesExecs:-1,sortBy:m.sortBy,custCountries:m.custCountries,source:m.source,resTyp:m.resTyp,engCountries:m.engCountries,contTerms:m.contTerms,engComp:m.engComp,cslRes:m.cslRes,cslResId:m.cslResId,dpRes:-1,dpResId:m.dpResId,indTypes:-1,indTypesId:m.indTypesId},signal:N.current.signal}).then((function(t){B(!1),clearTimeout(s);var i=t.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r,ui:n.id})})),z((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=m.measures?-1!=m.sortBy?j.some((function(r){return e.kpi===(r.id==m.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===b&&e.name.split("*")[0]===n:-1==m.sortBy?e.kpi===b&&e.name.split("*")[0]===n:j.some((function(r){return e.kpi===(r.id==m.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){B(!1),console.log("Error :",e)}))}(e,n,"Project"))}},I=f.find((function(e){return e.name===n.getValue().split("*")[0]||e.name.includes(n.getValue().split("*")[0])&&e.id==n.row.original.ui})),S=(0,o.useState)({}),E=(0,l.Z)(S,2),M=E[0],U=E[1],D=function(){if(I){var e=I.id,r=I.name;_.some((function(n){return n.name.includes("*".concat(e))}))?(U((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),z((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(U((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t){N.current=new AbortController;var i=setTimeout((function(){B(!0)}),2e3);d()({method:"post",url:k+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:K,duration:m.duration,countries:m.countries,searchType:"Customer",busUnits:m.busUnits,customers:"select"==m.customers?x:"0"==m.customers?m.activeCustomers:m.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:t,prjId:e,resId:m.resId,measures:m.measures,salesExecId:m.salesExecId,salesExecs:-1,sortBy:m.sortBy,custCountries:m.custCountries,source:m.source,resTyp:m.resTyp,engCountries:m.engCountries,contTerms:m.contTerms,engComp:m.engComp,cslRes:m.cslRes,cslResId:m.cslResId,dpRes:-1,dpResId:m.dpResId,indTypes:-1,indTypesId:m.indTypesId},signal:N.current.signal}).then((function(s){B(!1),clearTimeout(i);var l=s.data.data;l=l.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t})})),z((function(r){var s=r.findIndex((function(r){return"1350,638,965,639,640,641,643,644,872,761"!=m.measures?-1!=m.sortBy?j.some((function(s){return r.kpi===(s.id==m.sortBy?s.measures:"")&&n.includes(r.name.split("*")[0])&&r.ui==e})):r.kpi===b&&n.includes(r.name.split("*")[0])&&r.ui==e:-1==m.sortBy?r.kpi===b&&n.includes(r.name.split("*")[0])&&r.ui==e:j.some((function(s){return r.kpi===(s.id==m.sortBy?s.measures:"")&&n.includes(r.name.split("*")[0])&&r.ui==e}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(l.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){B(!1),console.log("Error :",e)}))}(e,r,"BusinessUnit","Project",n.getValue().split("*")[1]))}},V=t.find((function(e){if(e.label===n.getValue().split("*")[0]){var t=n.getValue().split("*")[3];r=t,s=n.getValue().split("*")[1]}return e.label===n.getValue().split("*")[0]||e.label===n.getValue().split("*")[0]})),P=(0,o.useState)({}),A=(0,l.Z)(P,2),F=A[0],L=A[1],G=function(){if(V){var e=V.value,n=V.label;_.some((function(n){return n.name.includes("*".concat(e))}))?(L((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),z((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(L((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t,i){N.current=new AbortController;var l=setTimeout((function(){B(!0)}),2e3);d()({method:"post",url:k+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:K,duration:m.duration,countries:m.countries,searchType:"Customer",busUnits:m.busUnits,customers:"select"==m.customers?x:"0"==m.customers?m.activeCustomers:m.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:e,custId:t,prjId:i,resId:m.resId,measures:m.measures,salesExecId:m.salesExecId,salesExecs:-1,sortBy:m.sortBy,custCountries:m.custCountries,source:m.source,resTyp:m.resTyp,engCountries:m.engCountries,contTerms:m.contTerms,engComp:m.engComp,cslRes:m.cslRes,cslResId:m.cslResId,dpRes:-1,dpResId:m.dpResId,indTypes:-1,indTypesId:m.indTypesId},signal:N.current.signal}).then((function(s){B(!1),clearTimeout(l);var o=s.data.data;o=o.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t+"*"+i})})),z((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=m.measures?-1!=m.sortBy?j.some((function(r){return e.kpi===(r.id==m.sortBy?r.measures:"")&&e.name.split("*")[0]===n})):e.kpi===b&&e.name.split("*")[0]===n:-1==m.sortBy?e.kpi===b&&e.name.split("*")[0]===n:j.some((function(r){return e.kpi===(r.id==m.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(o.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){B(!1),console.log("Error :",e)}))}(e,n,"Res","BusinessUnit",r,s))}},O=v.find((function(e){if(e.full_name===n.getValue().split("*")[0]){var r=n.getValue().split("*")[3];n.getValue().split("*")[1],n.getValue().split("*")[4],r}var s=e.full_name.split("*")[0].split(" ").filter((function(e){return""!==e})),t=n.getValue().split("*")[0].split(" ").filter((function(e){return""!==e}));return""==n.getValue().split("*")[0]?"":t.every((function(e){return s.includes(e)}))})),q=(0,o.useState)({}),H=(0,l.Z)(q,2),$=H[0],W=H[1],Y=function(){if(O){var e=O.id,r=O.full_name;_.some((function(n){return n.name.includes("*".concat(e))}))?(W((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),z((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(W((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t,i,l){N.current=new AbortController;var o=setTimeout((function(){B(!0)}),2e3);d()({method:"post",url:k+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:K,duration:m.duration,countries:m.countries,searchType:"Customer",busUnits:m.busUnits,customers:"select"==m.customers?x:"0"==m.customers?m.activeCustomers:m.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:i,custId:t,prjId:l,resId:-1,measures:m.measures,salesExecId:m.salesExecId,salesExecs:-1,sortBy:m.sortBy,custCountries:m.custCountries,source:m.source,resTyp:m.resTyp,engCountries:m.engCountries,contTerms:m.contTerms,engComp:m.engComp,cslRes:m.cslRes,cslResId:m.cslResId,dpRes:-1,dpResId:m.dpResId,indTypes:-1,indTypesId:m.indTypesId},signal:N.current.signal}).then((function(s){B(!1),clearTimeout(o);var i=s.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t})})),z((function(r){var s=r.findIndex((function(e){return"1350,638,965,639,640,641,643,644,872,761"!=m.measures?-1!=m.sortBy?j.some((function(r){return e.kpi===(r.id==m.sortBy?r.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")})):e.kpi===b&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," "):-1==m.sortBy?e.kpi===b&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," "):j.some((function(r){return e.kpi===(r.id==m.sortBy?r.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){B(!1),console.log("Error :",e)}))}(e,r,"Leaf","Res",n.getValue().split("*")[3],n.getValue().split("*")[1],n.getValue().split("*")[4]))}};if(u){var J=Z[u.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:u.id,onClick:function(){w()},className:"parent",children:[J?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"custRM",title:u.fullName+" ("+n.row.original.count+")",children:[u.fullName," (",n.row.original.count,")"]})]})}if(I){var X=M[I.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:I.id,onClick:function(){D()},className:"parent",children:[X?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsx)("b",{className:"projRM",title:I.name+" ("+n.row.original.count+")",children:""==n.getValue().split("*")[0]?"Summary":I.name+" ("+n.row.original.count+")"})]})}if(V){var Q=F[V.value];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:V.value,onClick:function(){G()},className:"parent",children:[Q?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"buRM",title:V.label+" ("+n.row.original.count+")",children:[V.label," (",n.row.original.count,")"]})]})}if(O){var ee=$[O.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:O.id,onClick:function(){Y()},className:"parent",children:[ee?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsx)("b",{className:"resRM",title:O.full_name,children:O.full_name})]})}return(0,C.jsxs)("span",{className:"child",title:""===n.row.original.name?"Summary":n.getValue().split("*")[0]+" ("+n.row.original.count+")",children:[(0,C.jsxs)("b",{className:"Project"==n.getValue().split("*")[2]?"custRM":"BusinessUnit"==n.getValue().split("*")[2]?"projRM":"Res"==n.getValue().split("*")[2]?"buRM":"Leaf"==n.getValue().split("*")[2]?"resRM":"",style:{display:""==n.row.original.name||""==n.getValue().split("*")[0]?"flex":"",justifyContent:""==n.row.original.name||""==n.getValue().split("*")[0]?"center":""},children:[""==n.row.original.name||""==n.getValue().split("*")[0]?"Summary":(0,C.jsxs)("div",{onClick:D,children:[(0,C.jsx)(y.jS6,{})," ",n.getValue().split("*")[0]]})," ",0===n.row.original.count?"":"(".concat(n.row.original.count,")")]})," "]})}}},{header:"",accessorKey:"kpi",Cell:function(e){var n=e.cell,r=g.find((function(e){return e.fullName===n.row.original.name})),s=f.find((function(e){return e.name===n.row.original.name.split("*")[0]})),i=t.find((function(e){return e.label===n.row.original.name.split("*")[0]})),a=v.find((function(e){var r=e.full_name.split("*")[0].split(" "),s=n.row.original.name.split("*")[0].split(" ");return""==n.row.original.name.split("*")[0]?"":s.every((function(e){return r.includes(e)}))}));return(0,C.jsx)("span",{children:(0,C.jsx)("b",{className:r?"custRMchild":s?"projRMchild":i?"buRMchild":a?"resRMchild":"Project"==n.row.original.name.split("*")[2]?"custRMchild":"BusinessUnit"==n.row.original.name.split("*")[2]?"projRMchild":"Res"==n.row.original.name.split("*")[2]?"buRMchild":"Leaf"==n.row.original.name.split("*")[2]?"resRMchild":"",children:n.getValue()})})}}];F.forEach((function(e,n){if(n>1&&"Total"!==e){var r=new Date("".concat(e.slice(0,4),"-").concat(e.slice(5,7),"-").concat(e.slice(8,10))).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),s=(new Date).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),t=new Date(r)>=new Date(s);H.push({header:r,accessorKey:"".concat(e),className:"software",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)("span",{className:t?"greenColumn":"",children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:"$"}):"",(0,C.jsxs)("span",{style:{display:"block",float:"right"},children:[null==r.getValue()?0:null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:"%"}):""]})]})}})}}));var $=H.length,W={header:"Total",accessorKey:"Total",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)(C.Fragment,{children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:(0,C.jsx)("b",{children:"$"})}):"",(0,C.jsx)("span",{style:{display:"block",float:"right"},className:"total",children:(0,C.jsxs)("b",{children:[null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:null==r.getValue()?0:"%"}):""]})})]})}};return H.splice($,0,W),console.log({nodes:_,dynamicColumns:H}),(0,C.jsxs)("div",{className:"materialReactExpandableTable headCountTable darkHeader",children:[(0,C.jsx)("div",{className:"mb-2",align:" right ",children:(0,C.jsx)(w.WlY,{size:"1.5em",title:"Export to Excel",style:{color:"green"},cursor:"pointer",onClick:function(){Promise.resolve().then(r.t.bind(r,25415,23)).then((function(e){var n=new e.Workbook,r=n.addWorksheet("Revenue Analysis"),s=[];(s=F).sort((function(e,n){var r=e.split("_"),s=(0,l.Z)(r,3),t=s[1],i=s[2],a=n.split("_"),o=(0,l.Z)(a,3),c=o[1],u=o[2];return t!==c?parseInt(t)-parseInt(c):parseInt(i)-parseInt(u)}));var t=F.concat(_).map((function(e){var n={};return F.forEach((function(r){var s=e[r];if("string"===typeof s){var t=s.split("^&"),i=(0,l.Z)(t,2)[0];n[r]=i}else n[r]="number"===typeof s?s.toLocaleString("en-US"):s})),"name"in n&&""===n.name?n.name="Summary":"name"in n&&""!==n.name&&void 0!==n.name&&(n.name=""==n.name.split("*")[0]?"Summary":n.name.split("*")[0]),"Planned Revenue"===n.kpi||"Actual Revenue"===n.kpi||"Recognized Revenue"===n.kpi||"Resource Direct Cost"===n.kpi||"Other Direct Cost"===n.kpi||"Gross Margin"===n.kpi?Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]="$"+(null==n[e]?"":n[e]))})):"Gross Margin %"!==n.kpi&&"Billable Utilization"!==n.kpi&&"Billed Utilization"!==n.kpi&&"FTE"!==n.kpi&&"SUBK"!==n.kpi||Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]=(null==n[e]?0:n[e])+" %")})),n})),i=function(e){return e.match(/^\d{4}_\d{2}_\d{2}$/)?function(e){var n=e.split("_"),r=(0,l.Z)(n,3),s=r[0],t=r[1],i=(r[2],new Date("".concat(s,"-").concat(t,"-01")).toLocaleString("en-us",{month:"short"}));return"".concat(i,"-").concat(s)}(e):e},a={};Object.keys(t[0]).forEach((function(e){a[e]="name"==i(e)?"Customer  Project  BU  Res":"kpi"==i(e)?"":i(e)}));var o=t.filter((function(e){return Object.values(e).some((function(e){return null!==e&&void 0!==e&&""!==e}))}));o.unshift(a);var c=o.map((function(e){var n=[];return s.forEach((function(r){n.push(e[r])})),n}));c.forEach((function(e){r.addRow(e)})),[1].forEach((function(e){r.getRow(e).font={bold:!0}}));for(var u=s.indexOf("name"),d=1,p=c[0][u],m=1;m<c.length;m++){var f=c[m][u];f!==p&&(m-d>0&&r.mergeCells(d+1,u,m,u),d=m,p=f)}c.length-d>0&&r.mergeCells(d+1,u,c.length,u),n.xlsx.writeBuffer().then((function(e){saveAs(new Blob([e]),"Revenue Analysis.xlsx")}))}))}})}),(0,C.jsx)(Z.ZP,{columns:H,data:_,enableExpanding:function(e){return"name"===e.id},enableRowVirtualization:!0,enablePagination:!1,enableGlobalFilter:!0,enableDensityToggle:!1,enableFullScreenToggle:!1,enableHiding:!1,enableColumnFilters:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!1,filterFromLeafRows:!0,initialState:{showGlobalFilter:!0,grouping:["name"],expanded:!0,density:"compact",columnPinning:{right:["Total"]}},muiTableContainerProps:{},muiTableBodyProps:{sx:{"&":{borderRight:"1px solid #ccc",borderBottom:"1px solid #ccc"},"& td":{borderRight:"1px solid #ccc",height:"22px",padding:"0px 5px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",padding:"0 5px"}}}}),E?(0,C.jsx)(T.Z,{handleAbort:function(){N.current&&N.current.abort(),B(!1)}}):""]})};var M=function(e){var n=e.tableData,s=e.column,t=e.selectType,c=e.month,u=e.searchdata,m=e.project,f=e.resources,g=e.sortBy,v=(e.laterMeasureLabel,e.defaultMeasureLabel),x=p.N.baseUrl,j=(0,o.useRef)(null),b=(0,o.useState)(!1),k=(0,l.Z)(b,2),N=k[0],I=k[1],S=s[0],E=s[1],B=s.slice(2).sort(),M=[S,E].concat((0,R.Z)(B),["Total"]),U=(0,o.useState)(M),D=(0,l.Z)(U,2),V=D[0],P=D[1],A=(0,o.useState)([]),F=(0,l.Z)(A,2),L=F[0],G=F[1];(0,o.useEffect)((function(){P(e.column)}),[e.column]),(0,o.useEffect)((function(){for(var e=1,r=0;r<n.length;r++)n[r].id=e,++e%1e4==17&&(e+=9984);G(_(n))}),[n]);var O=h()(c).startOf("month").format("yyyy-MM-DD"),_=function(e,n){n=(0,a.Z)({id:"id",parentId:"parentId",children:"subRows"},n);var r={},s=[],t=n.children;return e.forEach((function(e){var s=e[n.id],l=e[n.parentId];r[s]=(0,a.Z)((0,a.Z)((0,i.Z)({},t,[]),e),r[s]),r[l]=r[l]||(0,i.Z)({},t,[]),r[l][t].push(r[s])})),Object.values(r).forEach((function(e){"undefined"===typeof e[n.id]&&s.push.apply(s,(0,R.Z)(e[t]))})),s},z=[{header:(0,C.jsxs)("div",{className:"legendContainer wrap",children:[(0,C.jsxs)("div",{className:"legend  purple",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:"Project"})]}),(0,C.jsxs)("div",{className:"legend brown",children:[(0,C.jsx)("div",{className:"legendCircle"}),(0,C.jsx)("div",{className:"legendTxt",children:"Res"})]})]}),accessorKey:"name",enableGrouping:!1,GroupedCell:function(e){var n=e.cell;if("Project"==t){var r,s=m.find((function(e){return e.name===n.getValue()})),c=(0,o.useState)({}),p=(0,l.Z)(c,2),h=p[0],b=p[1],Z=function(){if(s){var e=s.id,n=s.name;L.some((function(n){return n.name.includes("*".concat(e))}))?(b((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),G((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(b((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r){j.current=new AbortController;var s=setTimeout((function(){I(!0)}),2e3);d()({method:"post",url:x+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:O,duration:u.duration,countries:u.countries,searchType:u.searchType,busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:u.searchType,srcTypeId:e,tarType:r,busUnitId:-1,custId:-1,prjId:e,resId:u.resId,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:u.dpResId,indTypes:-1,indTypesId:u.indTypesId},signal:j.current.signal}).then((function(t){I(!1),clearTimeout(s);var i=t.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r})})),G((function(r){var s=r.findIndex((function(e){return-1==u.sortBy?"Planned Revenue"===e.descr&&e.name===n:g.some((function(r){return e.kpi===(r.id==u.sortBy?r.measures:"")&&e.name.split("*")[0]===n}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){I(!1),console.log("Error :",e)}))}(e,n,"Res"))}},T=f.find((function(e){var s=e.full_name.split(" "),t=n.getValue().split("*")[0].split(" ");if(e.full_name===n.getValue().split("*")[0]||t.every((function(e){return s.includes(e)}))){var i=n.getValue().split("*")[1];r=i}return""==n.getValue().split("*")[0]?"":t.every((function(e){return s.includes(e)}))})),w=(0,o.useState)({}),k=(0,l.Z)(w,2),N=k[0],S=k[1],E=function(){if(T){var e=T.id,n=T.full_name;L.some((function(n){return n.name.includes("*".concat(e))}))?(S((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),G((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(S((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r,s,t){j.current=new AbortController;var i=setTimeout((function(){I(!0)}),2e3);d()({method:"post",url:x+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:O,duration:u.duration,countries:u.countries,searchType:"Project",busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:s,srcTypeId:e,tarType:r,busUnitId:-1,custId:-1,prjId:t,resId:u.resId,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:u.dpResId,indTypes:-1,indTypesId:u.indTypesId},signal:j.current.signal}).then((function(s){I(!1),clearTimeout(i);var l=s.data.data;l=l.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r+"*"+t})})),G((function(r){var s=r.findIndex((function(e){var r=e.name.split("*")[0].replace(/\s+/g," ").split(" "),s=n.replace(/\s+/g," ").split(" ");return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?g.some((function(t){return e.kpi===(t.id==u.sortBy?t.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")||r.every((function(e){return s.includes(e)}))})):e.kpi===v&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")||r.every((function(e){return s.includes(e)})):-1==u.sortBy?e.kpi===v&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")||r.every((function(e){return s.includes(e)})):g.some((function(t){return e.kpi===(t.id==u.sortBy?t.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")||r.every((function(e){return s.includes(e)}))}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(l.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){I(!1),console.log("Error :",e)}))}(e,n,"Leaf","Res",r))}};if(s){var B=h[s.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:s.id,onClick:function(){Z()},className:"parent",children:[B?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsxs)("b",{className:"projRM",title:s.name+" ("+n.row.original.count+")",children:[s.name," (",n.row.original.count,")"]})]})}if(T){var M=N[T.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:T.id,onClick:function(){E()},className:"parent",children:[M?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsx)("b",{className:"resRM",title:T.full_name+" ("+n.row.original.count+")",children:T.full_name})]})}return(0,C.jsxs)("span",{className:"child",title:""===n.row.original.name?"Summary":n.getValue().split("*")[0]+" ("+n.row.original.count+")",children:[(0,C.jsxs)("b",{className:"Res"==n.getValue().split("*")[2]?"projRM":"Leaf"==n.getValue().split("*")[2]?"resRM":"",style:{display:""==n.row.original.name||""==n.getValue().split("*")[0]?"flex":"",justifyContent:""==n.row.original.name||""==n.getValue().split("*")[0]?"center":""},children:[""==n.row.original.name||""==n.getValue().split("*")[0]?"Summary":(0,C.jsxs)("div",{onClick:E,children:[(0,C.jsx)(y.jS6,{})," ",n.getValue().split("*")[0]]})," ",0===n.row.original.count?"":"(".concat(n.row.original.count,")")]})," "]})}}},{header:"",accessorKey:"kpi",Cell:function(e){var n=e.cell,r=m.find((function(e){return e.name===n.row.original.name})),s=f.find((function(e){var r=e.full_name.split(" "),s=n.row.original.name.split("*")[0].split(" ");return""==n.row.original.name.split("*")[0]?"":s.every((function(e){return r.includes(e)}))}));return(0,C.jsx)("span",{children:(0,C.jsx)("b",{className:r?"projRM":s?"resRM":"Res"==n.row.original.name.split("*")[2]?"projRM":"Leaf"==n.row.original.name.split("*")[2]?"resRM":"",children:n.getValue()})})}}];V.forEach((function(e,n){if(n>1&&"Total"!==e){var r=new Date("".concat(e.slice(0,4),"-").concat(e.slice(5,7),"-").concat(e.slice(8,10))).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),s=(new Date).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),t=new Date(r)>=new Date(s);z.push({header:r,accessorKey:"".concat(e),className:"software",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)("span",{className:t?"greenColumn":"",children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:"$"}):"",(0,C.jsxs)("span",{style:{display:"block",float:"right"},children:[null==r.getValue()?0:null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:"%"}):""]})]})}})}}));var K=z.length,q={header:"Total",accessorKey:"Total",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)(C.Fragment,{children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:(0,C.jsx)("b",{children:"$"})}):"",(0,C.jsx)("span",{style:{display:"block",float:"right"},className:"total",children:(0,C.jsxs)("b",{children:[null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi||"SUBK"==r.row.original.kpi?(0,C.jsx)("span",{children:null==r.getValue()?0:"%"}):""]})})]})}};return z.splice(K,0,q),(0,C.jsxs)("div",{className:"materialReactExpandableTable headCountTable darkHeader",children:[(0,C.jsx)("div",{className:"mb-2",align:" right ",children:(0,C.jsx)(w.WlY,{size:"1.5em",title:"Export to Excel",style:{color:"green"},cursor:"pointer",onClick:function(){Promise.resolve().then(r.t.bind(r,25415,23)).then((function(e){var n=new e.Workbook,r=n.addWorksheet("Revenue Analysis"),s=[];(s=V).sort((function(e,n){var r=e.split("_"),s=(0,l.Z)(r,3),t=s[1],i=s[2],a=n.split("_"),o=(0,l.Z)(a,3),c=o[1],u=o[2];return t!==c?parseInt(t)-parseInt(c):parseInt(i)-parseInt(u)}));var t=V.concat(L).map((function(e){var n={};return V.forEach((function(r){var s=e[r];if("string"===typeof s){var t=s.split("^&"),i=(0,l.Z)(t,2)[0];n[r]=i}else n[r]="number"===typeof s?s.toLocaleString("en-US"):s})),"name"in n&&""===n.name?n.name="Summary":"name"in n&&""!==n.name&&void 0!==n.name&&(n.name=""==n.name.split("*")[0]?"Summary":n.name.split("*")[0]),"Planned Revenue"===n.kpi||"Actual Revenue"===n.kpi||"Recognized Revenue"===n.kpi||"Resource Direct Cost"===n.kpi||"Other Direct Cost"===n.kpi||"Gross Margin"===n.kpi?Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]="$"+(null==n[e]?"":n[e]))})):"Gross Margin %"!==n.kpi&&"Billable Utilization"!==n.kpi&&"Billed Utilization"!==n.kpi&&"FTE"!==n.kpi&&"SUBK"!==n.kpi||Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]=(null==n[e]?0:n[e])+" %")})),n})),i=function(e){return e.match(/^\d{4}_\d{2}_\d{2}$/)?function(e){var n=e.split("_"),r=(0,l.Z)(n,3),s=r[0],t=r[1],i=(r[2],new Date("".concat(s,"-").concat(t,"-01")).toLocaleString("en-us",{month:"short"}));return"".concat(i,"-").concat(s)}(e):e},a={};Object.keys(t[0]).forEach((function(e){a[e]="name"==i(e)?"Project   Res":"kpi"==i(e)?"":i(e)}));var o=t.filter((function(e){return Object.values(e).some((function(e){return null!==e&&void 0!==e&&""!==e}))}));o.unshift(a);var c=o.map((function(e){var n=[];return s.forEach((function(r){n.push(e[r])})),n}));c.forEach((function(e){r.addRow(e)})),[1].forEach((function(e){r.getRow(e).font={bold:!0}}));for(var u=s.indexOf("name"),d=1,p=c[0][u],m=1;m<c.length;m++){var f=c[m][u];f!==p&&(m-d>0&&r.mergeCells(d+1,u,m,u),d=m,p=f)}c.length-d>0&&r.mergeCells(d+1,u,c.length,u),n.xlsx.writeBuffer().then((function(e){saveAs(new Blob([e]),"Revenue Analysis.xlsx")}))}))}})}),(0,C.jsx)(Z.ZP,{columns:z,data:L,enableExpanding:function(e){return"name"===e.id},enableRowVirtualization:!0,enablePagination:!1,enableGlobalFilter:!0,enableDensityToggle:!1,enableFullScreenToggle:!1,enableHiding:!1,enableColumnFilters:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!1,filterFromLeafRows:!0,initialState:{showGlobalFilter:!0,grouping:["name"],expanded:!0,density:"compact",columnPinning:{right:["Total"]}},muiTableContainerProps:{},muiTableBodyProps:{sx:{"&":{borderRight:"1px solid #ccc",borderBottom:"1px solid #ccc"},"& td":{borderRight:"1px solid #ccc",height:"22px",padding:"0px 5px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",padding:"0 5px"}}}}),N?(0,C.jsx)(T.Z,{handleAbort:function(){j.current&&j.current.abort(),I(!1)}}):""]})},U=(r(59962),r(78983)),D=r(1684);var V=function(e){var n=e.showPopup,r=e.setShowPopup,s=e.setSelectedResource,t=e.setResName,i=(0,o.useState)(""),a=(0,l.Z)(i,2),c=a[0],u=a[1],d=(0,o.useState)(!1),p=(0,l.Z)(d,2),m=p[0],f=p[1];return(0,C.jsx)("div",{children:(0,C.jsxs)(U.Tk,{visible:n,alignment:"center",size:"md",onClose:function(){r(!1),t("Select Resource")},backdrop:"static",children:[(0,C.jsx)(U.p0,{className:"",children:(0,C.jsx)(U.fl,{children:(0,C.jsx)("span",{className:"",children:"Resource Directory"})})}),(0,C.jsx)(U.sD,{children:(0,C.jsxs)("div",{className:"col-md-12",children:[(0,C.jsx)("div",{className:"form-group row mb-2"}),(0,C.jsx)(D.Z,{setNodeClicked:function(e){console.log(e),u(e)},validation:m,setResName:t}),(0,C.jsx)("div",{className:" form-group col-md-12 col-sm-12 col-xs-12 btn-container center my-3 mb-2",children:(0,C.jsx)("button",{className:"btn btn-primary",type:"ok",onClick:function(){""==c?f(!0):(s(c),r(!1),f(!1))},children:"OK"})})]})})]})})};var P=function(e){var n=e.tableData,s=e.column,t=e.selectType,c=e.month,u=e.searchdata,m=e.resourceData,f=e.sortBy,g=(e.laterMeasureLabel,e.defaultMeasureLabel),v=p.N.baseUrl,x=(0,o.useRef)(null),j=(0,o.useState)(!1),b=(0,l.Z)(j,2),k=b[0],N=b[1],I=s[0],S=s[1],E=s.slice(2).sort(),B=[I,S].concat((0,R.Z)(E),["Total"]),M=(0,o.useState)(B),U=(0,l.Z)(M,2),D=U[0],V=U[1],P=(0,o.useState)([]),A=(0,l.Z)(P,2),F=A[0],L=A[1];(0,o.useEffect)((function(){V(e.column)}),[e.column]),(0,o.useEffect)((function(){for(var e=1,r=0;r<n.length;r++)n[r].id=e,++e%1e4==17&&(e+=9984);L(O(n))}),[n]);var G=h()(c).startOf("month").format("yyyy-MM-DD"),O=function(e,n){n=(0,a.Z)({id:"id",parentId:"parentId",children:"subRows"},n);var r={},s=[],t=n.children;return e.forEach((function(e){var s=e[n.id],l=e[n.parentId];r[s]=(0,a.Z)((0,a.Z)((0,i.Z)({},t,[]),e),r[s]),r[l]=r[l]||(0,i.Z)({},t,[]),r[l][t].push(r[s])})),Object.values(r).forEach((function(e){"undefined"===typeof e[n.id]&&s.push.apply(s,(0,R.Z)(e[t]))})),s},_=[{header:(0,C.jsx)("div",{className:"mb-1",children:"Supervisor/Res"}),accessorKey:"name",enableGrouping:!1,GroupedCell:function(e){var n=e.cell;if("Resource"==t){var r=m.find((function(e){var r=e.full_name.split(" "),s=n.getValue().split(" ");return""==n.getValue()?"":s.every((function(e){return r.includes(e)}))})),s=(0,o.useState)({}),c=(0,l.Z)(s,2),p=c[0],h=c[1],j=function(){if(r){var e=r.id,n=r.full_name,s=F.some((function(n){return n.name.includes("*".concat(e))}));console.log(F),s?(h((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!1))})),L((function(n){return n.filter((function(n){return!n.name.includes("*".concat(e))}))}))):(h((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e,!0))})),function(e,n,r){console.log("Inside HID"),x.current=new AbortController;var s=setTimeout((function(){N(!0)}),2e3);d()({method:"post",url:v+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{ownerDivisions:-1,month:G,duration:u.duration,countries:u.countries,searchType:u.searchType,busUnits:-1,customers:"select"==u.customers?selectedCust:u.customers,srcType:u.searchType,srcTypeId:e,tarType:r,busUnitId:-1,custId:-1,prjId:-1,resId:u.resId,measures:u.measures,salesExecId:u.salesExecId,salesExecs:-1,sortBy:u.sortBy,custCountries:u.custCountries,source:u.source,resTyp:u.resTyp,engCountries:u.engCountries,contTerms:u.contTerms,engComp:u.engComp,cslRes:u.cslRes,cslResId:u.cslResId,dpRes:-1,dpResId:u.dpResId,indTypes:-1,indTypesId:u.indTypesId},signal:x.current.signal}).then((function(t){N(!1),clearTimeout(s);var i=t.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"*"+e+"*"+r})})),L((function(r){var s=r.findIndex((function(e){var r=e.name.split("*")[0].replace(/\s+/g," ").split(" "),s=n.replace(/\s+/g," ").split(" ");return"1350,638,965,639,640,641,643,644,872,761"!=u.measures?-1!=u.sortBy?f.some((function(t){return e.kpi===(t.id==u.sortBy?t.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")||r.every((function(e){return s.includes(e)}))})):e.kpi===g&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")||r.every((function(e){return s.includes(e)})):-1==u.sortBy?e.kpi===g&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")||r.every((function(e){return s.includes(e)})):f.some((function(t){return e.kpi===(t.id==u.sortBy?t.measures:"")&&e.name.split("*")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")||r.every((function(e){return s.includes(e)}))}))}));return-1!==s?[].concat((0,R.Z)(r.slice(0,s+1)),(0,R.Z)(i.map((function(n,r){return(0,a.Z)((0,a.Z)({},n),{},{id:e+r+1})}))),(0,R.Z)(r.slice(s+1))):r}))})).catch((function(e){N(!1),console.log("Error :",e)}))}(e,n,"Leaf"))}};if(r){var b=p[r.id];return(0,C.jsxs)("span",{style:{cursor:"pointer"},value:r.id,onClick:function(){j()},className:"parent",children:[b?(0,C.jsx)(y.NR5,{}):(0,C.jsx)(y.jS6,{})," ",(0,C.jsx)("b",{title:r.full_name+" ("+n.row.original.count+")",children:r.full_name})]})}return(0,C.jsxs)("span",{className:"child",title:""===n.row.original.name?"Summary":n.getValue().split("*")[0],children:[(0,C.jsx)("b",{style:{display:""==n.row.original.name||""==n.getValue().split("*")[0]?"flex":"",justifyContent:""==n.row.original.name||""==n.getValue().split("*")[0]?"center":""},children:""==n.row.original.name||""==n.getValue().split("*")[0]?"Summary":""})," "]})}}},{header:"",accessorKey:"kpi",Cell:function(e){var n=e.cell;return(0,C.jsx)("span",{children:(0,C.jsx)("b",{children:n.getValue()})})}}];D.forEach((function(e,n){if(n>1&&"Total"!==e){var r=new Date("".concat(e.slice(0,4),"-").concat(e.slice(5,7),"-").concat(e.slice(8,10))).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),s=(new Date).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-"),t=new Date(r)>=new Date(s);_.push({header:r,accessorKey:"".concat(e),className:"software",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)("span",{className:t?"greenColumn":"",children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:"$"}):"",(0,C.jsxs)("span",{style:{display:"block",float:"right"},children:[null==r.getValue()?0:null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:"%"}):""]})]})}})}}));var z=_.length,K={header:"Total",accessorKey:"Total",Cell:function(e){var n,r=e.cell;return(0,C.jsxs)(C.Fragment,{children:["Planned Revenue"==r.row.original.kpi||"Actual Revenue"==r.row.original.kpi||"Recognized Revenue"==r.row.original.kpi||"Resource Direct Cost"==r.row.original.kpi||"Other Direct Cost"==r.row.original.kpi||"Gross Margin"==r.row.original.kpi?(0,C.jsx)("span",{style:{display:"block",float:"left"},children:(0,C.jsx)("b",{children:"$"})}):"",(0,C.jsx)("span",{style:{display:"block",float:"right"},className:"total",children:(0,C.jsxs)("b",{children:[null===(n=r.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==r.row.original.kpi||"Billable Utilization"==r.row.original.kpi||"FTE"==r.row.original.kpi&&"hcfte"!=r.row.original.descr||"SUBK"==r.row.original.kpi&&"hcsubk"!=r.row.original.descr||"Billed Utilization"==r.row.original.kpi?(0,C.jsx)("span",{children:null==r.getValue()?0:"%"}):""]})})]})}};return _.splice(z,0,K),(0,C.jsxs)("div",{className:"materialReactExpandableTable headCountTable darkHeader",children:[(0,C.jsx)("div",{className:"mb-2",align:" right ",children:(0,C.jsx)(w.WlY,{size:"1.5em",title:"Export to Excel",style:{color:"green"},cursor:"pointer",onClick:function(){Promise.resolve().then(r.t.bind(r,25415,23)).then((function(e){var n=new e.Workbook,r=n.addWorksheet("Revenue Analysis"),s=[];(s=D).sort((function(e,n){var r=e.split("_"),s=(0,l.Z)(r,3),t=s[1],i=s[2],a=n.split("_"),o=(0,l.Z)(a,3),c=o[1],u=o[2];return t!==c?parseInt(t)-parseInt(c):parseInt(i)-parseInt(u)}));var t=D.concat(F).map((function(e){var n={};return D.forEach((function(r){var s=e[r];if("string"===typeof s){var t=s.split("^&"),i=(0,l.Z)(t,2)[0];n[r]=i}else n[r]="number"===typeof s?s.toLocaleString("en-US"):s})),"name"in n&&""===n.name?n.name="Summary":"name"in n&&""!==n.name&&void 0!==n.name&&(n.name=""==n.name.split("*")[0]?"Summary":n.name.split("*")[0]),"Planned Revenue"===n.kpi||"Actual Revenue"===n.kpi||"Recognized Revenue"===n.kpi||"Resource Direct Cost"===n.kpi||"Other Direct Cost"===n.kpi||"Gross Margin"===n.kpi?Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]="$"+(null==n[e]?"":n[e]))})):"Gross Margin %"!==n.kpi&&"Billable Utilization"!==n.kpi&&"Billed Utilization"!==n.kpi&&"FTE"!==n.kpi&&"SUBK"!==n.kpi||Object.keys(n).forEach((function(e){"name"===e||"kpi"===e||isNaN(n[e])||(n[e]=(null==n[e]?0:n[e])+" %")})),n})),i=function(e){return e.match(/^\d{4}_\d{2}_\d{2}$/)?function(e){var n=e.split("_"),r=(0,l.Z)(n,3),s=r[0],t=r[1],i=(r[2],new Date("".concat(s,"-").concat(t,"-01")).toLocaleString("en-us",{month:"short"}));return"".concat(i,"-").concat(s)}(e):e},a={};Object.keys(t[0]).forEach((function(e){a[e]="name"==i(e)?"Supervisor / Res":"kpi"==i(e)?"":i(e)}));var o=t.filter((function(e){return Object.values(e).some((function(e){return null!==e&&void 0!==e&&""!==e}))}));o.unshift(a);var c=o.map((function(e){var n=[];return s.forEach((function(r){n.push(e[r])})),n}));c.forEach((function(e){r.addRow(e)})),[1].forEach((function(e){r.getRow(e).font={bold:!0}}));for(var u=s.indexOf("name"),d=1,p=c[0][u],m=1;m<c.length;m++){var f=c[m][u];f!==p&&(m-d>0&&r.mergeCells(d+1,u,m,u),d=m,p=f)}c.length-d>0&&r.mergeCells(d+1,u,c.length,u),n.xlsx.writeBuffer().then((function(e){saveAs(new Blob([e]),"Revenue Analysis.xlsx")}))}))}})}),(0,C.jsx)(Z.ZP,{columns:_,data:F,enableExpanding:function(e){return"name"===e.id},enableRowVirtualization:!0,enablePagination:!1,enableGlobalFilter:!0,enableDensityToggle:!1,enableFullScreenToggle:!1,enableHiding:!1,enableColumnFilters:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!1,filterFromLeafRows:!0,initialState:{showGlobalFilter:!0,grouping:["name"],expanded:!0,density:"compact",columnPinning:{right:["Total"]}},muiTableContainerProps:{},muiTableBodyProps:{sx:{"&":{borderRight:"1px solid #ccc",borderBottom:"1px solid #ccc"},"& td":{borderRight:"1px solid #ccc",height:"22px",padding:"0px 5px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",padding:"0 5px"}}}}),k?(0,C.jsx)(T.Z,{handleAbort:function(){x.current&&x.current.abort(),N(!1)}}):""]})},A=r(85401),F=r(78820),L=r(57689),G=r(72920),O=r(22804),_=r(7692),z=r(38262);r(27336);var K=function(){var e,n,r=p.N.baseUrl,u=(0,o.useState)([]),m=(0,l.Z)(u,2),g=m[0],R=m[1],Z=(0,o.useState)(!1),w=(0,l.Z)(Z,2),D=w[0],K=w[1],q=(0,o.useState)(y.UdN),H=(0,l.Z)(q,2),$=H[0],W=H[1],Y=(0,o.useState)(""),J=(0,l.Z)(Y,2),X=J[0],Q=J[1],ee=(0,o.useState)([]),ne=(0,l.Z)(ee,2),re=ne[0],se=ne[1],te=(0,o.useState)([]),ie=(0,l.Z)(te,2),ae=ie[0],le=ie[1],oe=(0,o.useState)([]),ce=(0,l.Z)(oe,2),ue=ce[0],de=ce[1],pe=(0,o.useState)([]),me=(0,l.Z)(pe,2),fe=me[0],ge=me[1],he=(0,o.useState)([]),ve=(0,l.Z)(he,2),xe=ve[0],ye=ve[1],je=(0,o.useState)([]),be=(0,l.Z)(je,2),Re=be[0],Ze=be[1],Te=(0,o.useState)([]),we=(0,l.Z)(Te,2),Ce=we[0],ke=we[1],Ne=(0,o.useState)([]),Ie=(0,l.Z)(Ne,2),Se=Ie[0],Ee=Ie[1],Be=(0,o.useState)([]),Me=(0,l.Z)(Be,2),Ue=Me[0],De=Me[1],Ve=(0,o.useState)([]),Pe=(0,l.Z)(Ve,2),Ae=Pe[0],Fe=Pe[1],Le=(0,o.useState)([]),Ge=(0,l.Z)(Le,2),Oe=Ge[0],_e=Ge[1],ze=(0,o.useState)([]),Ke=(0,l.Z)(ze,2),qe=Ke[0],He=Ke[1],$e=(0,o.useState)([]),We=(0,l.Z)($e,2),Ye=We[0],Je=We[1],Xe=(0,o.useState)([]),Qe=(0,l.Z)(Xe,2),en=Qe[0],nn=Qe[1],rn=(0,o.useState)([]),sn=(0,l.Z)(rn,2),tn=sn[0],an=sn[1],ln=(0,o.useState)([]),on=(0,l.Z)(ln,2),cn=on[0],un=on[1],dn=(0,o.useState)([]),pn=(0,l.Z)(dn,2),mn=pn[0],fn=pn[1],gn=(0,o.useState)([]),hn=(0,l.Z)(gn,2),vn=hn[0],xn=hn[1],yn=(0,o.useState)([]),jn=(0,l.Z)(yn,2),bn=jn[0],Rn=jn[1],Zn=(0,o.useState)([]),Tn=(0,l.Z)(Zn,2),wn=Tn[0],Cn=Tn[1],kn=(0,o.useState)([]),Nn=(0,l.Z)(kn,2),In=Nn[0],Sn=Nn[1],En=(0,o.useState)([]),Bn=(0,l.Z)(En,2),Mn=Bn[0],Un=Bn[1],Dn=(0,o.useState)([]),Vn=(0,l.Z)(Dn,2),Pn=Vn[0],An=Vn[1],Fn=(0,o.useState)([]),Ln=(0,l.Z)(Fn,2),Gn=Ln[0],On=Ln[1],_n=(0,o.useState)("BusinessUnit"),zn=(0,l.Z)(_n,2),Kn=zn[0],qn=zn[1],Hn=(0,o.useState)([]),$n=(0,l.Z)(Hn,2),Wn=$n[0],Yn=$n[1],Jn=(0,o.useState)([]),Xn=(0,l.Z)(Jn,2),Qn=Xn[0],er=Xn[1],nr=(0,o.useState)(!1),rr=(0,l.Z)(nr,2),sr=rr[0],tr=rr[1],ir=(0,o.useState)(!1),ar=(0,l.Z)(ir,2),lr=ar[0],or=ar[1],cr=(0,o.useRef)([]),ur=(0,o.useState)(null),dr=(0,l.Z)(ur,2),pr=dr[0],mr=dr[1],fr=(0,o.useState)([]),gr=(0,l.Z)(fr,2),hr=gr[0],vr=gr[1],xr=(0,o.useState)(!1),yr=(0,l.Z)(xr,2),jr=yr[0],br=yr[1],Rr=(0,o.useRef)(null),Zr=(0,o.useState)(),Tr=(0,l.Z)(Zr,2),wr=Tr[0],Cr=Tr[1],kr=(0,o.useState)([]),Nr=(0,l.Z)(kr,2),Ir=(Nr[0],Nr[1]),Sr=(0,o.useState)(!1),Er=(0,l.Z)(Sr,2),Br=Er[0],Mr=Er[1],Ur=(0,o.useState)(!1),Dr=(0,l.Z)(Ur,2),Vr=Dr[0],Pr=Dr[1],Ar=(0,o.useState)(-1),Fr=(0,l.Z)(Ar,2),Lr=Fr[0],Gr=Fr[1],Or=(0,o.useState)(""),_r=(0,l.Z)(Or,2),zr=_r[0],Kr=_r[1],qr=function(e,n){var r=e.map((function(e){return e.value})),s=n.map((function(e){return e.value}));return r.length===s.length?"<< ALL >>":e.map((function(e){return e.label})).join(", ")},Hr=function(e){e.expanded;return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(y.qL$,{className:"chevronIcon"})})},$r=(0,o.useState)("Select Resource"),Wr=(0,l.Z)($r,2),Yr=Wr[0],Jr=Wr[1],Xr=(0,o.useState)([]),Qr=(0,l.Z)(Xr,2),es=Qr[0],ns=Qr[1];console.log(Kn),console.log(wr),(0,o.useEffect)((function(){d()({method:"get",url:r+"/revenuemetricsms/RevenueMarginAnalysis/getResourceFullName"}).then((function(e){var n=e.data;ns(n)})).catch((function(e){}))}),[Lr]),(0,o.useEffect)((function(){Sn(wn)}),[Kn]),(0,o.useEffect)((function(){d()({method:"get",url:r+"/revenuemetricsms/RevenueMarginAnalysis/getReportees2"}).then((function(e){var n=e.data,r=n.filter((function(e){return null===e.parent_id||n.some((function(n){return n&&"null"!==n&&n.id===e.parent_id}))}));if(-1!==Lr)for(var s=0;s<r.length-1&&r[s].id!=Lr;s++);ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},{resId:Lr})}))})).catch((function(e){}))}),[Lr]),(0,o.useEffect)((function(){d()({method:"get",url:r+"/customersms/Customers/getNewCustomerList"}).then((function(e){var n=e.data;R(n)}))}),[]),(0,o.useEffect)((function(){if(pr&&pr[0]){var e=["name","kpi"].concat(Object.keys(pr[0]).filter((function(e){return e.match(/\d{4}_\d{2}_\d{2}/)}))).sort((function(e,n){if("Total"===e)return 1;if("Total"===n)return-1;var r=new Date(e.replace("_","-")),s=new Date(n.replace("_","-")),t=r.toLocaleString("en-US",{month:"short",year:"numeric"}),i=s.toLocaleString("en-US",{month:"short",year:"numeric"});return t.localeCompare(i)}));e.includes("Total")||e.push("Total"),vr(e)}}),[pr]);var rs=h()(X).startOf("month").format("yyyy-MM-DD"),ss=(0,o.useState)([]),ts=(0,l.Z)(ss,2),is=(ts[0],ts[1]),as=(0,L.TH)(),ls=new URLSearchParams(as.search).get("id"),os=(0,o.useState)(!1),cs=(0,l.Z)(os,2),us=cs[0],ds=cs[1],ps=(0,o.useState)([]),ms=(0,l.Z)(ps,2),fs=ms[0],gs=ms[1],hs=localStorage.getItem("resId"),vs=(Number(hs),(0,o.useState)([])),xs=(0,l.Z)(vs,2),ys=xs[0],js=xs[1];(0,o.useEffect)((function(){bs()}),[]);var bs=function(){d().get(r+"/CommonMS/master/getMenus?loggedUserId=".concat(hs)).then((function(e){var n=e.data.map((function(e){return e.subMenus&&(e.subMenus=e.subMenus.filter((function(e){return"Monthly Revenue Trend"!==e.display_name&&"Revenue & Margin Variance"!==e.display_name&&"Rev. Projections"!==e.display_name&&"Project Timesheet (Deprecated)"!==e.display_name&&"Financial Plan & Review"!==e.display_name}))),e}));Ir(n),n.forEach((function(e){"Revenue Metrics"===e.display_name&&js([e])}));var s=n.find((function(e){return"Revenue Metrics"===e.display_name})).subMenus.find((function(e){return"Revenue & Margin Analysis"===e.display_name}));console.log(s.userRoles),is(s.userRoles);var t=s?s.userRoles.includes("911")?911:s.userRoles.includes("126")?126:s.userRoles.includes("908")?908:s.userRoles.includes("910")?910:s.userRoles.includes("690")&&s.userRoles.includes("641")?600:s.userRoles.includes("690")&&s.userRoles.includes("930")?500:s.userRoles.includes("641")&&s.userRoles.includes("930")?400:s.userRoles.includes("641")?641:690==s.userRoles&&641==s.userRoles?620:s.userRoles.includes("690")?690:s.userRoles.includes("930")&&930:null;console.log(t,"----------------------&&&&&&7"),Cr(t),641!=t&&690!=t&&930!=t||(qn("customer"),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},{type:"customer"})}))),690==t?d().get(r+"/ProjectMS/project/getProjectsbyDp?loggedUserId=".concat(Number(hs)+1)).then((function(e){var n=e.data;Yn(n)})):500==t?d().get(r+"/ProjectMS/project/getProjectsdpae?loggedUserId=".concat(Number(hs)+1)).then((function(e){var n=e.data;n.push({id:"-1",name:"<<ALL>>"}),Yn(n)})):400==t?d().get(r+"/ProjectMS/project/getProjectscslae?loggedUserId=".concat(Number(hs)+1)).then((function(e){var n=e.data;n.push({id:"-1",name:"<<ALL>>"}),Yn(n)})):600==t?d().get(r+"/ProjectMS/project/getProjectsbyCslDp?loggedUserId=".concat(Number(hs)+1)).then((function(e){var n=e.data;Yn(n)})):641==t?d().get(r+"/ProjectMS/project/getProjectsbycsl?loggedUserId=".concat(Number(hs)+1)).then((function(e){var n=e.data;Yn(n)})):930==t?d().get(r+"/ProjectMS/project/getProjectsbyAE?loggedUserId=".concat(Number(hs)+1)).then((function(e){var n=e.data;Yn(n)})):d().get(r+"/ProjectMS/Audit/getProjectNameandId").then((function(e){var n=e.data;Yn(n)}))}))};(0,o.useEffect)((function(){d()({method:"get",url:r+"/dashboardsms/savedsearch/FiltersData?saved_search_id=".concat(null===ls?0:ls)}).then((function(e){var n=e.data;gs(n)}))}),[ls]);var Rs=(0,o.useState)({}),Zs=(0,l.Z)(Rs,2),Ts=Zs[0],ws=Zs[1];(0,o.useEffect)((function(){ws((function(){return null!=ls?{ownerDivisions:fs.ownerDivisions,month:fs.month,duration:fs.duration,countries:fs.countries,searchType:fs.searchType,busUnits:fs.busUnits,customers:fs.customers,srcType:fs.srcType,srcTypeId:fs.srcTypeId,tarType:fs.tarType,busUnitId:fs.busUnitId,custId:fs.custId,prjId:fs.prjId,resId:fs.resId,measures:fs.measures,salesExecId:fs.salesExecId,salesExecs:fs.salesExecs,sortBy:fs.sortBy,custCountries:fs.custCountries,resTyp:fs.resTyp,source:fs.source,engCountries:fs.engCountries,contTerms:fs.contTerms,engComp:fs.engComp,cslRes:641==wr||690==wr?Number(hs)+1:fs.cslRes,cslResId:fs.cslResId,dpRes:641==wr||690==wr?Number(hs)+1:fs.dpRes,dpResId:fs.dpResId,indTypes:fs.indTypes,indTypesId:fs.indTypesId,activeCustomers:fs.activeCustomers}:{ownerDivisions:-1,month:"",duration:"",countries:"6,5,3,8,7,1,2",searchType:"BusinessUnit",busUnits:"170,211,123,82,168,207,212,18,213,49,149,208,243",customers:-1,srcType:-1,srcTypeId:-1,tarType:"BusinessUnit",busUnitId:-1,custId:-1,prjId:-1,resId:-1,measures:"1350,638,965,639,640,641,643,644,872,761",salesExecId:-1,salesExecs:"88932313,3575,139,2119653,191,225,235,257,2119671,57997421,513,523,557,3617428,667,84740633,116105998,55762631,683,82291354,81525,2119701,76287764,2119725,57559815,2639264,81537,24662818,63011834,2119739,2811358,847,2119741,1550816,875,881,905,101477977,57482208,981,57997419,2119775,4849403,2573864,20493348,116106000,2119787,57482210,2119795,68629761,111001131,1165,2639222,1175,130391575,88998194,3414273,1375,1381,56148348,2119837,2119851,81587,1529,4452487,1459,97925857,1461,18910037,2119859,2640070,36786373,1513,2119655,43972990,1635,81601,14398829,69158161,793,1675,2639520,70301986,1717,124117738,1785,97320362,114598022,2167,3007509,112875979,2183,81657,2203,2227,120015604,2119945,47112354,46642168,2257,81659,2119951,2249,4872942,111410,2263,11651218,2119961,2607,2599,2119975,85338848,2725,30134361,2737,112208586,2596928,96657988,3129,658084,4452476,846041,3495,2120031,3617,2120057,1495,2120061,2120063,59144453,2120069,21505179,111399803,3737,3887,3977,2120091,2120095,4065,25313227,81825,111450,112875977,31161422,4095,81871,4721,2120135,2120139,37215300,4729,49413793,2120157,123454586,4937,2120161,2120163,117718248,1753925,30549612,2120177,2120181,117449123,5265,114159851,999999",sortBy:-1,custCountries:-1,resTyp:-1,source:-1,engCountries:-1,contTerms:-1,engComp:-1,cslRes:641==wr||690==wr?Number(hs)+1:-1,cslResId:-1,dpRes:641==wr||690==wr?Number(hs)+1:"189,225,257,871,881,106873978,1115,1165,91335222,1375,81587,131110804,38380211,81651,3129,3217,846041,3887,3905,81825,4455,112875977,1561,49413793,123454586,4935,4937,5201,5211,5269,114159851,50270737,72292702",dpResId:-1,indTypes:-1,indTypesId:-1,activeCustomers:"85945152,128283684,72156417,71427353,1551283,123894900,112042055,63975211,1551287,94389335,93991408,1551417,1551294,1551300,134633482,94455983,29063316,94455985,64386786,1842050,1551317,30526094,1551320,110592851,25264701,1551323,16847713,94455987,129937850,58684283,76951255,80753999,112914302,54142249,1552214,1992078,1551346,72694747,1989656,132397598,109428419,117147205,94455988,1552593,36504344,37091493,1551362,1551374,1551376,26087285,116648754,3819459,94854626,1551361,1551380,1551382,104869180,10470456,114461301,97387326,2620532,1891336,1551399,1551909,94854623,62940562,24192899,85945154,94854624,1551980,1551910,128598943,6031468,79877870,13632704,1551916,4293374,128467119,94389332,93991409,94389336,1551929,1551981,112008718,119243358,96591348,59706234,82291358,1551943,1551944,2853559,1551948,1551521,77018196,1551952,1551953,1551955,37091494,63162799,125931702,1551970,63266772,1552007,1552701,1552010,1552011,76951258,94854628,137793502,137793504,94854630,112674610,1551707,76751383,60912954,130225404,1989657,112875982,1552027,1552737,10219672,55697033,63633008,63633007,59821116,51067835,92393453,111974038,44011093,118769156,67834295,132397596,132066225,4511021,8458720,3667922,127640293,84210849,96188256,137399513,111034788,1552049,1552048,23961964,1552052,94788398,1552769,1552097,1552059,1552062,94389337,92859923,18553399,55076417,1552068,90339052,85615658,1552077,61340693,36635688,1552083,1552086,5527406,97121507,85546349,133185522,94720315,1552111,1551863,129404696,2540692,15081811,26143593,13177220,82291362,117718253,2077503,70897083,2082139,94455984,1552145,1552132,137793503,3886568,1551986,97387332,104203600,1552149,1552150,1552161,94720314,2668746,1551965,2838049,2042271,85945151,3284412,11370414,55154318,76154829,97387329,2065901,128226785,2012374,125322705,43624395,3120332,63162798,67129169,41019114,1551753,76951256,95324519,1551956,1552187,1551877,29304173,1552226,1552189,26242008,94455982,94921283,76751379,1552198,9093339,1552200,64386785,3667921,38904085,2540690,124097971,94854629,119173217,21664192,1552217,1552222,58441017,29246005,94389338,85007141,1842057,36244913,76420367,4511022,96055886,1552238,1552240,1552252,39969636,3138503,64955428,76751371,75093305,13632703,7007429,1552261,1551996,112674609,1552268,1956839,97387333,52636336,42255432,120584753,1552276,139446567,137267788,1552521,41317099,69963531,1552292,1552023,1989658,1956840,1552286,1552293,94854625,106471491,1552294,1552304,1552849,96188257,97926363,1552295,5296323,1551648,1552309,94455981,72223410,80080786,24275141,98815571,27730999,99484320,2853561,1552344,1552345,94455989,117682329,59291323,1552363,4511023,94389333,3039808,2612049,1552359,3138502,1552369,2853562,1980150,132397594,94854627,97653997,5527408,98214365,128264227,58638638,90138245,90138244,90138246,90138243,90138241,97386610,95257587,128997124,128333765,1552394,1552395,80080781,90339053,60478567,1552400,1552375,69291961,1552402,27731000,92659540,51469532,29433193,80685749,1552409,106003070,5527409,114529861,2540691,130225403,128699085,44814300,70963563,1760934,43889231,1552418,94920541,97121510,37091495,80685750,57794189,87139275,2308411,52512736,1552430,111602229,61261568,137399515,41019113,94389334,76951261,124522210,1552448,11370415,5168356,139446353,41317098,3280593,52300271,121428211,124386451,97387328,98815570,1552454,1552464,1552468,99417583,52032507,1552484,1552486,1552487,1552489,1552490,1552313,1551938,64155,1552043,1552119,112275293,5550270,66398294,3270030,85945149,137399512,97387327,56952600,1552475,132066226,4950222,130723112,97387330,97320365,1552507,85945150,2620533,105467422,119409379,88932319,97387331,62719516,129153485,60912956,123522147,67530124,112275294,4725319,76751380,65232987,97121508,1552531,1552533,1552539,1552540,38519994,1552541,14791169,91467597,1552545,2612051,1552573,130723113,137399514,122385399,76951259,1552564,2623413,102536503"}}))}),[fs,ls]),(0,o.useEffect)((function(){if(null!=ls){var e,n,r,s=re.filter((function(e){var n;return null===(n=fs.busUnits)||void 0===n?void 0:n.includes(e.value)})),t=xe.filter((function(e){var n;return null===(n=fs.countries)||void 0===n?void 0:n.includes(e.value)})),i=qe.filter((function(e){var n;return null===(n=Ts.contTerms)||void 0===n?void 0:n.includes(e.value)})),a=vn.filter((function(e){var n;return null===(n=Ts.engComp)||void 0===n?void 0:n.includes(e.value)})),l=Ae.filter((function(e){var n;return null===(n=fs.measures)||void 0===n?void 0:n.includes(e.value)})),o=Re.filter((function(e){var n;return null===(n=Ts.custCountries)||void 0===n?void 0:n.includes(e.value)})),c=Re.filter((function(e){var n;return null===(n=Ts.engCountries)||void 0===n?void 0:n.includes(e.value)})),u=null===fs||void 0===fs?void 0:fs.searchType;console.log(u);var d=null===Wn||void 0===Wn?void 0:Wn.filter((function(e){var n;return null===(n=Ts.prjId)||void 0===n?void 0:n.includes(e.id)})),p=null===(e=JSON.stringify(null===(n=d[0])||void 0===n?void 0:n.name))||void 0===e?void 0:e.replace(/"/g,""),m=null===en||void 0===en?void 0:en.filter((function(e){var n;return null===(n=Ts.salesExecs)||void 0===n?void 0:n.includes(e.value)})),f=fs.ownerDivisions,g=f?f.split(",").map(Number):[],h=cn.filter((function(e){var n;return null===(n=fs.ownerDivisions)||void 0===n?void 0:n.includes(e.value)})).filter((function(e){return g.includes(e.value)})),x=wn.filter((function(e){var n;return null===(n=Ts.cslRes)||void 0===n?void 0:n.includes(e.value)})),y=Mn.filter((function(e){var n;return null===(n=Ts.dpRes)||void 0===n?void 0:n.includes(e.value)})),j=ue.filter((function(e){var n;return null===(n=fs.indTypes)||void 0===n?void 0:n.includes(e.value)})),b=null===(r=es.filter((function(e){var n;return null===(n=fs.resId)||void 0===n?void 0:n.includes(e.id)})).filter((function(e){return e.id===+Ts.resId}))[0])||void 0===r?void 0:r.full_name;if(Jr(b),void 0!==(null===Ts||void 0===Ts?void 0:Ts.month)&&""!==(null===Ts||void 0===Ts?void 0:Ts.month)){var R=null===Ts||void 0===Ts?void 0:Ts.month;Q((0,v.default)(R))}ge(j),An(y),Sn(x),fn(h),an(m),De(c),Ee(o),le(s),ke(t),"-1"===Ts.contTerms?Je(qe):Je(i),"-1"===Ts.engComp?Rn(vn):Rn(a),_e(l),qn(u),Kr(p)}}),[ls,Ts.measures,Ae,parseInt(fs.duration),re,Kn,Re,Wn,Ts.prjId,vn,en,Ts.countries,null===Ts||void 0===Ts?void 0:Ts.source,null===Ts||void 0===Ts?void 0:Ts.month,Ts.contTerms,xe,null===fs||void 0===fs?void 0:fs.searchType,Ts.busUnits,fs.countries,fs.busUnits,fs.measures,fs.resId,fs.ownerDivisions,fs.indTypes,null===Ts||void 0===Ts?void 0:Ts.duration]),(0,o.useEffect)((function(){ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},{duration:""})})),null!=ls&&setTimeout((function(){Vs()}),4e3)}),[Ts.month]);var Cs=function(e){var n=e.target,r=n.name,s=n.value;"searchType"==r&&(or(!1),qn(s)),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},r,s))}))},ks=(0,o.useState)([{}]),Ns=(0,l.Z)(ks,2),Is=Ns[0],Ss=Ns[1],Es=null===Is||void 0===Is?void 0:Is.map((function(e){return null===e||void 0===e?void 0:e.id})).toString();(0,o.useEffect)((function(){}),[Es],[Ts.searchType]);var Bs=null===(e=JSON.parse(localStorage.getItem("selectedCust")))||void 0===e||null===(n=e.map((function(e){return e.id})))||void 0===n?void 0:n.toString(),Ms=function(e){var n=e.target,r=(n.id,n.name),s=n.value;"customers"==r&&"select"===s&&Pr(!0),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},r,s))}))},Us=function(e,n){var r=n.map((function(e){return e.label})),s=e.filter((function(e){return r.includes(e.label)})),t=s[s.length-1];return t?t.label:""}(Ae,Oe),Ds=function(e,n){var r=n.map((function(e){return e.label}));if(r.includes("Planned Revenue"))return"Planned Revenue";var s=e.filter((function(e){return r.includes(e.label)}))[0];return s?s.label:""}(Ae,Oe),Vs=function(e){var n=cr.current.filter((function(e){return null!=e}));cr.current=n;var s=(0,b.Z)(cr);if(s){tr(!0),"Resource"===Kn&&"Select Resource"===Yr&&(t=document.querySelector(".poBtn"))&&(t.style.color="red")}else{var t;if("Resource"===Kn&&"Select Resource"===Yr)return tr(!0),void((t=document.querySelector(".poBtn"))&&(t.style.color="red"));"Resource"===Kn&&"Select Resource"!==Yr&&(tr(!1),(t=document.querySelector(".poBtn"))&&(t.style.color="#187fde")),tr(!1),or(!1);var i=setTimeout((function(){br(!0)}),2e3);Rr.current=new AbortController,d()({method:"post",url:r+("CustIndustry"==Kn?"/revenuemetricsms/RevenueMarginAnalysis/GetGMACustIndustryFinancialsFinalData":"DP"==Kn?"/revenuemetricsms/RevenueMarginAnalysis/GetGMADPFinancialsFinalData":"CSL"==Kn?"/revenuemetricsms/RevenueMarginAnalysis/GetGMACSLFinancialsFinalData":"Sales Executive"==Kn?"/revenuemetricsms/RevenueMarginAnalysis/GetGMASalesExecutiveFinancialsFinalData":"Customer"==Kn||"Project"==Kn||"Resource"==Kn?"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData":"BusinessUnit"!=Kn||-1==Ts.engComp&&-1==Ts.contTerms?"/revenuemetricsms/RevenueMarginAnalysis/getFinancialsBUSummarytFinalData":"/revenuemetricsms/RevenueMarginAnalysis/getFinancialsBUSummaryByCTFinalData"),data:{ownerDivisions:"Sales Executive"==Kn?Ts.ownerDivisions:-1,month:""===Ts.month||"Invalid date"===Ts.month?rs:Ts.month,duration:null!==ls?fs.duration:Ts.duration,countries:Ts.countries,searchType:Ts.searchType,busUnits:"BusinessUnit"==Kn||"Customer"==Kn?Ts.busUnits:-1,customers:"select"==Ts.customers?Bs:0==Ts.customers?Ts.activeCustomers:Ts.customers,srcType:Ts.srcType,srcTypeId:Ts.srcTypeId,tarType:Ts.searchType,busUnitId:Ts.busUnitId,custId:Ts.custId,prjId:"Project"!=Kn?-1:Ts.prjId,resId:"Resource"!=Kn?-1:Ts.resId,measures:Ts.measures,salesExecId:Ts.salesExecId,salesExecs:"Sales Executive"!=Kn?-1:Ts.salesExecs,sortBy:Ts.sortBy,custCountries:Ts.custCountries,source:Ts.source,resTyp:Ts.resTyp,engCountries:Ts.engCountries,contTerms:Ts.contTerms,engComp:Ts.engComp,cslRes:641==wr||690==wr||600==wr?Number(hs)+1:Ts.cslRes,cslResId:Ts.cslResId,dpRes:641==wr||690==wr||600==wr?Number(hs)+1:"DP"!=Kn?-1:Ts.dpRes,dpResId:Ts.dpResId,indTypes:"CustIndustry"!=Kn?-1:null===Ts||void 0===Ts?void 0:Ts.indTypes,indTypesId:null===Ts||void 0===Ts?void 0:Ts.indTypesId},signal:Rr.current.signal}).then((function(e){var n=e.data;br(!1),clearTimeout(i),mr(n.data),or(!0),!s&&K(!D),W(D?y.UdN:y.NR5)})).catch((function(e){br(!1),clearTimeout(i)}))}},Ps=function(){var e=(0,t.Z)((0,s.Z)().mark((function e(){var n,t,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d()({url:r+"/CostMS/cost/getDepartments"});case 2:n=e.sent,t=(t=n.data).filter((function(e){return e.value>=0})),se(t),null==ls&&le(t.filter((function(e){return e.value>=0}))),l=[],t.forEach((function(e){l.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"busUnits",l.toString()))}));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),As=function(){var e=(0,t.Z)((0,s.Z)().mark((function e(){var n,t,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d()({url:r+"/revenuemetricsms/RevenueMarginAnalysis/getCustomerIndustry"});case 2:n=e.sent,t=(t=n.data).filter((function(e){return e.value>=0})),de(t),null==ls&&ge(t.filter((function(e){return e.value>=0}))),l=[],t.forEach((function(e){l.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"indTypes",l.toString()))}));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){var e=[];xe.forEach((function(n){e.push(n.value)})),ws((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},"countries",e.toString()))}))}),[xe]);var Fs=function(){var e=(0,t.Z)((0,s.Z)().mark((function e(){var n,t,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d()({url:r+"/revenuemetricsms/RevenueMarginAnalysis/getMeasures"});case 2:n=e.sent,t=[],(l=n.data).length>0&&l.forEach((function(e){var n={label:e.measures,value:e.id};t.push(n),Fe(t),null==ls&&_e(t.filter((function(e){return 0!=e.value})));var r=[];t.forEach((function(e){0!=e.value&&r.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"measures",r.toString()))}))}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ls=function(){var e=(0,t.Z)((0,s.Z)().mark((function e(){var n,t,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d()({url:r+"/revenuemetricsms/headCountAndTrend/getContractTerms"});case 2:n=e.sent,t=[],(l=n.data).length>0&&l.forEach((function(e){var n={label:e.label,value:e.value};t.push(n),He(t),null==ls&&Je(t.filter((function(e){return 0!=e.value})));var r=[];t.forEach((function(e){0!=e.value&&r.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"contractTerm",r.toString()))}))}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Gs=function(){var e=(0,t.Z)((0,s.Z)().mark((function e(){var n,t,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d()({url:r+"/revenuemetricsms/headCountAndTrend/getEngCompany"});case 2:n=e.sent,t=[],(l=n.data).length>0&&l.forEach((function(e){var n={label:e.label,value:e.value};t.push(n);var r=t.filter((function(e){return![0,10,11,12,13].includes(e.value)}));xn(r),null==ls&&Rn(r);var s=[];t.forEach((function(e){0!=e.value&&s.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"engCompany",s.toString()))}))}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){}),[wr]),(0,o.useEffect)((function(){}),[wr]);var Os=function(){var e=(0,t.Z)((0,s.Z)().mark((function e(){var n,t,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d()({url:r+"/revenuemetricsms/RevenueMarginAnalysis/getEngSalesExecutiveList"});case 2:n=e.sent,t=n.data,(l=[]).push({value:999999,label:"Unassigned"}),t.length>0&&t.forEach((function(e){var n={label:e.salesPersonName,value:e.id};l.push(n);var r=l.sort((function(e,n){var r=e.label.toUpperCase(),s=n.label.toUpperCase();return r<s?-1:r>s?1:0}));nn(r),null==ls&&an(r.filter((function(e){return e.value>=0})));var s=[];r.forEach((function(e){0!=e.value&&s.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"SalesExe",s.toString()))}))}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_s=function(){var e=(0,t.Z)((0,s.Z)().mark((function e(){var n,t,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d()({url:r+"/revenuemetricsms/RevenueMarginAnalysis/getSFOwnerDivisions"});case 2:n=e.sent,t=[],(l=n.data).length>0&&l.forEach((function(e){var n={label:e.owner_division,value:e.id};t.push(n),un(t),null==ls&&fn(t.filter((function(e){return 0!=e.value})));var r=[];t.forEach((function(e){0!=e.value&&r.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"OwnerDivision",r.toString()))}))}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),zs=function(){var e=(0,t.Z)((0,s.Z)().mark((function e(){var n,t,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d().get(r+"/revenuemetricsms/RevenueMarginAnalysis/getCustomerCSLList");case 2:n=e.sent,t=[],(l=n.data).length>0&&l.forEach((function(e){var n={label:e.PersonName,value:e.id};t.push(n),Cn(t),null==ls&&Sn(t.filter((function(e){return 0!=e.value})));var r=[];t.forEach((function(e){0!=e.value&&r.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"CslList",r.toString()))}))}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ks=function(){console.log(wr),d().get(r+"/administrationms/subkconversiontrend/getdeliverypartner").then((function(e){var n=[],r=e.data;r.length>0&&r.forEach((function(e){var r={label:e.PersonName,value:e.id};n.push(r),Un(n),null==ls&&An(n.filter((function(e){return 0!=e.value})));var s=[];n.forEach((function(e){0!=e.value&&s.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"DpList",s.toString()))}))}))}))};return(0,o.useEffect)((function(){641!=wr&&690!=wr&&930!=wr&&600!=wr||(zs(),Ks())}),[wr]),(0,o.useEffect)((function(){Ks(),zs(),_s(),Os(),Ps(),d().get(r+"/CostMS/cost/getCountries").then((function(e){var n=[],r=e.data;r.length>0&&r.forEach((function(e){if(e&&4!==e.id){var r={label:e.country_name,value:e.id};n.push(r)}}));var s=n.sort((function(e,n){var r=e.label.toUpperCase(),s=n.label.toUpperCase();return r<s?-1:r>s?1:0})),t=n.concat({label:"Others",value:999});ye(s),Ze(t),null==ls&&(ke(n),Ee(t),De(t))})),Fs(),d()({method:"get",url:r+"/revenuemetricsms/RevenueMarginAnalysis/getMeasures"}).then((function(e){var n=e.data;On(n)})).catch((function(e){})),Ls(),Gs(),d()({method:"get",url:r+"/revenuemetricsms/RevenueMarginAnalysis/getResources"}).then((function(e){var n=e.data;er(n)})),As()}),[]),(0,C.jsxs)("div",{children:[sr?(0,C.jsxs)("div",{className:"statusMsg error",children:[" ",(0,C.jsx)(F.CSE,{})," Please select valid values for highlighted fields"]}):"",(0,C.jsxs)("div",{className:"pageTitle",children:[(0,C.jsx)("div",{className:"childOne"}),(0,C.jsx)("div",{className:"childTwo",children:(0,C.jsx)("h2",{children:"Revenue & Margin Analysis"})}),(0,C.jsx)("div",{className:"childThree"})]}),us?(0,C.jsx)("div",{className:"statusMsg success",children:(0,C.jsxs)("span",{className:"errMsg",children:[(0,C.jsx)(_.hXj,{size:"1.4em"})," \xa0 Search created successfully."]})}):"",(0,C.jsx)(z.Z,{routes:ys,currentScreenName:["Revenue & Margin Analysis"]}),(0,C.jsxs)("div",{className:"group mb-3 customCard",children:[(0,C.jsxs)("div",{className:"col-md-12 collapseHeader",children:[(0,C.jsx)("h2",{children:"Search Filters"}),(0,C.jsx)("div",{className:"helpBtn",children:(0,C.jsx)(G.Z,{pdfname:"MarginAnalysis.pdf",name:"Revenue Analysis Help"})}),(0,C.jsx)("div",{className:"saveBtn",children:(0,C.jsx)(O.Z,{setEditAddmsg:ds,pageurl:"http://10.11.12.149:3000/#/pmo/financials",page_Name:"Gross Margin Analysis",payload:Ts})}),"\xa0",(0,C.jsx)("div",{onClick:function(){K(!D),W(D?y.UdN:y.NR5)},children:(0,C.jsx)("span",{children:$})})]}),(0,C.jsx)(U.V9,{visible:!D,children:(0,C.jsxs)("div",{className:"group-content row",children:[(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Month",children:["Start Month"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 datepicker",ref:function(e){cr.current[0]=e},children:(0,C.jsx)(f(),{selected:X,id:"month",onChange:function(e){Q(e),ws((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},"month",h()(e).startOf("month").format("yyyy-MM-DD")))}))},onKeyDown:function(e){e.preventDefault()},dateFormat:"MMM-yyyy",showMonthYearPicker:!0,placeholderText:"Start Month"})})]})}),(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"duration",children:["Duration",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6",children:(0,C.jsxs)("select",{id:"duration",name:"duration",className:"text",onChange:Cs,ref:function(e){cr.current[1]=e},value:null!==ls?fs.duration:Ts.duration,children:[(0,C.jsx)("option",{value:"",children:"<<Please Select>>"}),(0,C.jsx)("option",{value:1,children:"1"}),(0,C.jsx)("option",{value:2,children:"2"}),(0,C.jsx)("option",{value:3,children:"3"}),(0,C.jsx)("option",{value:4,children:"4"}),(0,C.jsx)("option",{value:5,children:"5"}),(0,C.jsx)("option",{value:6,children:"6"}),(0,C.jsx)("option",{value:7,children:"7"}),(0,C.jsx)("option",{value:8,children:"8"}),(0,C.jsx)("option",{value:9,children:"9"}),(0,C.jsx)("option",{value:10,children:"10"}),(0,C.jsx)("option",{value:11,children:"11"}),(0,C.jsx)("option",{value:12,children:"12"})]})})]})}),(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Seacrh Type",children:["Search Type",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6",children:911==wr||931==wr||908==wr||126==wr?(0,C.jsxs)("select",{id:"searchType",onChange:Cs,name:"searchType",className:"text",ref:function(e){cr.current[2]=e},value:Ts.searchType,children:[(0,C.jsx)("option",{value:"",children:"<<Please Select>>"}),(0,C.jsx)("option",{value:"BusinessUnit",children:"Business Unit"}),(0,C.jsx)("option",{value:"Customer",children:"Customer"}),(0,C.jsx)("option",{value:"Project",children:"Project"}),(0,C.jsx)("option",{value:"Resource",children:"Resource"}),(0,C.jsx)("option",{value:"Sales Executive",children:"Sales Executive"}),(0,C.jsx)("option",{value:"CSL",children:"CSL"}),(0,C.jsx)("option",{value:"DP",children:"Delivery Partner"}),(0,C.jsx)("option",{value:"CustIndustry",children:"Customer Industry"})]}):641==wr?(0,C.jsxs)("select",{id:"searchType",onChange:Cs,name:"searchType",className:"text",ref:function(e){cr.current[2]=e},value:Ts.searchType,children:[(0,C.jsx)("option",{value:"",children:"<<Please Select>>"}),(0,C.jsx)("option",{value:"Customer",children:"Customer"}),(0,C.jsx)("option",{value:"Project",children:"Project"}),(0,C.jsx)("option",{value:"CSL",children:"CSL"})]}):690==wr?(0,C.jsxs)("select",{id:"searchType",onChange:Cs,name:"searchType",className:"text",ref:function(e){cr.current[2]=e},value:Ts.searchType,children:[(0,C.jsx)("option",{value:"",children:"<<Please Select>>"}),(0,C.jsx)("option",{value:"Customer",children:"Customer"}),(0,C.jsx)("option",{value:"Project",children:"Project"}),(0,C.jsx)("option",{value:"DP",children:"Delivery Partner"})]}):930==wr?(0,C.jsxs)("select",{id:"searchType",onChange:Cs,name:"searchType",className:"text",ref:function(e){cr.current[2]=e},value:Ts.searchType,children:[(0,C.jsx)("option",{value:"",children:"<<Please Select>>"}),(0,C.jsx)("option",{value:"Customer",children:"Customer"}),(0,C.jsx)("option",{value:"Project",children:"Project"}),(0,C.jsx)("option",{value:"Sales Executive",children:"Sales Executive"})]}):(0,C.jsxs)("select",{id:"searchType",onChange:Cs,name:"searchType",className:"text",ref:function(e){cr.current[2]=e},value:Ts.searchType,children:[(0,C.jsx)("option",{value:"",children:"<<Please Select>>"}),(0,C.jsx)("option",{value:"BusinessUnit",children:"Business Unit"}),(0,C.jsx)("option",{value:"Customer",children:"Customer"}),(0,C.jsx)("option",{value:"Project",children:"Project"}),(0,C.jsx)("option",{value:"Resource",children:"Resource"}),(0,C.jsx)("option",{value:"Sales Executive",children:"Sales Executive"}),(0,C.jsx)("option",{value:"CSL",children:"CSL"}),(0,C.jsx)("option",{value:"DP",children:"Delivery Partner"}),(0,C.jsx)("option",{value:"CustIndustry",children:"Customer Industry"})]})})]})}),(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsx)("div",{className:"form-group row"})}),"CSL"==Kn?(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"CSL",children:["CSL"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 multiselect",ref:function(e){cr.current[3]=e},children:(0,C.jsx)(c.NU,{ArrowRenderer:Hr,id:"cslRes",options:wn,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:In,disabled:!1,onChange:function(e){Sn(e);var n=[];e.forEach((function(e){n.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"cslRes",n.toString()))}))},valueRenderer:qr})})]})}):"","DP"==Kn?(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"DP",children:["Delivery Partner"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 multiselect",ref:function(e){cr.current[3]=e},children:(0,C.jsx)(c.NU,{ArrowRenderer:Hr,id:"dpRes",options:Mn,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:Pn,disabled:!1,onChange:function(e){An(e);var n=[];e.forEach((function(e){n.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"dpRes",n.toString()))}))},valueRenderer:qr})})]})}):"","Sales Executive"==Kn?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Sales Executive",children:["Sales Executive"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 multiselect",ref:function(e){cr.current[3]=e},children:(0,C.jsx)(c.NU,{ArrowRenderer:Hr,id:"salesExecs",options:en.sort((function(e,n){return e.label.localeCompare(n.label)})),hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:tn,disabled:!1,onChange:function(e){an(e);var n=[];e.forEach((function(e){n.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"salesExecs",n.toString()))}))},valueRenderer:qr})})]})}),(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Owner Division",children:["Owner Division"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 multiselect",ref:function(e){cr.current[4]=e},children:(0,C.jsx)(c.NU,{ArrowRenderer:Hr,id:"ownerDivisions",options:cn,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:mn,disabled:!1,onChange:function(e){fn(e);var n=[];e.forEach((function(e){n.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"ownerDivisions",n.toString()))}))},valueRenderer:qr})})]})})]}):"",911==wr&&"Customer"!=Kn&&"Project"!=Kn&&"Resource"!=Kn&&"Sales Executive"!=Kn&&"CustIndustry"!=Kn||908==wr&&"Customer"!=Kn&&"Project"!=Kn&&"Resource"!=Kn&&"Sales Executive"!=Kn&&"CustIndustry"!=Kn||910==wr&&"Customer"!=Kn&&"Project"!=Kn&&"Resource"!=Kn&&"Sales Executive"!=Kn&&"CustIndustry"!=Kn||126==wr&&"Customer"!=Kn&&"Project"!=Kn&&"Resource"!=Kn&&"Sales Executive"!=Kn&&"CustIndustry"!=Kn?(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Business Unit",children:["Business Unit"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 multiselect",ref:function(e){cr.current[3]=e},children:(0,C.jsx)(c.NU,{ArrowRenderer:Hr,id:"busUnits",options:re,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:ae,disabled:!1,onChange:function(e){le(e);var n=[];e.forEach((function(e){n.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"busUnits",n.toString()))}))},valueRenderer:qr})})]})}):"","Project"==Kn?(0,C.jsx)("div",{className:"col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"email-input",children:["Project\xa0",(0,C.jsx)("span",{className:"error-text ml-1",children:"*"})]}),(0,C.jsx)("span",{className:"col-1 p-0",children:":"}),(0,C.jsx)("div",{className:"col-6",children:(0,C.jsx)("div",{className:"autoComplete-container react  reactsearchautocomplete",ref:function(e){cr.current[3]=e},children:(0,C.jsx)(x.ReactSearchAutocomplete,{items:Wn,inputSearchString:zr,type:"Text",name:"prjId",id:"prjId",className:"error AutoComplete",onSelect:function(e){ws((function(n){return(0,a.Z)((0,a.Z)({},n),{},{prjId:e.id})}))},showIcon:!1,placeholder:"Type minimum 3 characters"})})})]})}):"Resource"==Kn?(0,C.jsx)("div",{className:"col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsx)("label",{className:"col-5",children:"Resource"}),(0,C.jsx)("div",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6",name:"Resource",style:{cursor:"pointer"},children:(0,C.jsxs)("span",{className:"Resource poBtn",onClick:function(){return Mr(!0)},style:{cursor:"pointer",display:"flow-root",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},title:Yr,children:[(0,C.jsx)(j.VcF,{}),Yr]})})]})}):"","Customer"==Kn?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Customer",children:["Customer"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6",children:690==wr||641==wr||930==wr||600==wr||500==wr||400==wr?(0,C.jsxs)("select",{id:"customers",name:"customers",onChange:Ms,value:Ts.customers,children:[Is.length+"selected",(0,C.jsxs)("option",{value:"",children:[" ","<<Please Select>>"]}),(0,C.jsx)("option",{value:"select",children:"Select"})]}):(0,C.jsxs)("select",{id:"customers",name:"customers",onChange:Ms,value:Ts.customers,children:[Is.length+"selected",(0,C.jsx)("option",{value:-1,children:" <<All>>"}),(0,C.jsx)("option",{value:0,selected:!0,children:"Active Customers"}),(0,C.jsx)("option",{value:"select",children:"Select"})]})})]})}),(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Cust.Location",children:["Cust.Location"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 multiselect",ref:function(e){cr.current["Customer"==Kn?4:""]=e},children:(0,C.jsx)(c.NU,{ArrowRenderer:Hr,id:"custCountries",name:"custCountries",options:Re,hasSelectAll:!0,value:Se,disabled:!1,onChange:function(e){Ee(e);var n=[];e.forEach((function(e){n.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"custCountries",n.toString()))}))},valueRenderer:qr})})]})}),(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Eng.Location",children:["Eng.Location"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 multiselect",ref:function(e){cr.current["Customer"==Kn?5:""]=e},children:(0,C.jsx)(c.NU,{ArrowRenderer:Hr,id:"engCountries",name:"engCountries",options:Re,hasSelectAll:!0,value:Ue,disabled:!1,onChange:function(e){De(e);var n=[];e.forEach((function(e){n.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"engCountries",n.toString()))}))},valueRenderer:qr})})]})})]}):"","CustIndustry"==Kn?(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Customer Industry",children:["Customer Industry"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 multiselect",ref:function(e){cr.current[3]=e},children:(0,C.jsx)(c.NU,{ArrowRenderer:Hr,id:"indTypes",options:ue,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:fe,disabled:!1,onChange:function(e){ge(e);var n=[];e.forEach((function(e){n.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"indTypes",n.toString()))}))},valueRenderer:qr})})]})}):"",(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"resTyp",children:["Res.Type",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6",children:(0,C.jsxs)("select",{id:"resTyp",name:"resTyp",className:"text",onChange:Cs,value:Ts.resTyp,children:[(0,C.jsx)("option",{value:"-1",children:"<<All>>"}),(0,C.jsx)("option",{value:"subK",children:"Contractor"}),(0,C.jsx)("option",{value:"fte",children:"Employee"})]})})]})}),(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Res.Location",children:["Res.Location"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 multiselect",ref:function(e){cr.current["BusinessUnit"==Kn||"Project"==Kn||"CSL"==Kn||"DP"==Kn||"CustIndustry"==Kn?4:"Customer"==Kn?6:"Resource"==Kn?2:"Sales Executive"==Kn?5:3]=e},children:(0,C.jsx)(c.NU,{ArrowRenderer:Hr,id:"countries",name:"countries",options:xe,hasSelectAll:!0,value:Ce,disabled:!1,onChange:function(e){ke(e);var n=[];e.forEach((function(e){n.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"countries",n.toString()))}))},valueRenderer:qr})})]})}),"BusinessUnit"==Kn||"Customer"==Kn||"Project"==Kn?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Contract Terms",children:["Contract Terms"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 multiselect",ref:function(e){cr.current["BusinessUnit"==Kn||"Project"==Kn?5:"Customer"==Kn?7:""]=e},children:(0,C.jsx)(c.NU,{ArrowRenderer:Hr,id:"contTerms",name:"contTerms",options:qe,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:Ye,disabled:!1,onChange:function(e){Je(e);var n=[];e.forEach((function(e){n.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"contTerms",n.toString()))}))},valueRenderer:qr})})]})}),(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Eng.Company",children:["Eng.Company"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 multiselect",ref:function(e){cr.current["BusinessUnit"==Kn||"Project"==Kn?6:"Customer"==Kn?8:""]=e},children:(0,C.jsx)(c.NU,{ArrowRenderer:Hr,id:"engComp",name:"engComp",options:vn,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:bn,disabled:!1,onChange:function(e){Rn(e);var n=[];e.forEach((function(e){n.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"engComp",n.toString()))}))},valueRenderer:qr})})]})})]}):"",(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Measures",children:["Measures"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6 multiselect",ref:function(e){cr.current["BusinessUnit"==Kn||"Project"==Kn?7:"Customer"==Kn?9:"Resource"==Kn?3:"Sales Executive"==Kn?6:"CSL"==Kn||"DP"==Kn||"CustIndustry"==Kn?5:4]=e},children:(0,C.jsx)(c.NU,{ArrowRenderer:Hr,id:"measures",name:"measures",options:Ae.sort((function(e,n){return e.label.localeCompare(n.label)})),hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:Oe,disabled:!1,onChange:function(e){_e(e);var n=[];e.forEach((function(e){n.push(e.value)})),ws((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},"measures",n.toString()))}))},valueRenderer:qr})})]})}),"Customer"==Kn||"Project"==Kn||"Sales Executive"==Kn||"CSL"==Kn||"DP"==Kn||"CustIndustry"==Kn?(0,C.jsx)(C.Fragment,{children:(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Source",children:["Source"," ",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6",children:(0,C.jsxs)("select",{id:"source",name:"source",defaultValue:null===Ts||void 0===Ts?void 0:Ts.source,onChange:Cs,children:[(0,C.jsx)("option",{value:-1,children:"<<All>>"}),(0,C.jsx)("option",{value:"PPM",children:"PPM"}),(0,C.jsx)("option",{value:"Projector",children:"Projector"})]})})]})})}):"",(0,C.jsx)("div",{className:" col-md-3 mb-2",children:(0,C.jsxs)("div",{className:"form-group row",children:[(0,C.jsxs)("label",{className:"col-5",htmlFor:"Sort By",children:["Sort By",(0,C.jsxs)("span",{className:"required",children:["\xa0",(0,C.jsx)("span",{className:"required error-text",children:"*"})]})]}),(0,C.jsx)("span",{className:"col-1",children:":"}),(0,C.jsx)("div",{className:"col-6",children:(0,C.jsxs)("select",{onChange:Cs,name:"sortBy",id:"sortBy",value:Ts.sortBy,children:[(0,C.jsx)("option",{value:"-1",children:"Default"}),Oe.map((function(e){return(0,C.jsxs)("option",{value:e.value,children:[" ",e.label]})}))]})})]})}),(0,C.jsxs)("div",{className:"col-md-12 btn-container center my-3",children:[(0,C.jsxs)("button",{type:"submit",className:"btn btn-primary",onClick:function(){Vs()},children:[(0,C.jsx)(y.U41,{})," Search"," "]}),jr?(0,C.jsx)(T.Z,{handleAbort:function(){Rr.current&&Rr.current.abort(),br(!1)}}):""]})]})}),lr&&("BusinessUnit"==Kn?(0,C.jsx)(k,{searchdata:Ts,tableData:pr,column:hr,selectType:Kn,month:X,departments:re,customer:g,resources:Qn,project:Wn,sortBy:Gn,laterMeasureLabel:Us,defaultMeasureLabel:Ds}):"CustIndustry"==Kn?(0,C.jsx)(N,{searchdata:Ts,tableData:pr,column:hr,selectType:Kn,month:X,customer:g,resources:Qn,project:Wn,custIndustry:ue,sortBy:Gn,laterMeasureLabel:Us,defaultMeasureLabel:Ds}):"DP"==Kn?(0,C.jsx)(I,{searchdata:Ts,tableData:pr,column:hr,selectType:Kn,month:X,customer:g,resources:Qn,project:Wn,dpList:Mn,sortBy:Gn,laterMeasureLabel:Us,defaultMeasureLabel:Ds}):"CSL"==Kn?(0,C.jsx)(S,{searchdata:Ts,tableData:pr,column:hr,selectType:Kn,month:X,customer:g,resources:Qn,project:Wn,cslList:wn,sortBy:Gn,laterMeasureLabel:Us,defaultMeasureLabel:Ds}):"Sales Executive"==Kn?(0,C.jsx)(E,{searchdata:Ts,tableData:pr,column:hr,selectType:Kn,month:X,customer:g,resources:es,project:Wn,SalesExe:en,sortBy:Gn,selectedCust:Bs,laterMeasureLabel:Us,defaultMeasureLabel:Ds}):"Customer"==Kn?(0,C.jsx)(B,{searchdata:Ts,tableData:pr,column:hr,selectType:Kn,month:X,customer:g,resources:es,project:Wn,departments:re,sortBy:Gn,selectedCust:Bs,laterMeasureLabel:Us,defaultMeasureLabel:Ds}):"Project"==Kn?(0,C.jsx)(M,{searchdata:Ts,tableData:pr,column:hr,selectType:Kn,month:X,resources:es,project:Wn,sortBy:Gn,laterMeasureLabel:Us,defaultMeasureLabel:Ds}):"Resource"==Kn?(0,C.jsx)(P,{searchdata:Ts,tableData:pr,column:hr,selectType:Kn,month:X,resourceData:es,sortBy:Gn,laterMeasureLabel:Us,defaultMeasureLabel:Ds}):"")]}),(0,C.jsx)(A.Z,{visible:Vr,setVisible:Pr,setSelectedItems:Ss,selectedItems:Is,flag:3,dataAccess:wr}),Br?(0,C.jsx)(V,{showPopup:Br,setShowPopup:Mr,setSelectedResource:Gr,setResName:Jr}):""]})}},79122:function(){}}]);
//# sourceMappingURL=6989.61690941.chunk.js.map