"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[4109],{44109:function(e,n,t){t.r(n),t.d(n,{default:function(){return S}});var r=t(74165),s=t(4942),a=t(1413),i=t(15861),l=t(29439),o=t(72791),c=t(59513),u=t.n(c),d=t(72426),m=t.n(d),p=(t(62508),t(56355)),f=t(78983),h=t(74569),g=t.n(h),v=t(34831),x=t(93433),y=t(11683),j=t(83854),b=t(80184);function Z(e){var n=(0,o.useState)(),t=(0,l.Z)(n,2),r=t[0],i=t[1],c=e.tableData,u=e.column,d=e.departments,m=(e.month,e.startDate),f=e.duration,h=e.customerId,Z=e.project,w=e.customer,T=e.resources,_=v.N.baseUrl,C=(0,o.useRef)(null),N=(0,o.useState)(!1),S=(0,l.Z)(N,2),R=S[0],I=S[1],k=u[0],D=u[1],U=u.slice(2).sort(),E=[k,D].concat((0,x.Z)(U),["Total"]),M=(0,o.useState)(E),V=(0,l.Z)(M,2),F=V[0],B=V[1],P=(0,o.useState)([]),A=(0,l.Z)(P,2),L=A[0],G=A[1];(0,o.useEffect)((function(){B(E)}),[e.column]),(0,o.useEffect)((function(){for(var e=1,n=0;n<(null===c||void 0===c?void 0:c.length);n++)c[n].id=e,++e%1e4==17&&(e+=9984);G(K(c))}),[c]);var K=function(e,n){n=(0,a.Z)({id:"id",parentId:"parentId",children:"subRows"},n);var t={},r=[],i=n.children;return e.forEach((function(e){var r=e[n.id],l=e[n.parentId];t[r]=(0,a.Z)((0,a.Z)((0,s.Z)({},i,[]),e),t[r]),t[l]=t[l]||(0,s.Z)({},i,[]),t[l][i].push(t[r])})),Object.values(t).forEach((function(e){"undefined"===typeof e[n.id]&&r.push.apply(r,(0,x.Z)(e[i]))})),r},O=function(e,n,t){C.current=new AbortController,g()({method:"post",url:_+"/customersms/Financials/getFinancials",data:{indTypesId:-1,indTypes:-1,dpResId:-1,dpRes:-1,cslResId:-1,cslRes:-1,engComp:-1,contTerms:-1,engCountries:-1,source:-1,resTyp:-1,custCountries:-1,sortBy:-1,salesExecs:-1,salesExecId:-1,measures:-1,resId:-1,prjId:-1,custId:h,busUnitId:-1,tarType:"Project",srcTypeId:h,srcType:"Customer",customers:h,busUnits:-1,searchType:"Customer",countries:-1,duration:f,month:m,ownerDivisions:-1,direction:""},signal:C.current.signal}).then((function(r){I(!1);var s=r.data.data;s=s.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"_"+e+"_"+t})})),G((function(t){var r=t.findIndex((function(e){return"Planned Revenue"===e.descr&&e.name===n}));return-1!==r?[].concat((0,x.Z)(t.slice(0,r+1)),(0,x.Z)(s.map((function(n,t){return(0,a.Z)((0,a.Z)({},n),{},{id:e+t+1})}))),(0,x.Z)(t.slice(r+1))):t}))})).catch((function(e){I(!1),console.log("Error :",e)}))};(0,o.useEffect)((function(){O()}),[]);var Y=function(e,n,t,r,s){i(e),C.current=new AbortController,g()({method:"post",url:_+"/revenuemetricsms/RevenueMarginAnalysis/GetFinancialsFinalData",data:{indTypesId:-1,indTypes:-1,dpResId:-1,dpRes:-1,cslResId:-1,cslRes:-1,engComp:-1,contTerms:-1,engCountries:-1,source:-1,resTyp:-1,custCountries:-1,sortBy:-1,salesExecs:-1,salesExecId:-1,measures:-1,resId:-1,prjId:e,custId:s,busUnitId:-1,tarType:"BusinessUnit",srcTypeId:e,srcType:"Project",customers:s,busUnits:-1,searchType:"Customer",countries:-1,duration:f,month:m,ownerDivisions:-1},signal:C.current.signal}).then((function(r){I(!1);var i=r.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"_"+e+"_"+t+"_"+s})})),G((function(t){var r=t.findIndex((function(e){return"Planned Revenue"===e.kpi&&e.name.split("_")[0]===n}));return-1!==r?[].concat((0,x.Z)(t.slice(0,r+1)),(0,x.Z)(i.map((function(n,t){return(0,a.Z)((0,a.Z)({},n),{},{id:e+t+1})}))),(0,x.Z)(t.slice(r+1))):t}))})).catch((function(e){I(!1),console.log("Error :",e)}))};(0,o.useEffect)((function(){Y()}),[]);var z=function(e,n,t,s,i,l){C.current=new AbortController,g()({method:"post",url:_+"/customersms/Financials/getFinancials",data:{indTypesId:-1,indTypes:-1,dpResId:-1,dpRes:-1,cslResId:-1,cslRes:-1,engComp:-1,contTerms:-1,engCountries:-1,source:-1,resTyp:-1,custCountries:-1,sortBy:-1,salesExecs:-1,salesExecId:-1,measures:-1,resId:-1,prjId:r,custId:i,busUnitId:e,tarType:"Res",srcTypeId:e,srcType:"BusinessUnit",customers:i,busUnits:-1,searchType:"Customer",countries:-1,duration:f,month:m,ownerDivisions:-1},signal:C.current.signal}).then((function(r){I(!1);var s=r.data.data;s=s.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"_"+e+"_"+t+"_"+i+"_"+l})})),G((function(t){var r=t.findIndex((function(e){return"Planned Revenue"===e.kpi&&e.name.split("_")[0]===n}));return-1!==r?[].concat((0,x.Z)(t.slice(0,r+1)),(0,x.Z)(s.map((function(n,t){return(0,a.Z)((0,a.Z)({},n),{},{id:e+t+1})}))),(0,x.Z)(t.slice(r+1))):t}))})).catch((function(e){I(!1),console.log("Error :",e)}))};(0,o.useEffect)((function(){z()}),[]);var W=function(e,n,t,r,s,i,l){C.current=new AbortController,g()({method:"post",url:_+"/customersms/Financials/getFinancials",data:{indTypesId:-1,indTypes:-1,dpResId:-1,dpRes:-1,cslResId:-1,cslRes:-1,engComp:-1,contTerms:-1,engCountries:-1,source:-1,resTyp:-1,custCountries:-1,sortBy:-1,salesExecs:-1,salesExecId:-1,measures:-1,resId:-1,prjId:l,custId:s,busUnitId:i,tarType:t,srcTypeId:e,srcType:r,customers:s,busUnits:-1,searchType:"Customer",countries:-1,duration:f,month:m,ownerDivisions:-1},signal:C.current.signal}).then((function(r){I(!1);var i=r.data.data;i=i.map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{name:n.name+"_"+e+"_"+t+"_"+s})})),G((function(t){var r=t.findIndex((function(e){return"Planned Revenue"===e.kpi&&e.name.split("_")[0].replace(/\s+/g," ")===n.replace(/\s+/g," ")}));return-1!==r?[].concat((0,x.Z)(t.slice(0,r+1)),(0,x.Z)(i.map((function(n,t){return(0,a.Z)((0,a.Z)({},n),{},{id:e+t+1})}))),(0,x.Z)(t.slice(r+1))):t}))})).catch((function(e){I(!1),console.log("Error :",e)}))};(0,o.useEffect)((function(){W()}),[]);var H=[{header:(0,b.jsxs)("div",{className:"legendContainer wrap",children:[(0,b.jsxs)("div",{className:"legend green",children:[(0,b.jsx)("div",{className:"legendCircle"}),(0,b.jsx)("div",{className:"legendTxt",children:(0,b.jsx)("b",{children:"Customer"})})]}),(0,b.jsxs)("div",{className:"legend",children:[(0,b.jsx)("div",{className:"legendCircle",style:{backgroundColor:"#800080"}}),(0,b.jsx)("div",{className:"legendTxt",children:(0,b.jsx)("b",{children:"Project"})})]}),(0,b.jsxs)("div",{className:"legend ",children:[(0,b.jsx)("div",{className:"legendCircle",style:{backgroundColor:"#e17658"}}),(0,b.jsx)("div",{className:"legendTxt",children:(0,b.jsx)("b",{children:"BU"})})]}),(0,b.jsxs)("div",{className:"legend black",children:[(0,b.jsx)("div",{className:"legendCircle"}),(0,b.jsx)("div",{className:"legendTxt",children:(0,b.jsx)("b",{children:"Res"})})]})]}),accessorKey:"name",enableGrouping:!1,GroupedCell:function(e){var n,t,r,i,c,u,m=e.cell,f=w.find((function(e){return e.fullName===m.getValue()})),h=(0,o.useState)({}),g=(0,l.Z)(h,2),v=g[0],x=g[1],y=Z.find((function(e){if(e.name===m.getValue().split("_")[0]){var t=m.getValue().split("_")[1];n=t}return e.name===m.getValue().split("_")[0]})),j=(0,o.useState)({}),_=(0,l.Z)(j,2),C=_[0],N=_[1],S=function(){if(y){var e=y.id,t=y.name;L.some((function(n){return n.name.includes("_".concat(e))}))?(N((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,s.Z)({},e,!1))})),G((function(n){return n.filter((function(n){return!n.name.includes("_".concat(e))}))}))):(N((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,s.Z)({},e,!0))})),I(!1),Y(e,t,"BusinessUnit",0,n))}},R=d.find((function(e){if(e.label===m.getValue().split("_")[0]){var n=m.getValue().split("_")[3];t=n,r=m.getValue().split("_")[1]}return e.label.split("_")[0]===m.getValue().split("_")[0]||e.label.split("_")[0]===m.getValue().split("_")[0]})),k=(0,o.useState)({}),D=(0,l.Z)(k,2),U=D[0],E=D[1],M=T.find((function(e){if(e.fullName===m.getValue().split("_")[0]){var n=m.getValue().split("_")[3];c=m.getValue().split("_")[1],u=m.getValue().split("_")[4],i=n}return e.fullName.split("_")[0]===m.getValue().split("_")[0]})),V=(0,o.useState)({}),F=(0,l.Z)(V,2),B=F[0],P=F[1];if(f){var A=v[f.id];return(0,b.jsxs)("span",{style:{cursor:"pointer"},value:f.id,onClick:function(){!function(){if(f){var e=f.id,n=f.fullName;L.some((function(n){return n.name.includes("_".concat(e))}))?(x((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,s.Z)({},e,!1))})),G((function(n){return n.filter((function(n){return!n.name.includes("_".concat(e))}))}))):(x((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,s.Z)({},e,!0))})),I(!1),O(e,n,"Project"))}}()},className:"parent",children:[A?(0,b.jsx)(p.NR5,{}):(0,b.jsx)(p.jS6,{})," ",(0,b.jsxs)("b",{style:{color:"rgba(66, 144, 99, 0.9)"},title:f.fullName+" ("+m.row.original.count+")",children:[f.fullName," (",m.row.original.count,")"]})]})}if(y){var K=C[y.id];return(0,b.jsx)("span",{style:{cursor:"pointer"},value:y.id,onClick:function(){S()},className:"parent",children:""==m.row.original.name.split("_")[0]?"Summary":(0,b.jsxs)(b.Fragment,{children:[K?(0,b.jsx)(p.NR5,{}):(0,b.jsx)(p.jS6,{})," ",(0,b.jsx)("b",{style:{color:"purple"},title:y.name+" ("+m.row.original.count+")",children:""==m.getValue().split("_")[0]?(0,b.jsx)("div",{style:{justifyContent:"center"},children:"Summary"}):y.name+"("+m.row.original.count+")"})]})})}if(R){var H=U[R.value];return(0,b.jsxs)("span",{style:{cursor:"pointer"},value:R.value,onClick:function(){!function(){if(R){var e=R.value,n=R.label;L.some((function(n){return n.name.includes("_".concat(e))}))?(E((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,s.Z)({},e,!1))})),G((function(n){return n.filter((function(n){return!n.name.includes("_".concat(e))}))}))):(E((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,s.Z)({},e,!0))})),I(!1),z(e,n,"Res",0,t,r))}}()},className:"parent",children:[H?(0,b.jsx)(p.NR5,{}):(0,b.jsx)(p.jS6,{})," ",(0,b.jsxs)("b",{style:{color:"#e17658"},title:R.label+" ("+m.row.original.count+")",children:[R.label," (",m.row.original.count,")"]})]})}if(M){var $=B[M.id];return(0,b.jsxs)("span",{style:{cursor:"pointer"},value:M.id,onClick:function(){!function(){if(M){var e=M.id,n=M.fullName;L.some((function(n){return n.name.includes("_".concat(e))}))?(P((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,s.Z)({},e,!1))})),G((function(n){return n.filter((function(n){return!n.name.includes("_".concat(e))}))}))):(P((function(n){return(0,a.Z)((0,a.Z)({},n),{},(0,s.Z)({},e,!0))})),I(!1),W(e,n,"Leaf","Res",i,c,u))}}()},className:"parent",children:[$?(0,b.jsx)(p.NR5,{}):(0,b.jsx)(p.jS6,{})," ",(0,b.jsx)("b",{style:{color:"#333"},title:M.fullName,children:M.fullName})]})}return(0,b.jsxs)("span",{className:"child",style:{color:"Customer"===m.getValue().split("_")[2]?"rgba(66, 144, 99, 0.9)":"",display:"flex",justifyContent:"center"},title:""===m.row.original.name?"Summary":m.getValue().split("_")[0]+" ("+m.row.original.count+")",children:[(0,b.jsxs)("b",{style:{color:"Project"==m.getValue().split("_")[2]?"rgba(66, 144, 99, 0.9)":"BusinessUnit"==m.getValue().split("_")[2]?"purple":"Res"==m.getValue().split("_")[2]?"#e17658":"Leaf"==m.getValue().split("_")[2]?"#333":""},className:"summary",children:[""==m.row.original.name||""==m.getValue().split("_")[0]?"Summary":(0,b.jsxs)("div",{onClick:S,children:[(0,b.jsx)(p.jS6,{})," ",m.getValue().split("_")[0]]})," ","Leaf"==m.getValue().split("_")[2]?"":"("+m.row.original.count+")"]})," "]})}},{header:"",accessorKey:"kpi",Cell:function(e){var n=e.cell,t=w.find((function(e){return e.fullName===n.row.original.name})),r=Z.find((function(e){return e.name===n.row.original.name.split("_")[0]})),s=d.find((function(e){return e.label.split("_")[0]===n.row.original.name.split("_")[0]})),a=T.find((function(e){return e.fullName.split("_")[0]===n.row.original.name.split("_")[0]}));return(0,b.jsx)("span",{className:"kpi",children:(0,b.jsx)("b",{style:{color:t?"rgba(66, 144, 99, 0.9)":r?"purple":s?"#e17658":a?"#333":"Project"==n.row.original.name.split("_")[2]?"rgba(66, 144, 99, 0.9)":"BusinessUnit"==n.row.original.name.split("_")[2]?"purple":"Res"==n.row.original.name.split("_")[2]?"#e17658":"Leaf"==n.row.original.name.split("_")[2]?"#333":""},children:n.getValue()})})}}];F.forEach((function(e,n){if(n>1&&"Total"!==e){var t=new Date("".concat(e.slice(0,4),"-").concat(e.slice(5,7),"-").concat(e.slice(8,10))).toLocaleDateString("en-US",{month:"short",year:"numeric"}).replace(" ","-");null===H||void 0===H||H.push({header:t,accessorKey:"".concat(e),className:"software",Cell:function(e){var n,t=e.cell;return(0,b.jsxs)("span",{children:["Planned Revenue"==t.row.original.kpi||"Actual Revenue"==t.row.original.kpi||"Recognized Revenue"==t.row.original.kpi||"Resource Direct Cost"==t.row.original.kpi||"Other Direct Cost"==t.row.original.kpi||"Gross Margin"==t.row.original.kpi?(0,b.jsx)("span",{style:{display:"block",float:"left"},children:"$"}):"",(0,b.jsxs)("span",{style:{display:"block",float:"right"},children:[null==t.getValue()?0:null===(n=t.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==t.row.original.kpi||"Billable Utilization"==t.row.original.kpi||"FTE"==t.row.original.kpi||"SUBK"==t.row.original.kpi||"Billed Utilization"==t.row.original.kpi||"SUBK"==t.row.original.kpi?(0,b.jsx)("span",{children:"%"}):""]})]})}})}}));var $=H.length,q={header:(0,b.jsx)("b",{children:"Total"}),accessorKey:"Total",Cell:function(e){var n,t=e.cell;return(0,b.jsxs)(b.Fragment,{children:["Planned Revenue"==t.row.original.kpi||"Actual Revenue"==t.row.original.kpi||"Recognized Revenue"==t.row.original.kpi||"Resource Direct Cost"==t.row.original.kpi||"Other Direct Cost"==t.row.original.kpi||"Gross Margin"==t.row.original.kpi?(0,b.jsx)("span",{style:{display:"block",float:"left"},children:(0,b.jsx)("b",{children:"$"})}):"",(0,b.jsx)("span",{style:{display:"block",float:"right"},className:"total",children:(0,b.jsxs)("b",{children:[null===(n=t.getValue())||void 0===n?void 0:n.toLocaleString("en-US"),"Gross Margin %"==t.row.original.kpi||"Billable Utilization"==t.row.original.kpi||"FTE"==t.row.original.kpi||"SUBK"==t.row.original.kpi||"Billed Utilization"==t.row.original.kpi||"SUBK"==t.row.original.kpi?(0,b.jsx)("span",{children:null==t.getValue()?0:"%"}):""]})})]})}};return H.splice($,0,q),(0,b.jsxs)("div",{className:"materialReactExpandableTable financialTable darkHeader",children:[(0,b.jsx)(y.ZP,{columns:H,data:L,enableExpanding:function(e){return"name"===e.id},enablePagination:!1,enableGlobalFilter:!0,enableDensityToggle:!1,enableFullScreenToggle:!1,enableHiding:!1,enableColumnFilters:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!0,filterFromLeafRows:!0,initialState:{showGlobalFilter:!0,grouping:["name"],expanded:!0,density:"compact",columnPinning:{right:["Total"]}},muiTableContainerProps:{sx:{width:"auto"}},muiTableBodyProps:{sx:{"&":{borderRight:"1px solid #ccc",borderBottom:"1px solid #ccc"},"& td":{borderRight:"1px solid #ccc",height:"22px",padding:"0px 5px",minWidth:"60px",width:"60px",maxWidth:"60px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",padding:"0 5px",minWidth:"60px",width:"60px",maxWidth:"60px",verticalAlign:"middle"}}}}),R?(0,b.jsx)(j.Z,{handleAbort:function(){C.current&&C.current.abort(),I(!1)}}):""]})}var w=t(37145),T=t(1063),_=t(32125),C=t(78820),N=t(38262);var S=function(e){var n,t=e.customerId,c=(0,o.useRef)([]),d=(0,o.useState)(!1),h=(0,l.Z)(d,2),x=h[0],y=h[1],S=v.N.baseUrl,R=(new Date).getFullYear(),I=(0,o.useState)(!1),k=(0,l.Z)(I,2),D=k[0],U=k[1],E=(new Date(R,0,1).getMonth(),(new Date).getMonth()+1-6);n=E<0?new Date(R,0,1):new Date(R,E,1);var M=(0,o.useState)(n),V=(0,l.Z)(M,2),F=V[0],B=V[1],P=(0,o.useState)(),A=(0,l.Z)(P,2),L=A[0],G=A[1],K=((new Date).getMonth(),(0,o.useState)(6)),O=(0,l.Z)(K,2),Y=O[0],z=O[1],W=(0,o.useState)(),H=(0,l.Z)(W,2),$=H[0],q=H[1],J=(0,o.useState)(),Q=(0,l.Z)(J,2),X=Q[0],ee=Q[1],ne=localStorage.getItem("resId"),te=(0,o.useState)([]),re=(0,l.Z)(te,2),se=re[0],ae=re[1];(0,o.useEffect)((function(){ie()}),[]);var ie=function(){g()({method:"GET",url:S+"/CommonMS/master/getMenus?loggedUserId=".concat(ne)}).then((function(e){e.data.forEach((function(e){"Customers"===e.display_name&&ae([e])}))}))},le=function(e){var n,t=un(e),r=un(m()());n=new Date(e).getFullYear()!==(new Date).getFullYear()||r.totalMonths-t.totalMonths>5?5:r.totalMonths-t.totalMonths,n+=1;for(var s=[],a=1;a<=n;a++)s.push(a);G(s)},oe={ownerDivisions:-1,month:m()(F).format("yyyy-MM-DD"),duration:L,countries:-1,searchType:"Customer",busUnits:-1,customers:t,srcType:-1,srcTypeId:-1,tarType:"Customer",busUnitId:-1,custId:-1,prjId:-1,resId:-1,measures:-1,salesExecId:-1,salesExecs:-1,sortBy:-1,custCountries:-1,resTyp:-1,source:-1,engCountries:-1,contTerms:-1,engComp:-1,cslRes:-1,cslResId:-1,dpRes:-1,dpResId:-1,indTypes:-1,indTypesId:-1},ce=(0,o.useState)(oe),ue=(0,l.Z)(ce,2),de=ue[0],me=ue[1],pe=(0,o.useState)([]),fe=(0,l.Z)(pe,2),he=fe[0],ge=fe[1],ve=(0,o.useRef)(null),xe=(0,o.useState)(new Date),ye=(0,l.Z)(xe,2),je=(ye[0],ye[1],(0,o.useState)(!1)),be=(0,l.Z)(je,2),Ze=be[0],we=be[1],Te=(0,o.useState)(p.UdN),_e=(0,l.Z)(Te,2),Ce=_e[0],Ne=_e[1],Se=(0,o.useState)(m()(m()().subtract(5,"months"))._d),Re=(0,l.Z)(Se,2),Ie=Re[0],ke=Re[1],De=(0,o.useState)(null),Ue=(0,l.Z)(De,2),Ee=Ue[0],Me=Ue[1],Ve=(0,o.useState)(!1),Fe=(0,l.Z)(Ve,2),Be=Fe[0],Pe=Fe[1],Ae=(0,o.useState)([]),Le=(0,l.Z)(Ae,2),Ge=Le[0],Ke=Le[1],Oe=(0,o.useState)([]),Ye=(0,l.Z)(Oe,2),ze=(Ye[0],Ye[1]),We=(0,o.useState)([]),He=(0,l.Z)(We,2),$e=He[0],qe=He[1],Je=(0,o.useState)([]),Qe=(0,l.Z)(Je,2),Xe=Qe[0],en=Qe[1],nn=(0,o.useState)([]),tn=(0,l.Z)(nn,2),rn=tn[0],sn=tn[1],an=(0,o.useState)([]),ln=(0,l.Z)(an,2),on=ln[0],cn=ln[1],un=function(e){var n=Number(m()(e).format("MM"))+12*Number(m()(e).format("YYYY"));return{totalMonths:n,year:Math.floor(n/12),month:n%12}};(0,o.useEffect)((function(){U(!1),setTimeout((function(){z(6),mn()}),3e3)}),[]),(0,o.useEffect)((function(){le(Ie)}),[]);var dn=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var n,t,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g()({url:S+"/CostMS/cost/getDepartments"});case 2:n=e.sent,t=(t=n.data).filter((function(e){return e.value>=0})),cn(t),i=[],t.forEach((function(e){i.push(e.value)})),me((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,s.Z)({},"busUnits",i.toString()))}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){g()({method:"get",url:S+"/customersms/Customers/getNewCustomerList"}).then((function(e){var n=e.data;en(n)})),g()({method:"get",url:S+"/revenuemetricsms/RevenueMarginAnalysis/getResources"}).then((function(e){var n=e.data;ze(n)})),g()({method:"get",url:S+"/revenuemetricsms/RevenueMarginAnalysis/getProjects"}).then((function(e){var n=e.data;ge(n)})),dn(),g()({method:"get",url:S+"/revenuemetricsms/RevenueMarginAnalysis/getResources"}).then((function(e){var n=e.data;qe(n)}))}),[]);var mn=function(e){Me([]),ve.current=new AbortController;var n=(0,_.Z)(c);if(n)y(!0);else{y(!1);var r=setTimeout((function(){U(!0)}),2e3);g()({method:"post",url:S+"/customersms/Financials/getFinancials",data:{ownerDivisions:-1,month:m()(F).format("yyyy-MM-DD"),duration:Y,countries:-1,searchType:"Customer",busUnits:-1,customers:t,srcType:-1,srcTypeId:-1,tarType:"Customer",busUnitId:-1,custId:-1,prjId:-1,resId:-1,measures:-1,salesExecId:-1,salesExecs:-1,sortBy:-1,custCountries:-1,resTyp:-1,source:-1,engCountries:-1,contTerms:-1,engComp:-1,cslRes:-1,cslResId:-1,dpRes:-1,dpResId:-1,indTypes:-1,indTypesId:-1}}).then((function(e){var t=e.data.data,s=t.filter((function(e){return"Planned Revenue"===e.descr&&""!==e.name}));Me(s),Pe(!0),ze(t),ee(e.data.data),clearTimeout(r),!n&&we(!Ze),Ne(Ze?p.UdN:p.NR5)})).catch((function(e){U(!1)})),g()({method:"post",url:S+"/customersms/Financials/getvendors",data:{month:m()(F).format("yyyy-MM-DD"),duration:Y,customers:t}}).then((function(e){var n=e.data;q(n?[n]:[]),sn("")})).catch()}};(0,o.useEffect)((function(){if(Ee&&Ee[0]){var e=["name","kpi"].concat(Object.keys(Ee[0]).filter((function(e){return e.match(/\d{4}_\d{2}_\d{2}/)}))).sort((function(e,n){if("Total"===e)return 1;if("Total"===n)return-1;var t=new Date(e.replace("_","-")),r=new Date(n.replace("_","-")),s=t.toLocaleString("en-US",{month:"short",year:"numeric"}),a=r.toLocaleString("en-US",{month:"short",year:"numeric"});return s.localeCompare(a)}));e.includes("Total")||e.push("Total"),Ke(e)}else if(X&&X[0]){var n=["name","kpi"].concat(Object.keys(X[0]).filter((function(e){return e.match(/\d{4}_\d{2}_\d{2}/)}))).sort((function(e,n){if("Total"===e)return 1;if("Total"===n)return-1;var t=new Date(e.replace("_","-")),r=new Date(n.replace("_","-")),s=t.toLocaleString("en-US",{month:"short",year:"numeric"}),a=r.toLocaleString("en-US",{month:"short",year:"numeric"});return s.localeCompare(a)}));n.includes("Total")||n.push("Total"),Ke(n)}}),[Ee,X]);var pn=new Date,fn=function(e){var n=e.split("_"),t=n[0],r=parseInt(n[1],10),s=new Date(t,r-1,1).toLocaleString("default",{month:"short"});return"".concat(s,"-").concat(t)};return(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"col-md-12",children:(0,b.jsxs)("div",{className:"pageTitle",children:[(0,b.jsx)("div",{className:"childOne"}),(0,b.jsx)("div",{className:"childTwo",children:(0,b.jsx)("h2",{children:"Customer Gross Margin Analysis"})}),(0,b.jsx)("div",{className:"childThree"})]})}),(0,b.jsx)(N.Z,{routes:se,currentScreenName:["Customer Gross Margin Analysis"]}),x?(0,b.jsx)("div",{className:"statusMsg error",children:(0,b.jsxs)("span",{className:"error-block",children:[(0,b.jsx)(C.CSE,{})," \xa0 Please select valid values for highlighted fields"]})}):"",(0,b.jsxs)("div",{className:"group mb-3 customCard",children:[(0,b.jsxs)("div",{className:"col-md-12 collapseHeader",children:[(0,b.jsx)("h2",{children:"Search Filters"}),(0,b.jsx)("div",{onClick:function(){we(!Ze),Ne(Ze?p.UdN:p.NR5)},children:(0,b.jsx)("span",{children:Ce})})]}),(0,b.jsx)(f.V9,{visible:!Ze,children:(0,b.jsxs)("div",{className:"group-content row",children:[(0,b.jsx)("div",{className:" col-md-3 mb-2",children:(0,b.jsxs)("div",{className:"form-group row",children:[(0,b.jsxs)("label",{className:"col-5",htmlFor:"fy",children:["Start Month ",(0,b.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,b.jsx)("span",{className:"col-1 p-0",children:":"}),(0,b.jsx)("div",{className:"col-6",children:(0,b.jsx)("div",{children:(0,b.jsx)(u(),{selected:F,onChange:function(e){B(e),le(e),ke(e),z(""),me((function(e){return(0,a.Z)((0,a.Z)({},e),{},{duration:""})}))},maxDate:pn,dateFormat:"MMM-yyyy",showMonthYearPicker:!0})})})]})}),(0,b.jsx)("div",{className:" col-md-3 mb-2",children:(0,b.jsxs)("div",{className:"form-group row",children:[(0,b.jsxs)("label",{className:"col-5",htmlFor:"duration",children:["Duration ",(0,b.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,b.jsx)("span",{className:"col-1 p-0",children:":"}),(0,b.jsx)("div",{className:"col-6",children:(0,b.jsxs)("select",{className:"error enteredDetails cancel text",id:"duration",value:Y,onChange:function(e){z(e.target.value)},ref:function(e){c.current[0]=e},children:[(0,b.jsx)("option",{value:"",children:"<< Please Select >>"}),null===L||void 0===L?void 0:L.map((function(e){return(0,b.jsx)("option",{value:e,children:e},e)}))]})})]})}),(0,b.jsxs)("div",{className:"col-md-12 col-sm-12 col-xs-12 btn-container center my-2",children:[(0,b.jsxs)("button",{type:"submit",className:"btn btn-primary",onClick:function(){mn()},children:[(0,b.jsx)(p.U41,{})," Search"," "]}),(0,b.jsx)("div",{children:D?(0,b.jsx)(j.Z,{handleAbort:function(){ve.current&&ve.current.abort(),U(!1)}}):""})]})]})})]}),(0,b.jsxs)("div",{children:[" ",Be&&(0,b.jsx)(Z,{startDate:m()(F).format("yyyy-MM-DD"),duration:Y,customerId:t,tableData:Ee,column:Ge,month:Ie,searchdata:de,customer:Xe,resources:$e,departments:on,project:he})]}),(0,b.jsx)("br",{}),(0,b.jsx)("div",{className:"primeReactDataTable darkHeader",children:Be&&(0,b.jsx)("div",{className:" primeReactDataTable financialSecondTable",children:(0,b.jsx)(w.w,{className:"resourceOverviewEmp",stripedRows:!0,showGridlines:!0,value:rn,emptyMessage:"No Data Found",children:function(){if(0===$.length)return null;var e=Object.keys($[0]).filter((function(e){return e.match(/^\d{4}_\d{2}_\d{2}$/)})).sort(),n=[];return n.push((0,b.jsx)(T.s,{header:"Vendor"},"vendor")),n.push((0,b.jsx)(T.s,{field:"",header:""},"blank")),e.forEach((function(t,r){var s={minWidth:"60px",maxWidth:"60px",backgroundColor:r===e.length-1?"aliceblue":"transparent"};n.push((0,b.jsx)(T.s,{field:t,header:fn(t),style:s},t))})),n.push((0,b.jsx)(T.s,{field:"Total",header:"Total"},"total")),n}()})})})]})}}}]);
//# sourceMappingURL=4109.c41c3edb.chunk.js.map