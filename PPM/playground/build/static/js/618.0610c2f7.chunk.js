"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[618],{70618:function(e,n,l){l.r(n),l.d(n,{default:function(){return R}});var o=l(4942),t=l(1413),s=l(74165),a=l(15861),r=l(29439),i=l(72791),c=l(36167),d=l(1063),u=l(34831),m=l(74569),h=l.n(m),v=l(59513),p=l.n(v),f=l(72426),g=l.n(f),x=l(37145),j=l(25103),y=l(46175),b=l(87890),N=l(41310),S=l(93433),C=l(11683),w=(l(83854),l(80184));function Z(e){var n=e.formData,l=(0,i.useState)([]),s=(0,r.Z)(l,2),a=s[0],c=s[1],d=localStorage.getItem("resId"),m=(0,i.useState)(null),v=(0,r.Z)(m,2),p=v[0],f=v[1],g=(0,i.useState)({}),x=(0,r.Z)(g,2),j=x[0],y=(x[1],(0,i.useState)([])),b=(0,r.Z)(y,2),N=(b[0],b[1]),Z=(0,i.useState)({}),D=(0,r.Z)(Z,2),T=D[0],R=D[1],M=(0,i.useState)([]),A=(0,r.Z)(M,2),E=(A[0],A[1]);(0,i.useEffect)((function(){P()}),[T]),console.log(T+".......data");var _=u.N.baseUrl;console.log(T),(0,i.useEffect)((function(){h()({method:"post",url:_+"/administrationms/roleCosts/getviewDetails",data:{Country:n.country,Bu:n.resBusinessUnit,loggedUser:d,RoleTypeId:0,history:!1},headers:{"Content-Type":"application/json"}}).then((function(e){console.log(e+"in line 224............");var n=e.data.tableData;console.log(n);var l=e.data;console.log(e.data+"in line 228................."),console.log(l+".......fdata");var o=l.columns.split(",");console.log(o+".......columnsArray"),l.columns=o.join(","),console.log(l.columns+"........... fdataColumns"),E(n),console.log(n),R(l),console.log(T)})).then((function(e){console.log(e)}))}),[]),(0,i.useEffect)((function(){B()}),[T]);var B=function(){var e,n=[],l=null===T||void 0===T||null===(e=T.columns)||void 0===e?void 0:e.replaceAll("'","").split(","),o=[];null===l||void 0===l||l.forEach((function(e,l){if(e.includes("_")&&!e.includes("role")){var t=e.split("_");t.forEach((function(e,n){n==t.length-1&&!o.includes(e)&&o.push(e)}))}n.push(newColumn)})),f(n)},P=function(){var e,n,l=T.tableData;console.log(l+"...........tableData");var o,t=null;null!==T&&void 0!==T&&null!==(e=T.columns)&&void 0!==e&&e.includes("'")?t=null===T||void 0===T||null===(o=T.columns)||void 0===o?void 0:o.replaceAll("'",""):t=null===T||void 0===T?void 0:T.columns;var s=null===(n=t)||void 0===n?void 0:n.split(","),a=[],i={};console.log(s);for(var d=0;d<(null===s||void 0===s?void 0:s.length);d++){var u=s[d].trim(),m=l;i[u]=m[u]}console.log(i);var h=Object.entries(i);console.log(h);var v=h;N(v),v.map((function(e,n){var l=(0,r.Z)(e,2),o=l[0],t=l[1];console.log(o+"..............key"),console.log(t+"va;ue"),a.push({accessorKey:o,header:o,enableColumnActions:!1,enableHiding:!0,Header:function(e){e.column;return(0,w.jsx)("div",{children:o})},Cell:function(e){var n=e.cell;return console.log(n),(0,w.jsx)("div",{title:n.getValue(),children:n.getValue()})}})})),console.log(a);var p=[],f=[];l&&l.length>0&&l.forEach((function(e){e&&e.role_type_id&&e.role_type_id.length>0?p.push(e):f.push(e)}));var g=U(p),x=(0,S.Z)(g);c(x)},U=function(e,n){n=(0,t.Z)({},n);var l={},s=[],a=n.children;return e.forEach((function(e){var s=e[n.Resource],r=e[n.Supervisor];l[s]=(0,t.Z)((0,t.Z)((0,o.Z)({},a,[]),e),l[s]),l[r]=l[r]||(0,o.Z)({},a,[]),l[r][a].push(l[s])})),Object.values(l).forEach((function(e){"undefined"===typeof e[n.Resource]&&s.push.apply(s,(0,S.Z)(e[a]))})),s};console.log(a),console.log(p);console.log(p);var k=function(e){return Object.keys(e).map((function(e){return{accessorKey:e,header:e}}))}(T);return console.log(k),(0,w.jsx)(w.Fragment,{children:(0,w.jsx)("div",{className:"",style:{marginTop:"20px"},children:p&&a?(0,w.jsx)(C.ZP,{columns:p,data:a,enableExpandAll:!0,enableExpanding:!1,enablePagination:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!1,filterFromLeafRows:!0,enablePinning:!0,initialState:{expanded:!1,density:"compact",columnVisibility:(0,t.Z)({},j),columnPinning:{right:["total"],left:["name"]}},state:{columnVisibility:(0,t.Z)({},j)},paginateExpandedRows:!1,defaultColumn:{minSize:40,maxSize:1e3,size:150},muiTableContainerProps:{sx:{maxHeight:"50vh",width:"auto",maxWidth:"fit-content"}},muiTableBodyProps:{sx:{"&":{},"& td":{borderRight:"1px solid #ccc",height:"22px",fontSize:"11px",paddingTop:"0px",paddingBottom:"0px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",fontSize:"11px",padding:"0px 8px"}}}}):(0,w.jsx)("p",{children:"Data is not available."})})})}var D=l(56355),T=l(78983);var R=function(){var e=(0,i.useState)(D.UdN),n=(0,r.Z)(e,2),l=n[0],m=n[1],v=(0,i.useState)(!1),f=(0,r.Z)(v,2),S=f[0],C=f[1],R=(0,i.useState)([]),M=(0,r.Z)(R,2),A=M[0],E=M[1],_=(0,i.useState)([]),B=(0,r.Z)(_,2),P=B[0],U=B[1],k=(0,i.useState)([]),I=(0,r.Z)(k,2),Y=I[0],V=I[1],F=(0,i.useState)([{}]),L=(0,r.Z)(F,2),H=L[0],O=L[1],z=(0,i.useState)(null),K=(0,r.Z)(z,2),W=K[0],G=K[1],X=(0,i.useState)(!1),q=(0,r.Z)(X,2),Q=q[0],$=q[1],J=u.N.baseUrl;console.log(null===P||void 0===P?void 0:P.length);var ee=new Date,ne=ee.getFullYear(),le=ee.getMonth(),oe=(ee.getDate(),new Date(ne,le)),te=new Date(ne,le,1),se=new Date(ne,0,1);console.log(g()(te).format("YYYY-MM-DD"));var ae={resBusinessUnit:"170,211,123,82,168,207,212,18,213,49,149,208,243",action:"view",country:"3",month:g()(te).format("YYYY-MM-DD"),countryName:"India"};console.log(g()(te).format("YYYY-MM-DD"));var re=(0,i.useState)(ae),ie=(0,r.Z)(re,2),ce=ie[0],de=ie[1],ue=(0,i.useState)(""),me=(0,r.Z)(ue,2),he=(me[0],me[1],(0,i.useState)({})),ve=(0,r.Z)(he,2),pe=(ve[0],ve[1]),fe=(0,i.useState)({}),ge=(0,r.Z)(fe,2),xe=ge[0],je=ge[1],ye=(0,i.useState)({global:{value:null,matchMode:b.a6.CONTAINS},name:{operator:b.pg.AND,constraints:[{value:null,matchMode:b.a6.STARTS_WITH}]},"country.name":{operator:b.pg.AND,constraints:[{value:null,matchMode:b.a6.STARTS_WITH}]},representative:{value:null,matchMode:b.a6.IN},status:{operator:b.pg.OR,constraints:[{value:null,matchMode:b.a6.EQUALS}]}}),be=(0,r.Z)(ye,2),Ne=be[0],Se=be[1],Ce=function(){h()({url:J+"/administrationms/roleCosts/getResource?Country=".concat(null===ce||void 0===ce?void 0:ce.country,"&Bu=").concat(null===ce||void 0===ce?void 0:ce.resBusinessUnit,"&monthStartDate=").concat(null===ce||void 0===ce?void 0:ce.month)}).then((function(e){O(e.data)}))};console.log(H);var we=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var n,l,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h()({url:J+"/CostMS/cost/getDepartments"});case 2:n=e.sent,(l=n.data).push({value:0,label:"Non-Revenue Units"}),U(l),V(l.filter((function(e){return 0!=e.value}))),o=[],null===l||void 0===l||l.forEach((function(e){0!=e.value&&o.push(e.value)}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){h()({url:J+"/revenuemetricsms/headCountAndTrend/getCountries"}).then((function(e){E(e.data)})),we(),Ce()}),[]);var Ze=(0,w.jsxs)(y.E,{children:[(0,w.jsxs)(N.X,{children:[(0,w.jsx)(d.s,{header:"Verif. Health",rowSpan:2}),(0,w.jsx)(d.s,{header:"Resource Name",rowSpan:2}),(0,w.jsx)(d.s,{header:"Department",rowSpan:2}),(0,w.jsx)(d.s,{header:"Role Type",rowSpan:2}),(0,w.jsx)(d.s,{header:"Designation",rowSpan:2}),(0,w.jsx)(d.s,{header:"Cadre",rowSpan:2}),(0,w.jsx)(d.s,{header:"Bill Rate",rowSpan:2}),(0,w.jsx)(d.s,{header:"Cost",colSpan:5,style:{textAlign:"center"}}),(0,w.jsx)(d.s,{header:"Verified Date",rowSpan:2})]}),(0,w.jsxs)(N.X,{children:[(0,w.jsx)(d.s,{header:"Avg Cost/Hr",field:"projectName",title:"projectName"}),(0,w.jsx)(d.s,{header:"CompletedCost",field:"prjStartDate"}),(0,w.jsx)(d.s,{header:"Start Month",field:"customer"}),(0,w.jsx)(d.s,{header:"End Month",field:"prjStatus"}),(0,w.jsx)(d.s,{header:"Verified By",field:"reviewType"})]})]});console.log(W);var De=function(){var e=Ne.global?Ne.global.value:"";return(0,w.jsxs)(w.Fragment,{children:[" ",(0,w.jsx)("div",{className:"flex  flex-row-reverse",children:(0,w.jsxs)("span",{className:"p-input-icon-left",children:[(0,w.jsx)("i",{className:"pi pi-search"}),(0,w.jsx)(j.o,{type:"search",style:{float:"right"},value:e||"",onChange:function(e){return function(e){var n=e.target.value,l=(0,t.Z)({},Ne);l.global.value=n,Se(l)}(e)},placeholder:"Global Search"})]})})]})}(),Te=localStorage.getItem("resId"),Re=function(e){h()({method:"post",url:J+"/administrationms/roleCosts/getviewDetails",data:{Country:ce.country,Bu:ce.resBusinessUnit,loggedUser:Te,RoleTypeId:0,history:!1},headers:{"Content-Type":"application/json"}}).then((function(e){console.log(e+"in line 224............");var n=e.data.tableData;console.log(n);var l=e.data;console.log(e.data+"in line 228................."),console.log(l+".......fdata");var o=l.columns.split(",");console.log(o+".......columnsArray"),l.columns=o.join(","),console.log(l.columns+"........... fdataColumns"),l.tableData.forEach((function(e){for(var n in e)null===e[n]&&(e[n]=0)})),pe(n),console.log(n),je(l),console.log(xe)})).then((function(e){console.log(e)}))};console.log(xe),(0,i.useEffect)((function(){Re()}),[]),console.log(null===H||void 0===H?void 0:H.endDate);var Me=H.map((function(e){return e.endDate}));return Me.every((function(e){return null===e})),console.log(Me.length),console.log(null==Me),(0,w.jsxs)("div",{className:"group mb-5 customCard",children:[(0,w.jsxs)("div",{className:"col-md-12 collapseHeader",children:[(0,w.jsx)("h2",{children:"Search Filters"}),(0,w.jsx)("div",{onClick:function(){C(!S),m(S?D.UdN:D.NR5)},children:(0,w.jsx)("span",{children:l})})]}),(0,w.jsx)(T.V9,{visible:!S,setVisible:"false",children:(0,w.jsxs)("div",{className:"group-content row",children:[(0,w.jsx)("div",{className:" col-md-3 mb-2",children:(0,w.jsxs)("div",{className:"form-group row",children:[(0,w.jsxs)("label",{className:"col-5",htmlFor:"resType",children:["Action\xa0",(0,w.jsx)("span",{className:"error-text",children:"*"})]}),(0,w.jsx)("span",{className:"col-1 p-0",children:":"}),(0,w.jsx)("div",{className:"col-6",children:(0,w.jsxs)("select",{id:"action",onChange:function(e){$(!1),de((function(n){return(0,t.Z)((0,t.Z)({},n),{},(0,o.Z)({},"action",e.target.value))}))},children:[(0,w.jsx)("option",{value:"view",children:"Role-View"}),(0,w.jsx)("option",{value:"resview",children:"Resource-View"})]})})]})}),(0,w.jsx)("div",{class:"col-md-3 mb-2",children:(0,w.jsxs)("div",{class:"form-group row",children:[(0,w.jsxs)("label",{class:"col-5",for:"BuIds",children:["Res.Location ",(0,w.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,w.jsx)("span",{class:"col-1 p-0",children:":"}),(0,w.jsxs)("div",{class:"col-6",children:[" ",(0,w.jsx)("select",{id:"country",onChange:function(e){var n=e.target.options[e.target.selectedIndex].text;console.log("Selected Country Name:",n),de((function(l){var s;return(0,t.Z)((0,t.Z)({},l),{},(s={},(0,o.Z)(s,"country",e.target.value),(0,o.Z)(s,"countryName",n),s))}))},style:{width:"100%"},children:A.map((function(e){return(0,w.jsx)("option",{value:e.id,selected:"India"===e.countryName,children:e.countryName},e.id)}))})]})]})}),(0,w.jsx)("div",{className:" col-md-3 mb-2",children:(0,w.jsxs)("div",{className:"form-group row",children:[(0,w.jsxs)("label",{className:"col-5",htmlFor:"resBusinessUnit",children:["Business Unit\xa0",(0,w.jsx)("span",{className:"error-text",children:"*"})]}),(0,w.jsx)("span",{className:"col-1 p-0",children:":"}),(0,w.jsx)("div",{className:"col-6 multiselect",children:(0,w.jsx)(c.NU,{id:"resBusinessUnit",ArrowRenderer:function(e){e.expanded;return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(D.qL$,{className:"chevronIcon"})})},options:P,hasSelectAll:!0,disableSearch:!1,value:Y,valueRenderer:function(e,n){var l=e.map((function(e){return e.value})),o=n.map((function(e){return e.value}));return l.length===o.length?"<< ALL >>":e.map((function(e){return e.label})).join(", ")},disabled:!1,onChange:function(e){V(e);var n=[];null===e||void 0===e||e.forEach((function(e){n.push(e.value)})),de((function(e){return(0,t.Z)((0,t.Z)({},e),{},(0,o.Z)({},"resBusinessUnit",n.toString()))}))}})})]})}),"resview"==ce.action&&(0,w.jsx)("div",{className:" col-md-3 mb-2",children:(0,w.jsxs)("div",{className:"form-group row",children:[(0,w.jsxs)("label",{className:"col-5",children:["Month\xa0",(0,w.jsx)("span",{className:"error-text",children:" *"})]}),(0,w.jsx)("span",{className:"col-1 p-0",children:":"}),(0,w.jsx)("div",{className:"col-6",children:(0,w.jsx)("div",{className:"datepicker",children:(0,w.jsx)(p(),{name:"month",id:"month",selected:oe,maxDate:oe,minDate:se,onChange:function(e){de((function(n){return(0,t.Z)((0,t.Z)({},n),{},(0,o.Z)({},"month",g()(e).format("yyyy-MM-DD")))}))},dateFormat:"MMM-yyyy",showMonthYearPicker:!0,placeholderText:"Start Month",onKeyDown:function(e){e.preventDefault()},autoComplete:"off"})})})]})}),(0,w.jsx)("div",{className:"col-md-12 col-sm-12 col-xs-12  btn-container center my-0",children:(0,w.jsxs)("button",{type:"submit",className:"btn btn-primary",title:"Search",onClick:function(){return Re(),$(!0),void("resview"==ce.action&&Ce())},children:[(0,w.jsx)(D.U41,{}),"Search"," "]})})]})}),1==Q&&"resview"==ce.action?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{children:(0,w.jsxs)("h2",{className:" col-md-12 mt-4 align center",children:["Role Costs for ",ce.countryName]})}),(0,w.jsx)("div",{className:"darkHeader",children:(0,w.jsxs)(x.w,{paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"{first} to {last} of {totalRecords}",rowsPerPageOptions:[10,25,50],className:"primeReactDataTable invoicingSearchTable   customerEngament",value:H,paginator:!0,rows:10,header:De,filters:Ne,onFilter:function(e){return Se(e.filters)},selection:W,onSelectionChange:function(e){return G(e.value)},selectionMode:"single",dataKey:"id",showGridlines:!0,stateStorage:"session",stateKey:"dt-state-demo-local",emptyMessage:"No Records To View.",tableStyle:{minWidth:"50rem"},headerColumnGroup:Ze,children:[(0,w.jsx)(d.s,{field:"product",body:function(e){console.log(e);var n=null;return n=null==e.Cost&&null==e.ComptedCost?(0,w.jsx)("div",{className:"legendContainer align center",children:(0,w.jsx)("div",{className:"legend black",children:(0,w.jsx)("div",{className:"legendCircle",title:"Old Cost",children:(0,w.jsx)("div",{className:"legendTxt"})})})}):(0,w.jsx)("div",{className:"legendContainer align center",children:(0,w.jsx)("div",{className:"legend red",children:(0,w.jsx)("div",{className:"legendCircle",title:"Unverified",children:(0,w.jsx)("div",{className:"legendTxt"})})})}),(0,w.jsx)("div",{className:"ellipsis",children:n})},style:{width:"50rem"}}),(0,w.jsx)(d.s,{field:"Resource Name"}),(0,w.jsx)(d.s,{field:"Department"}),(0,w.jsx)(d.s,{field:"Role Type"}),(0,w.jsx)(d.s,{field:"Designation"}),(0,w.jsx)(d.s,{field:"Cadre"}),(0,w.jsx)(d.s,{field:"Bill Rate"}),(0,w.jsx)(d.s,{field:"Cost"}),(0,w.jsx)(d.s,{field:"ComptedCost"}),(0,w.jsx)(d.s,{field:"startDate"}),(0,w.jsx)(d.s,{field:"endDate"}),(0,w.jsx)(d.s,{field:"Verified By"}),(0,w.jsx)(d.s,{field:"verifiedDate",visible:null===H||void 0===H?void 0:H.some((function(e){return null!==(null===e||void 0===e?void 0:e.verifiedDate)}))})]})})]}):"",1==Q&&"view"==ce.action&&(0,w.jsx)("div",{children:(0,w.jsx)(Z,{data:xe,formData:ce})})]})}}}]);
//# sourceMappingURL=618.0610c2f7.chunk.js.map