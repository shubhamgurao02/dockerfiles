"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[6814],{66814:function(e,t,r){r.r(t),r.d(t,{default:function(){return D}});var n=r(4942),s=r(1413),a=r(29439),o=r(72426),c=r.n(o),l=r(72791),i=r(59513),d=r.n(i),u=(r(68639),r(36167)),f=r(32125),h=r(78820),m=r(80184);var x=function(e){var t=e.formData,r=e.setFormData,o=e.screenFilters,c=e.searchHandler,i=(e.validator,(0,l.useState)(o)),x=(0,a.Z)(i,2),p=x[0],v=x[1],j=(0,l.useState)(""),b=(0,a.Z)(j,2),_=b[0],g=b[1],y=(0,l.useRef)([]);return(0,l.useEffect)((function(){v(o)}),[o]),(0,m.jsxs)("div",{className:"col-md-12 customCard",children:[_,(0,m.jsxs)("div",{class:"group-content row",children:[(0,m.jsx)("div",{class:"col-md-3 mb-2",children:(0,m.jsxs)("div",{class:"form-group row",children:[(0,m.jsxs)("label",{class:"col-5",for:"BuIds",children:["Screens ",(0,m.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,m.jsx)("span",{class:"col-1 p-0",children:":"}),(0,m.jsxs)("div",{class:"col-6 multiselect",ref:function(e){y.current[0]=e},children:[" ",(0,m.jsx)(u.NU,{id:"screenNames",options:o,className:"",hasSelectAll:!0,valueRenderer:function(e,t){return e.length===p.length?"<< ALL >>":0===e.length?"<< Please Select >>":e.map((function(t){return e.length>1?t.label+",":t.label}))},value:t.screen,disabled:!1,onChange:function(e){v(e),r((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,n.Z)({},"screen",e))}))},labelledBy:"countries"})]})]})}),(0,m.jsx)("div",{class:"col-md-3 mb-2",children:(0,m.jsxs)("div",{class:"form-group row",children:[(0,m.jsx)("label",{class:"col-5",for:"BuIds",children:"From Date"}),(0,m.jsx)("span",{class:"col-1 p-0",children:":"}),(0,m.jsxs)("div",{class:"col-6",children:[" ",(0,m.jsx)(d(),{dateFormat:"dd-MMM-yyyy",selected:t.fromDate,maxDate:t.toDate,showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",onKeyPress:function(e){e.preventDefault()},onChange:function(e){r((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,n.Z)({},"fromDate",e))}))}})]})]})}),(0,m.jsx)("div",{class:"col-md-3 mb-2",children:(0,m.jsxs)("div",{class:"form-group row",children:[(0,m.jsx)("label",{class:"col-5",for:"BuIds",children:"To Date"}),(0,m.jsx)("span",{class:"col-1 p-0",children:":"}),(0,m.jsx)("div",{class:"col-6",children:(0,m.jsx)(d(),{dateFormat:"dd-MMM-yyyy",selected:t.toDate,maxDate:t.toDate,showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",onChange:function(e){r((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,n.Z)({},"toDate",e))}))}})})]})}),(0,m.jsx)("div",{class:"col-md-12 col-sm-12 col-xs-12 btn-container center my-3 mb-2",children:(0,m.jsx)("button",{type:"submit",class:"btn btn-primary",title:"Search",onClick:function(){(0,f.Z)(y)?g((0,m.jsxs)("div",{className:"statusMsg error",children:[(0,m.jsx)(h.CSE,{}),(0,m.jsx)("span",{children:"Please Select Mandatory Fields."})]})):(g(""),c())},children:"Search"})})]})]})},p=r(74569),v=r.n(p),j=r(74165),b=r(15861);var _=function(e){var t=e.loginHistoryData,r=(e.setScreenTracker,e.getResourcesLoginHistory),o=e.resourceLoginHisState,c=e.setResourceLoginHisState,i=(0,l.useState)(null),d=(0,a.Z)(i,2),u=d[0],f=d[1],h=["user_id","resource_name","View_And_Upload","Role_View","Role_Approvals","Role_Grid"],x=["User Id","Resource Name","View And Upload","Role View","Role Approvals","Role Grid"],p=(0,l.useState)(null),v=(0,a.Z)(p,2),_=v[0],g=v[1];(0,l.useEffect)((function(){y()}),[t]),(0,l.useEffect)((function(){Z()}),[_]);var y=function(){var e=(0,b.Z)((0,j.Z)().mark((function e(){var r,n,s;return(0,j.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((null===t||void 0===t?void 0:t.length)>0)){e.next=20;break}r=t[0],n=Object.keys(r),s=0;case 4:if(!(s<n.length)){e.next=17;break}e.t0=n[s],e.next="user_id"===e.t0?8:"resource_name"===e.t0?10:12;break;case 8:return n[s]="User Id",e.abrupt("break",14);case 10:return n[s]="Resource Name",e.abrupt("break",14);case 12:return n[s]=n[s].replaceAll("_"," "),e.abrupt("break",14);case 14:s++,e.next=4;break;case 17:g(n),e.next=21;break;case 20:g(x);case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=h;f((function(){return t.map((function(t,a){if(a>0){var l=[];return e.forEach((function(e,i){void 0!==t[e]&&("user_id"==e||"resource_name"==e?l.push((0,m.jsx)("td",{children:t[e]})):l.push((0,m.jsx)("td",{align:"right",children:(0,m.jsx)("span",{className:"pointerCursor",style:{color:"blue"},onClick:function(){!function(e,t,a,l){if(1==o.state&&o.rowAndColumnIndex==a+""+l)c((function(e){var t;return(0,s.Z)((0,s.Z)({},e),{},(t={},(0,n.Z)(t,"state",!1),(0,n.Z)(t,"rowAndColumnIndex",null),t))}));else{c((function(e){var t;return(0,s.Z)((0,s.Z)({},e),{},(t={},(0,n.Z)(t,"state",!0),(0,n.Z)(t,"rowAndColumnIndex",a+""+l),t))}));var i={screen_name:t,user_id:e.user_id};r(i)}}(t,e,a,i)},children:t[e]})})))})),(0,m.jsx)("tr",{children:l},a)}}))}))};return(0,m.jsx)("div",{className:"col-md-12 mt-2 customCard",children:(0,m.jsx)("table",{style:{width:"100%"},className:"table table-bordered table-striped",children:(0,m.jsxs)("tbody",{children:[(0,m.jsx)("tr",{children:null===_||void 0===_?void 0:_.map((function(e,t){return(0,m.jsx)("th",{children:e},t)}))}),u]})})})},g=(r(85565),r(34831));var y=function(e){var t=e.resourceLogHisData,r=(0,l.useState)(null),n=(0,a.Z)(r,2),s=n[0],o=n[1],i=["ip_address","login_date_and_time"];(0,l.useEffect)((function(){d()}),[t]);var d=function(){o((function(){return null===t||void 0===t?void 0:t.map((function(e,t){var r=[];return i.forEach((function(t,n){"login_date_and_time"===t?r.push((0,m.jsx)("td",{children:c()(e[t]).format("DD-MMM-yyyy HH:mm")})):r.push((0,m.jsx)("td",{children:e[t]}))})),(0,m.jsx)("tr",{children:r},t)}))}))};return(0,m.jsx)("div",{id:"costLoginHistoryData",className:"col-md-12 customCard",children:(0,m.jsx)("table",{className:"table table-bordered table-striped",children:(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{className:"headerSticky",children:[(0,m.jsx)("th",{children:"Ip Address"}),(0,m.jsx)("th",{children:"Login Date And Time"})]}),s]})})})},Z=r(83854);var D=function(){var e=c()().subtract(7,"days")._d,t=c()()._d,r=g.N.baseUrl,o=["user_id","resource_name","View_And_Upload","Role_View","Role_Approvals","Role_Grid"],i={screen:[],fromDate:e,toDate:t},d=(0,l.useState)(i),u=(0,a.Z)(d,2),f=u[0],h=u[1],p=(0,l.useState)([]),j=(0,a.Z)(p,2),b=j[0],D=j[1],S=(0,l.useState)([]),w=(0,a.Z)(S,2),M=w[0],k=w[1],C=(0,l.useState)([]),R=(0,a.Z)(C,2),H=R[0],A=R[1],N=(0,l.useState)({state:!1,rowAndColumnIndex:null}),L=(0,a.Z)(N,2),E=L[0],I=L[1],F=(0,l.useState)(!1),T=(0,a.Z)(F,2),U=T[0],V=(T[1],(0,l.useState)(!1)),P=(0,a.Z)(V,2),B=P[0],G=P[1],O=(0,l.useState)({screen_id:"",user_id:""}),Y=(0,a.Z)(O,2),K=Y[0],q=Y[1];(0,l.useEffect)((function(){z()}),[]),(0,l.useEffect)((function(){J(b)}),[b]),(0,l.useEffect)((function(){}),[K,E]);var z=function(){v()({url:r+"/CostMS/cost/getCostScreenNames"}).then((function(e){D(e.data),h((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,n.Z)({},"screen",e.data))}))}))};(0,l.useEffect)((function(){}),[H,E]),(0,l.useEffect)((function(){}),[M]);var J=function(e){for(var t={},n=void 0===e?f.screen:e,s=[],a=0;a<n.length;a++)s.push(n[a].value);t.screenIds=s.toString(),t.fromDate=c()(f.fromDate).format("yyyy-MM-DD"),t.toDate=c()(f.toDate).format("yyyy-MM-DD"),G(!0),v()({method:"POST",url:r+"/CostMS/cost/getLoginTracks",data:t}).then((function(e){for(var t=e.data,r=[],n=0;n<t.length;n++){for(var s={},a=0;a<o.length;a++)void 0!=t[n][o[a]]&&(s[o[a]]=t[n][o[a]]);r.push(s)}k(r),G(!1)}))};return(0,m.jsxs)("div",{children:[(0,m.jsx)(x,{formData:f,setFormData:h,screenFilters:b,searchHandler:J,validator:U}),B?(0,m.jsx)(Z.Z,{}):"",(0,m.jsx)(_,{loginHistoryData:M,setScreenTracker:q,getResourcesLoginHistory:function(e){v()({method:"POST",url:r+"/CostMS/cost/getResourceLoginHistory",data:e}).then((function(e){A([]),A(e.data)}))},resourceLoginHisState:E,setResourceLoginHisState:I}),E.state&&(0,m.jsx)(y,{resourceLogHisData:H})]})}}}]);
//# sourceMappingURL=6814.83de1224.chunk.js.map