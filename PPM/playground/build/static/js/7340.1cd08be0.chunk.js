"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[7340],{77340:function(e,a,t){t.r(a),t.d(a,{default:function(){return S}});var s=t(4942),n=t(1413),o=t(29439),r=t(72791),c=t(57689),l=t(78983),i=(t(24846),t(74569)),d=t.n(i),u=t(40071),m=t(34831),h=t(7692),g=t(72426),p=t.n(g),f=t(16030),x=t(18907),j=t(99779),v=t(80184),S=function(){var e=m.N.baseUrl,a=(0,r.useState)({userName:"",password:"",inputCaptcha:""}),t=(0,o.Z)(a,2),i=t[0],g=t[1],S=(0,c.s0)(),N=(0,r.useRef)(),C=(0,f.I0)(),I=(0,r.useState)(!1),Z=(0,o.Z)(I,2),y=Z[0],w=Z[1],_=(0,r.useState)(""),b=(0,o.Z)(_,2),k=b[0],L=b[1],M=(0,r.useState)(!1),T=(0,o.Z)(M,2),D=T[0],F=T[1],P=(0,r.useState)(!1),E=(0,o.Z)(P,2),q=E[0],B=E[1],R=(0,r.useState)([]),U=(0,o.Z)(R,2),J=U[0],O=U[1],z=j.ou.local().toFormat("ZZ"),A="UTC".concat(z),H=(0,r.useState)({userName:"",password:"",timeZone:A}),V=(0,o.Z)(H,2),G=V[0],K=V[1];(0,r.useEffect)((function(){if("true"===localStorage.getItem("token")){var e=localStorage.getItem("path");e&&S(e)}}),[]);var Q=function(e){var a=e.id,t=e.value;g((function(e){return(0,n.Z)((0,n.Z)({},e),{},(0,s.Z)({},a,t))})),K((function(e){return(0,n.Z)((0,n.Z)({},e),{},(0,s.Z)({},a,t))}))},W=(0,r.useRef)(null),X=function(){d().get(e+"/LayoutMS/captcha/captcha").then((function(e){var a=e.data.encodedString;O(e.data.code);var t=document.createElement("img");t.src="data:image/png;base64,".concat(a);var s=document.getElementById("captchaImageContainer");s.innerHTML="",s.appendChild(t),W.current&&(W.current.value="")})).catch((function(e){console.error("Error fetching captcha:",e)}))},Y=function(){if(F(!0),q){if(!i.inputCaptcha)return w(!0),L((0,v.jsxs)("div",{className:"statusMsg error",children:[(0,v.jsx)(u.SZZ,{})," ","Please enter the captcha value."]})),void F(!1);if(i.inputCaptcha!==J)return w(!0),L((0,v.jsxs)("div",{className:"statusMsg error",children:[(0,v.jsx)(u.SZZ,{})," ","Please provide valid captcha."]})),X(),B(!0),void F(!1)}d()({method:"post",url:e+"/LayoutMS/auth/login",data:JSON.stringify(i),headers:{"Content-Type":"application/json"}}).then((function(a){var t=a.data.path;!0===a.data.success?(F(!0),d()({method:"post",url:e+"/LayoutMS/auth/getloginCount",data:JSON.stringify(G),headers:{"Content-Type":"application/json"}}).then((function(e){localStorage.setItem("lastUpdatedDt",e.data.last_updated_login_dt),localStorage.setItem("loginCount7Days",e.data.loginCount7Days),localStorage.setItem("loginCount30Days",e.data.loginCount30Days)})),w(!0),L((0,v.jsxs)("div",{className:"statusMsg success",children:[(0,v.jsx)(h.wRn,{size:"1.4em"})," ","Login Successful!"]})),null==t?setTimeout((function(){w(!1),L(""),localStorage.setItem("path","/resource/dashboard"),S("/resource/dashboard")}),1500):setTimeout((function(){w(!1),L(""),localStorage.setItem("path",t),S(t)}),1500),localStorage.setItem("expiry",Date.now()+18e5),localStorage.setItem("resId",a.data.id),localStorage.setItem("resName",a.data.resourceName),localStorage.setItem("token",a.data.success),localStorage.setItem("jwtToken",a.data.jwtToken),function(){if(void 0==localStorage.getItem("expireTime")){var e=p()().add(20,"minutes");localStorage.setItem("expireTime",e),localStorage.setItem("loggedIn",!0)}}(),C((0,x.q9)())):(w(!0),F(!1),L((0,v.jsxs)("div",{className:"statusMsg error",children:[(0,v.jsx)(u.SZZ,{})," ","Incorrect Credentials!"]})),X(),B(!0))})).catch((function(e){w(!0),L((0,v.jsxs)("div",{className:"statusMsg error",children:[(0,v.jsx)(u.SZZ,{})," ","Login Failed!"]}))})),F(!1)};return(0,v.jsxs)("div",{className:"loginContainer",children:[(0,v.jsx)("div",{className:"leftContent",children:(0,v.jsx)("div",{className:"loginImg"})}),(0,v.jsx)("div",{className:"rightContent",children:(0,v.jsxs)("div",{className:"formArea",children:[(0,v.jsx)("img",{ref:N,src:"ppm-logo-dark.svg",className:"loginLogo",alt:"PPM Logo"}),(0,v.jsxs)(l.lx,{children:[(0,v.jsx)("h1",{className:"mb-1",children:"Login"}),(0,v.jsx)("p",{className:"mb-3",children:"Sign In to your account"}),y?(0,v.jsx)("div",{children:k}):"",(0,v.jsxs)("div",{className:"mb-3",children:[(0,v.jsx)("label",{htmlFor:"password",children:"Email address"}),(0,v.jsx)("input",{id:"userName",type:"email",className:"form-control ",placeholder:"name@example.com",required:!0,onChange:function(e){Q(e.target)}})]}),(0,v.jsxs)("div",{className:"",children:[(0,v.jsx)("label",{htmlFor:"password",children:"Password"}),(0,v.jsx)("input",{type:"password",className:"form-control ",id:"password",placeholder:"Password",required:!0,onChange:function(e){Q(e.target)}})]}),q&&(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col-md-6",children:(0,v.jsxs)("div",{className:"mt-2",children:[(0,v.jsx)("label",{htmlFor:"captcha",children:"Captcha"}),(0,v.jsx)("input",{type:"text",className:"form-control",id:"inputCaptcha",placeholder:"Captcha Value",required:!0,onChange:function(e){Q(e.target)},ref:W})]})}),(0,v.jsx)("div",{className:"col-md-2 mt-5",id:"captchaImageContainer"})]}),(0,v.jsx)("div",{className:"mt-3 reloadLink",children:(0,v.jsx)("a",{href:"#",onClick:X,children:"Reload Captcha Image"})})]}),(0,v.jsx)(l.u5,{className:D?"disableField loginBtn mt-4":"loginBtn mt-4",id:"loginButton",disabled:D,style:{cursor:D?"not-allowed":""},onClick:function(){F(!0),Y()},children:"Login"})]})]})})]})}}}]);
//# sourceMappingURL=7340.1cd08be0.chunk.js.map