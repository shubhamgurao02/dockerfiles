"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[1858],{31858:function(e,t,n){n.r(t),n.d(t,{default:function(){return q}});var l=n(93433),a=n(74165),s=n(4942),o=n(15861),i=n(1413),r=n(29439),c=n(72791),d=n(36167),u=n(56355),m=n(59513),p=n.n(m),h=(n(68639),n(78983)),f=n(63521),v=n(74569),x=n.n(v),g=n(83854),j=n(34831),b=n(72426),y=n.n(b),N=n(1063),Z=(n(224),n(25415)),S=n.n(Z),C=(n(47477),n(11683)),w=n(13400),_=n(11087),I=n(40071),P=n(49177),T=n(34911),R=n(56637),D=n(53824),k=n(48462),A=n(59170),E=n(87890),M=n(37145),F=(n(41980),n(39122),n(31896),n(81975),n(25103)),V=(n(17153),n(50919),n(35125)),O=n(80184);n(31052);var U=function(e){var t=e.data,l=e.rows,a=(e.col,e.headerdatagroup,e.linkColumns,e.linkColumnsRoutes,e.dynamicColumns),s=e.headerData,o=e.setHeaderData,d=e.exportData,u=e.customFilters,m=e.customFilterValue,p=e.setCustomFilterValue,h=(0,c.useState)([]),f=(0,r.Z)(h,2),v=f[0],x=f[1],g=(0,c.useState)([]),j=(0,r.Z)(g,2),b=j[0],y=j[1],N=(0,c.useState)([]),Z=(0,r.Z)(N,2),S=Z[0],C=Z[1],w=(0,c.useRef)(null);(0,c.useEffect)((function(){x(JSON.parse(JSON.stringify(t)))}),[t]),(0,c.useEffect)((function(){if(v.length>0){o(v[0]),y(v.splice(1));var e=[],t=v[0];Object.keys(t).forEach((function(n){"StatusId"!=n&&e.push({title:t[n],dataKey:n})})),C(e)}}),[v]);var _={contains:{value:null,matchMode:E.a6.CONTAINS}},I=(0,c.useState)({global:_.contains}),P=(0,r.Z)(I,2),T=P[0],R=P[1];(0,c.useEffect)((function(){R({global:_.contains})}),[s]);var D=(0,c.useState)(""),k=(0,r.Z)(D,2),A=k[0],U=k[1],B=function(e){var t=e.target.value,n=(0,i.Z)({},T);n.global.value=t,R(n),U(t)},H=function(){var e=u;if("select"===e.type)return(0,O.jsx)("select",{id:e.id,onChange:function(e){p(e.target.value)},children:Object.keys(e.data).map((function(t){return(0,O.jsx)("option",{selected:m==t,value:t,children:e.data[t]})}))})},L=function(){Promise.resolve().then(n.bind(n,34045)).then((function(e){for(var l=Object.keys(t[0]),a=[],s=JSON.parse(JSON.stringify(t)).slice(1),o=function(e){var n={};Object.keys(t[e]).forEach((function(a){l.includes(a)&&(n[t[0][a]]=t[e][a])})),a.push(n)},i=0;i<s.length;i++)o(i);var r,c,d={Sheets:{data:e.utils.json_to_sheet(a.slice(1))},SheetNames:["data"]},u=e.write(d,{bookType:"xlsx",type:"array"});r=u,c="data",Promise.resolve().then(n.t.bind(n,64802,23)).then((function(e){if(e&&e.default){var t=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});e.default.saveAs(t,c+".xlsx")}}))}))},W=function(){z()},z=function(){for(var e=new V.default("p","pt","a4"),n=S.map((function(e){return e.title})),l=[],a=function(e){var n=S.map((function(n){return t[e][n.dataKey]}));l.push(n)},s=0;s<t.length;s++)a(s);e.text(235,40,"Tabla de Prestamo"),e.autoTable(n,l,{startY:65,theme:"grid",styles:{font:"times",halign:"center",cellPadding:3.5,lineWidth:.5,lineColor:[0,0,0],textColor:[0,0,0]},headStyles:{textColor:[0,0,0],fontStyle:"normal",lineWidth:.5,lineColor:[0,0,0],fillColor:[166,204,247]},alternateRowStyles:{fillColor:[212,212,212],textColor:[0,0,0],lineWidth:.5,lineColor:[0,0,0]},rowStyles:{lineWidth:.5,lineColor:[0,0,0]},tableLineColor:[0,0,0]}),e.save("pdf")},K=(0,O.jsxs)("div",{className:"flex  flex-row-reverse",children:[void 0!=u&&(0,O.jsx)("span",{children:(0,O.jsx)(H,{})}),(0,O.jsxs)("div",{className:"exportBtn ml-3",children:[(null===d||void 0===d?void 0:d.includes("CSV"))&&(0,O.jsx)("span",{className:"pi pi-file csv",onClick:function(){return e=!1,void w.current.exportCSV({selectionOnly:e});var e},title:"CSV"}),(null===d||void 0===d?void 0:d.includes("XLS"))&&(0,O.jsx)("span",{className:"pi pi-file-excel excel",onClick:L,title:"Export to Excel"}),(null===d||void 0===d?void 0:d.includes("PDF"))&&(0,O.jsx)("span",{className:"pi pi-file-pdf pdf",onClick:W,title:"PDF"})]}),(0,O.jsxs)("span",{className:"p-input-icon-left tableGsearch",children:[(0,O.jsx)("i",{className:"pi pi-search"}),(0,O.jsx)(F.o,{defaultValue:A,onChange:B,placeholder:"Keyword Search"})]})]});return(0,O.jsx)("div",{className:"darkHeader",children:Object.keys(s).length>0&&(0,O.jsx)(M.w,{stripedRows:!0,paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",currentPageReportTemplate:"{first} to {last} of {totalRecords}",rowsPerPageOptions:[5,10,25,50],value:b,paginator:!0,showGridlines:!0,rows:l,dataKey:"id",filters:T,responsiveLayout:"scroll",header:K,emptyMessage:"No Records found.",ref:function(e){w.current=e},className:"primeReactDataTable AllocationDashboardActionTable",children:a})})};var B=function(e){var t,n=e.openPopup,a=e.setOpenPopup,s=e.resid,o=e.resName,i=(0,c.useState)([]),d=(0,r.Z)(i,2),u=d[0],m=d[1],p=(0,c.useState)([]),f=(0,r.Z)(p,2),v=f[0],g=f[1],b=j.N.baseUrl;(0,c.useEffect)((function(){T()}),[]);var Z=function(e){return(0,O.jsx)("div",{className:"dashboardAllocationTable ",children:(0,O.jsx)("div",{className:"ellipsis",style:{textAlign:"left",maxWidth:"400px",fontSize:"13px"},"data-toggle":"tooltip",title:e.comments,children:e.comments})})},S=function(e){return(0,O.jsx)("div",{className:"dashboardAllocationTable mr-0",children:(0,O.jsx)("div",{className:"date",style:{textAlign:"center"},"data-toggle":"tooltip",title:e.created_dt,children:e.created_dt})})},C=function(e){return(0,O.jsx)("div",{className:"dashboardAllocationTable mr-0",children:(0,O.jsx)("div",{className:"date",style:{textAlign:"center"},"data-toggle":"tooltip",title:e.effective_dt,children:e.effective_dt})})},w=function(e){return(0,O.jsx)("div",{className:"dashboardAllocationTable mr-0",children:(0,O.jsx)("div",{className:"date",style:{textAlign:"center"},"data-toggle":"tooltip",title:e.completed_dt,children:e.completed_dt})})},_=function(e){return(0,O.jsx)("div",{className:"dashboardAllocationTable ",children:(0,O.jsx)("div",{className:"ellipsis",style:{textAlign:"left",maxWidth:"400px",fontSize:"13px"},"data-toggle":"tooltip",title:e.entryby,children:e.entryby})})},I=function(e){return(0,O.jsx)("div",{className:"dashboardAllocationTable ",children:(0,O.jsx)("div",{className:"ellipsis",style:{textAlign:"left",maxWidth:"400px",fontSize:"13px"},"data-toggle":"tooltip",title:e.lkup_name,children:e.lkup_name})})},P=null===(t=Object.keys(v))||void 0===t?void 0:t.map((function(e,t){return(0,O.jsx)(N.s,{sortable:!0,body:"comments"==e?Z:"created_dt"==e?S:"effective_dt"==e?C:"completed_dt"==e?w:"entryby"==e?_:"lkup_name"==e&&I,field:e,header:v[e]},e)}));(0,c.useEffect)((function(){u[0]&&g(JSON.parse(JSON.stringify(u[0])))}),[u]);var T=function(){x()({method:"get",url:b+"/dashboardsms/allocationDashboard/getActionItemDetails?rid=".concat(s)}).then((function(e){for(var t=e.data,n=0;n<t.length;n++)t[n].created_dt=null==t[n].created_dt?"":y()(t[n].created_dt).format("DD-MMM-yyyy"),t[n].completed_dt=null==t[n].completed_dt?"":y()(t[n].completed_dt).format("DD-MMM-yyyy"),t[n].effective_dt=null==t[n].effective_dt?"":y()(t[n].effective_dt).format("DD-MMM-yyyy");var a=[].concat([{created_dt:"Entry Dt",entryby:"Entry By",lkup_name:"Category",effective_dt:"Effective Dt",completed_dt:"Completed Dt",comments:"Comments"}],(0,l.Z)(t));m(a)}))};return(0,O.jsx)("div",{children:(0,O.jsxs)(h.Tk,{visible:n,size:"xl",className:"ui-dialog",onClose:function(){return a(!1)},backdrop:"static",children:[(0,O.jsx)(h.p0,{className:"",children:(0,O.jsx)(h.fl,{children:(0,O.jsxs)("span",{className:"",children:["Action Items of ",o]})})}),(0,O.jsx)(h.sD,{children:(0,O.jsx)(U,{data:u,rows:5,dynamicColumns:P,headerData:v,setHeaderData:g})})]})})},H=n(7692);function L(e){var t=e.data,n=e.expandedCols,a=e.colExpandState,o=e.viewBy,d=(0,c.useState)([]),u=(0,r.Z)(d,2),m=u[0],p=u[1],h=(0,c.useState)(null),f=(0,r.Z)(h,2),v=f[0],x=f[1],g=(0,c.useState)({}),j=(0,r.Z)(g,2),b=j[0],y=j[1],N=(0,c.useState)(!1),Z=(0,r.Z)(N,2),S=Z[0],E=Z[1],M=(0,c.useState)([]),F=(0,r.Z)(M,2),V=F[0],U=F[1],L=(0,c.useState)([]),W=(0,r.Z)(L,2),z=(W[0],W[1],(0,c.useState)(!1)),K=(0,r.Z)(z,2),J=K[0],G=K[1],q=(0,c.useState)(),Y=(0,r.Z)(q,2),$=Y[0],X=Y[1],Q=(0,c.useState)(),ee=(0,r.Z)(Q,2),te=ee[0],ne=ee[1],le={fte0:(0,O.jsx)("img",{src:T,alt:"(fte_inactive_icon)",style:{height:"12px"},title:"Ex-Employee"}),fte1:(0,O.jsx)("img",{src:P,alt:"(fte_active_icon)",style:{height:"12px"},title:"Active Employee"}),fte2:(0,O.jsx)("img",{src:R,alt:"(fte_notice_icon)",style:{height:"12px"},title:"Employee in notice period"}),subk0:(0,O.jsx)("img",{src:k,alt:"(subk_inactive_icon)",style:{height:"12px"},title:"Ex-Contractor"}),subk1:(0,O.jsx)("img",{src:D,alt:"(subk_active_icon)",style:{height:"12px"},title:"Active Contractor"}),subk2:(0,O.jsx)("img",{src:A,alt:"(subk_notice_icon)",style:{height:"12px"},title:"Contractor in notice period"})};(0,c.useEffect)((function(){ae()}),[t]);var ae=function(){var e,l,i,c,d,u,m,h=null===(e=t[1])||void 0===e?void 0:e.tableData,f=null;null!==(l=t[0])&&void 0!==l&&null!==(i=l.columns)&&void 0!==i&&i.includes("'")?f=null===(d=t[0])||void 0===d||null===(u=d.columns)||void 0===u?void 0:u.replaceAll("'",""):f=null===(m=t[0])||void 0===m?void 0:m.columns;for(var v=null===(c=f)||void 0===c?void 0:c.split(","),g=[],j=[],b={},N=0;N<(null===v||void 0===v?void 0:v.length);N++){var Z=v[N].trim(),C=h[0];b[Z]=C[Z]}var P=Object.entries(b),T=P.filter((function(e){var t=(0,r.Z)(e,2),n=t[0];t[1];return n.includes("total")}))[0];console.log(P,"headerArray");var R=P.filter((function(e){var t=(0,r.Z)(e,2),n=t[0],l=t[1];return"string"===typeof l&&l.includes("^&")&&!n.includes("others")&&!n.includes("nBillUtil")&&!n.includes("billUtil")&&!n.includes("innov")}));console.log(R,"");var D=R.length-1;if(R.length>2&&R.splice(D,0,T),"bu"==o){var k=R.findIndex((function(e){var t=(0,r.Z)(e,2),n=t[0];t[1];return n.includes("total")}));if(-1!==k){var A=R.splice(k,1)[0];R.push(A)}}console.log(R,"filteredHeaders"),U(R),R.map((function(e){var t=(0,r.Z)(e,2),l=t[0];t[1];n.includes(l)&&j.push((0,s.Z)({},l,!1))})),console.log(D,R,"filteredHeaders"),y(Object.assign.apply(Object,[{}].concat(j)));var M=null===h||void 0===h?void 0:h.filter((function(e){return-1===e.id}));R.map((function(e,t){var n=(0,r.Z)(e,2),l=n[0],s=n[1];g.push({accessorKey:l.includes("total")?"total":l.lastIndexOf("_")>=7?l.split("_")[0]+"_"+l.split("_")[1]+"_"+l.split("_")[2]:l.includes("action")?"action":l,header:s.split("^&")[0],enableColumnActions:!1,enableHiding:!0,Header:function(e){e.column;return(0,O.jsxs)("div",{className:l.includes("empId")||l.includes("name")?"mixer":l.includes("emp_cadre")?"sm mixer":(l.includes("department")?"md mixer":"")||(l.includes("supervisor")?"md mixer":""),title:s.split("^&")[0],children:[s.split("^&")[0]," ",l==a[2]&&"bu"!=o?(0,O.jsx)(w.Z,{className:"expandIcon",onClick:function(){E((function(e){return!e}))},style:{color:"black"},children:S?(0,O.jsx)(H.gbs,{}):(0,O.jsx)(H.lU2,{})}):null]})}})}));var F=M?Object.entries(M[0]):null;null===F||void 0===F||F.sort(),g.map((function(e){var t=g.indexOf(e),n=[];F.map((function(l,a){var s=(0,r.Z)(l,2),i=s[0],c=s[1];if(i.includes("greyout")||null==c||"id"==i){if(i==e.accessorKey){var d={id:i,header:(0,O.jsxs)("div",{className:i.includes("supervisor")||i.includes("department")?"md":"sm",children:[" ",c]}),accessorKey:i,Cell:function(e){var t=e.cell;return(0,O.jsx)("div",{className:i.includes("emp_cadre")?"sm":i.includes("department")||i.includes("supervisor")?"md":"Total"==t.row.original.name?"rowTotal":"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:t.getValue(),children:"bu"!=o&&"name"==t.column.id&&"Total"!=t.getValue()&&null!=t.row.original?(0,O.jsxs)("div",{className:"openTable",children:[le[t.row.original.empStatus],(0,O.jsx)(_.rU,{className:"empName ellipsis",title:t.getValue(),to:"/resource/profile/:".concat(t.row.original.id),target:"_blank",children:t.getValue()}),""!=t.row.original.actionDate&&(0,O.jsx)(I.SZZ,{title:"Show Action Items",onClick:function(){G(!0),ne(t.row.original.id),X(t.row.original.name)},style:{color:"orange",cursor:"pointer"}})]}):(0,O.jsxs)("div",{className:"bu"==o&&"name"==t.column.id?"businessUnit":"empId"==t.column.id?"ellipsis":"",children:[t.getValue(),console.log(t.getValue(),t.column.id,"in link line 438")]})})}};g[t].columns=[d]}}else if(i.includes(e.accessorKey)&&i!==e.accessorKey){var u={id:i,header:(0,O.jsx)("div",{className:i.includes("department")?"md":"sm",children:c}),accessorKey:i,Cell:function(e){var t=e.cell;return(0,O.jsx)("div",{className:i.includes("_")?"total"==i.split("_")[0]?"sm total":i.split("_")[1][1]%2==0?"sm even":"sm odd":i.includes("emp_cadre")?"sm mixer":"Total"==t.row.original.name?"rowTotal":"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:t.getValue(),children:"bu"!=o&&"name"==t.column.id&&null!=t.row.original?(0,O.jsxs)("div",{className:"openTable",children:[le[t.row.original.empStatus],(0,O.jsx)(_.rU,{title:t.getValue(),to:"/resource/profile/:".concat(t.row.original.id),target:"_blank",className:"ellipsis",style:{textDecoration:"underline"},children:t.getValue()}),""!=t.row.original.actionDate&&(0,O.jsx)(I.SZZ,{title:"Show Action Items",onClick:function(){G(!0),ne(t.row.original.id),X(t.row.original.name)},style:{color:"orange",cursor:"pointer"}}),console.log(t.getValue(),"in link")]}):(0,O.jsx)("div",{className:"bu"==o&&"name"==t.column.id?"businessUnit":"actionComments"==t.column.id?"ellipsis":"",children:t.getValue()})})}};n.push(u),g[t].columns=n}}))})),x(g);var V=[];null===h||void 0===h||h.map((function(e){return-1!==e.id&&-2!==e.id?V.push(e):""})),p(oe(V,{children:"subRows"}))};(0,c.useEffect)((function(){ae(),S?y({}):se()}),[S]);var se=function(){var e=[];V.map((function(t){var l=(0,r.Z)(t,2),a=l[0];l[1];n.includes(a)&&e.push((0,s.Z)({},a,!1))})),y(Object.assign.apply(Object,[{}].concat(e)))},oe=function(e,t){t=(0,i.Z)({id:"id",parentId:"parentId",children:"subRows"},t);var n={},a=[],o=t.children;return e.forEach((function(e){var l=e[t.id],a=e[t.parentId];n[l]=(0,i.Z)((0,i.Z)((0,s.Z)({},o,[]),e),n[l]),n[a]=n[a]||(0,s.Z)({},o,[]),n[a][o].push(n[l])})),Object.values(n).forEach((function(e){"undefined"===typeof e[t.id]&&a.push.apply(a,(0,l.Z)(e[o]))})),a};return(0,O.jsxs)("div",{className:"bu"==o?"materialReactExpandableTable businessUnitTable darkHeader toHead":"materialReactExpandableTable dashboardAllocationTable darkHeader toHead",children:[null!==v&&void 0!==v&&v.length?(0,O.jsx)(C.ZP,{columns:v,data:m,enableExpandAll:!1,enableExpanding:!1,enablePagination:!1,enableRowVirtualization:!0,enableFullScreenToggle:!1,enableDensityToggle:!1,enableHiding:!1,enableGlobalFilter:!0,enableBottomToolbar:!1,enableTopToolbar:!0,enableColumnActions:!1,enablePinning:!1,enableColumnFilters:!1,enableSorting:!0,filterFromLeafRows:!0,initialState:{showGlobalFilter:!0,expanded:!1,density:"compact",columnVisibility:(0,i.Z)({},b),columnPinning:{left:["empId","name"]}},state:{columnVisibility:(0,i.Z)({},b),showProgressBars:!1},paginateExpandedRows:!1,defaultColumn:{minSize:40,maxSize:80,size:45},muiSearchTextFieldProps:{variant:"outlined"},muiTableContainerProps:{sx:{width:"auto",maxWidth:"fit-content",maxHeight:"65vh"}},muiTableBodyProps:{sx:{"&":{borderRight:"1px solid #ccc",borderBottom:"1px solid #ccc"},"& td:first-of-type":{borderLeft:"1px solid #ccc",minWidth:"100px"},"& td":{borderRight:"1px solid #ccc",height:"22px",padding:"0px 5px",maxWidth:"150px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",padding:"0 5px"},"& th:first-of-type":{borderLeft:"1px solid #ccc",minWidth:"100px"}}}}):null,J&&(0,O.jsx)(B,{openPopup:J,setOpenPopup:G,resid:te,resName:$})]})}var W=n(78820),z=n(32125),K=n(17425),J=n(72920),G=n(38262);var q=function(){var e=(0,c.useState)(!1),t=(0,r.Z)(e,2),n=t[0],m=t[1],v=(0,c.useState)(!1),b=(0,r.Z)(v,2),N=(b[0],b[1],(0,c.useState)([])),Z=(0,r.Z)(N,2),C=Z[0],w=(Z[1],(0,c.useState)(!1)),_=(0,r.Z)(w,2),P=_[0],T=_[1],R=(0,c.useState)(),D=(0,r.Z)(R,2),k=(D[0],D[1]),A=(0,c.useState)(u.UdN),E=(0,r.Z)(A,2),M=E[0],F=E[1],V=(0,c.useState)([]),U=(0,r.Z)(V,2),B=U[0],H=U[1],q=(0,c.useState)([]),Y=(0,r.Z)(q,2),$=Y[0],X=Y[1],Q=(0,c.useState)(46==$?"project":690==$?"customer":126==$&&"bu"),ee=(0,r.Z)(Q,2),te=ee[0],ne=ee[1],le=(0,c.useState)("-1"),ae=(0,r.Z)(le,2),se=ae[0],oe=ae[1],ie=(0,c.useState)(!1),re=(0,r.Z)(ie,2),ce=re[0],de=re[1],ue=(0,c.useState)([]),me=(0,r.Z)(ue,2),pe=me[0],he=me[1],fe=(0,c.useState)([{value:"bill",label:"Billable Utilization"},{value:"nBill",label:"Non-Billable Utilization"},{value:"innovation",label:"Innovation"},{value:"others",label:"Others"}]),ve=(0,r.Z)(fe,2),xe=ve[0],ge=(ve[1],(0,c.useState)([])),je=(0,r.Z)(ge,2),be=je[0],ye=je[1],Ne=(0,c.useState)([]),Ze=(0,r.Z)(Ne,2),Se=Ze[0],Ce=Ze[1],we=(0,c.useState)(xe),_e=(0,r.Z)(we,2),Ie=_e[0],Pe=_e[1],Te=(0,c.useState)([]),Re=(0,r.Z)(Te,2),De=(Re[0],Re[1]),ke=(0,c.useState)(new Date),Ae=(0,r.Z)(ke,2),Ee=Ae[0],Me=Ae[1],Fe=(0,c.useState)([]),Ve=(0,r.Z)(Fe,2),Oe=Ve[0],Ue=Ve[1],Be=(0,c.useState)([]),He=(0,r.Z)(Be,2),Le=He[0],We=He[1],ze=(0,c.useState)([]),Ke=(0,r.Z)(ze,2),Je=Ke[0],Ge=Ke[1],qe=(0,c.useState)([]),Ye=(0,r.Z)(qe,2),$e=Ye[0],Xe=Ye[1],Qe=(0,c.useState)([]),et=(0,r.Z)(Qe,2),tt=et[0],nt=et[1],lt=(0,c.useState)(!1),at=(0,r.Z)(lt,2),st=at[0],ot=at[1],it=(0,c.useState)(!1),rt=(0,r.Z)(it,2),ct=rt[0],dt=rt[1],ut=(0,c.useState)([]),mt=(0,r.Z)(ut,2),pt=mt[0],ht=mt[1],ft=(0,c.useState)([]),vt=(0,r.Z)(ft,2),xt=vt[0],gt=vt[1],jt=(0,c.useState)([]),bt=(0,r.Z)(jt,2),yt=(bt[0],bt[1],(0,c.useRef)([])),Nt=(0,c.useRef)(null),Zt=j.N.baseUrl,St=(0,c.useState)([]),Ct=(0,r.Z)(St,2),wt=Ct[0],_t=Ct[1];console.log(te);var It=(0,c.useState)(""),Pt=(0,r.Z)(It,2),Tt=Pt[0],Rt=Pt[1],Dt=new Date,kt=Dt.getFullYear(),At=Dt.getMonth()+1,Et=new Date(kt,At-1,1),Mt={type:46==$?"project":"customer",buId:"",countryIds:"",resType:"-1",month:y()(Et.toDateString()).format("yyyy-MM-DD"),duration:"3",customerId:"-1",projectId:"-1",resourceId:"-1",pmId:"-1",measures:"bill,nBill,innovation,others",filterMeasure:"-1",operator:"ge",filterVal:"-1",viewType:"resource"};console.log($);var Ft=(0,c.useState)(Mt),Vt=(0,r.Z)(Ft,2),Ot=Vt[0],Ut=Vt[1],Bt=localStorage.getItem("resId"),Ht=(0,c.useState)([]),Lt=(0,r.Z)(Ht,2),Wt=Lt[0],zt=Lt[1];(0,c.useEffect)((function(){Jt(),Gt(),Yt(),$t()}),[]),(0,c.useEffect)((function(){Kt()}),[$]),(0,c.useEffect)((function(){}),[C]);var Kt=function(){x()({method:"GET",url:Zt+"/CommonMS/master/getMenus?loggedUserId=".concat(Bt)}).then((function(e){var t=e.data;t.forEach((function(e){"Dashboards"===e.display_name&&zt([e])}));var n=t.find((function(e){return"Dashboards"===e.display_name})).subMenus.find((function(e){return"Allocation Dashboard"===e.display_name}));console.log(n.userRoles);var l=n.userRoles.includes("690")&&n.userRoles.includes("46")?800:n.userRoles.includes("641")&&n.userRoles.includes("46")?700:n.userRoles.includes("690")&&n.userRoles.includes("930")?500:n.userRoles.includes("641")&&n.userRoles.includes("930")?400:n.userRoles.includes("690")&&n.userRoles.includes("641")?600:n.userRoles.includes("126")&&n.userRoles.includes("46")||n.userRoles.includes("126")?126:n.userRoles.includes("690")?690:n.userRoles.includes("641")?641:n.userRoles.includes("46")?46:n.userRoles.includes("911")?911:null;console.log(l),X(l),600==l?x().get(Zt+"/dashboardsms/allocationDashboard/getCustomers?loggedUserId=".concat(Bt)).then((function(e){Ue(e.data)})):690==l||800==l?x().get(Zt+"/ProjectMS/project/getCustomersByDP?loggedUserId=".concat(Bt)).then((function(e){Ue(e.data)})):641==l||700==l?x().get(Zt+"/ProjectMS/project/getCustomersByCsl?loggedUserId=".concat(Bt)).then((function(e){Ue(e.data)})):x().get(Zt+"/customersms/Customers/getCustomers").then((function(e){Ue(e.data)})),600==l?x().get(Zt+"/ProjectMS/project/getProjectsbyCslDp?loggedUserId=".concat(Number(Bt)+1)).then((function(e){var t=e.data;We(t)})):690==l?x().get(Zt+"/ProjectMS/project/getProjectsbyDp?loggedUserId=".concat(Number(Bt)+1)).then((function(e){var t=e.data;We(t)})):641==l?x().get(Zt+"/ProjectMS/project/getProjectsbycsl?loggedUserId=".concat(Number(Bt)+1)).then((function(e){var t=e.data;We(t)})):800==l?x().get(Zt+"/ProjectMS/project/getProjectsforDPPM?userId=".concat(Bt,"&resId=").concat(Number(Bt)+1)).then((function(e){var t=e.data;We(t)})):700==l?x().get(Zt+"/ProjectMS/project/getProjectsforCSLPM?userId=".concat(Bt,"&resId=").concat(Number(Bt)+1)).then((function(e){var t=e.data;We(t)})):930==l?x().get(Zt+"/ProjectMS/project/getProjectsbyAE?loggedUserId=".concat(Number(Bt)+1)).then((function(e){var t=e.data;We(t)})):46==l?x().get(Zt+"/ProjectMS/project/getProjectsForAlloc?loggedUserId=".concat(Bt)).then((function(e){var t=e.data;We(t)})):x().get(Zt+"/ProjectMS/Audit/getProjectNameandId").then((function(e){var t=e.data;We(t)})),46===l&&(ne("project"),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},{type:"project"})}))),126!==l&&911!=l||(ne("bu"),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},{type:"bu"})}))),641!==l&&700!=l&&800!=l||(ne("customer"),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},{type:"customer"})})))}))};console.log($),(0,c.useEffect)((function(){Jt()}),[te]);var Jt=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x()({url:Zt+"/CostMS/cost/getDepartments"});case 2:t=e.sent,(n=t.data).push({value:999,label:"Non-Revenue Units"}),H(n),ye(n.filter((function(e){return 999!=e.value}))),l=[],n.forEach((function(e){999!=e.value&&l.push(e.value)})),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},(0,s.Z)({},"buId",l.toString()))}));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Gt=function(){x().get(Zt+"/CostMS/cost/getCountries").then((function(e){var t=[],n=e.data;n.length>0&&n.forEach((function(e){var n={label:e.country_name,value:e.id};t.push(n)})),he(t),_t(t),Ce(t)}))};(0,c.useEffect)((function(){var e=[];pe.forEach((function(t){e.push(t.value)})),Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},(0,s.Z)({},"countryIds",e.toString()))}))}),[pe]);var qt=function(e,t){return e.length===pe.length||e.length===B.length||e.length===xe.length?"<< ALL >>":0===e.length?"<< Please Select >>":e.map((function(t){return e.length>1?t.label+",":t.label}))};(0,c.useEffect)((function(){690!=$&&641!=$&&46!=$||($t(),Yt())}),[$]),console.log($,"dataAccess");var Yt=function(){x().get(690==$||641==$||46==$?Zt+"/dashboardsms/allocationDashboard/getResources?userId=".concat(Bt):Zt+"/dashboardsms/allocationDashboard/getAllResources").then((function(e){var t=e.data;Ge(t)}))},$t=function(){x().get(690==$||641==$||46==$?Zt+"/CommonMS/master/getprimaryPm?loggedUserId=".concat(Bt):Zt+"/dashboardsms/allocationDashboard/getManagers").then((function(e){var t=e.data;Xe(t)}))};console.log($);var Xt=function(e){e.expanded;return(0,O.jsx)(O.Fragment,{children:(0,O.jsx)(u.qL$,{className:"chevronIcon"})})},Qt=function(){Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},{customerId:"-1"})})),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},{projectId:"-1"})})),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},{resourceId:"-1"})})),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},{pmId:"-1"})}))};return(0,c.useEffect)((function(){}),[te]),(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{className:"col-md-12",children:(0,O.jsxs)("div",{className:"pageTitle",children:[(0,O.jsx)("div",{className:"childOne"}),(0,O.jsx)("div",{className:"childTwo",children:(0,O.jsx)("h2",{children:"Allocation Dashboard"})}),(0,O.jsx)("div",{className:"childThree"})]})}),P?(0,O.jsxs)("div",{className:"statusMsg error",children:[" ",(0,O.jsx)(W.CSE,{})," Please enter a value less than or equal to 100"]}):"",ct?(0,O.jsx)("div",{className:"statusMsg error col-12 mb-2",children:(0,O.jsxs)("span",{children:[(0,O.jsx)(I.SZZ,{}),"\xa0","Please select valid values for highlighted fields"]})}):"",(0,O.jsx)(G.Z,{routes:Wt,currentScreenName:["Allocation Dashboard"]}),(0,O.jsxs)("div",{className:"group mb-3 customCard",children:[(0,O.jsxs)("div",{className:"col-md-12 collapseHeader",children:[(0,O.jsx)("h2",{children:"Search Filters"}),(0,O.jsx)("div",{className:"helpBtn",children:(0,O.jsx)(J.Z,{pdfname:"AllocationDashboard.pdf",name:"Allocation Dashboard Help"})}),(0,O.jsx)("div",{onClick:function(){m(!n),F(n?u.UdN:u.NR5)},children:(0,O.jsx)("span",{children:M})})]}),(0,O.jsx)(h.V9,{visible:!n,children:(0,O.jsxs)("div",{className:"group-content row",children:[(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row",children:[(0,O.jsx)("label",{className:"col-4",htmlFor:"select",children:"Type"}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-7",children:(0,O.jsx)("select",{id:"type",onChange:function(e){var t=e.target,n=(t.id,t.value);ne(n),Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},(0,s.Z)({},"type",e.target.value))})),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},(0,s.Z)({},"countryIds","6,5,3,8,4,7,1,2"))})),Ce(wt)},children:690==$||641==$||600==$||930==$||800==$||700==$?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("option",{value:"customer",selected:!0,children:"Customer"}),(0,O.jsx)("option",{value:"project",children:"Project"})]}):(0,O.jsxs)(O.Fragment,{children:[46==$?"":(0,O.jsx)("option",{value:"bu",selected:!0,children:"Business Unit"}),46==$?"":(0,O.jsx)("option",{value:"customer",children:"Customer"}),(0,O.jsx)("option",{value:"project",children:"Project"}),46==$?"":(0,O.jsx)("option",{value:"resource",children:"Resource"}),686==$||932==$||126==$||911==$||46==$?(0,O.jsx)("option",{value:"primaryPm",children:"Primary PM"}):""]})})})]})}),690==$||641==$||930==$||600==$||46==$||800==$||700==$?"":("bu"==te||"customer"==te)&&(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row",children:[(0,O.jsxs)("label",{className:"col-4",htmlFor:"email-input",children:["BU",(0,O.jsx)("span",{className:"error-text ml-1",children:"*"})]}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-7 multiselect",ref:function(e){yt.current[0]=e},children:(0,O.jsx)(d.NU,{ArrowRenderer:Xt,id:"buId",options:B,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:be,valueRenderer:qt,disabled:!1,onChange:function(e){ye(e);var t=[];e.forEach((function(e){t.push(e.value)})),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},(0,s.Z)({},"buId",t.toString()))}))}})})]})}),console.log(Ot.type,"formData.type "),"customer"==te?(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row",children:[(0,O.jsxs)("label",{className:"col-4",htmlFor:"email-input",children:["Customer",(0,O.jsx)("span",{className:"error-text ml-1",children:"*"})]}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-7 autocomplete",ref:function(e){yt.current[1]=e},children:(0,O.jsxs)("div",{className:"autoComplete-container",children:[(0,O.jsx)(f.ReactSearchAutocomplete,{items:Oe,type:"Text",name:"customerId",id:"customerId",className:"AutoComplete",onSelect:function(e){Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},{customerId:e.id})}))},showIcon:!1,onClear:Qt,placeholder:"Type minimum 3 characters"}),(0,O.jsxs)("span",{children:[" ",C.name]})]})})]})}):"","project"==te?(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row",children:[(0,O.jsxs)("label",{className:"col-4",htmlFor:"email-input",children:["Project",(0,O.jsx)("span",{className:"error-text ml-1",children:"*"})]}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-7 autocomplete",ref:function(e){yt.current[2]=e},children:(0,O.jsxs)("div",{className:"autoComplete-container ",children:[(0,O.jsx)(f.ReactSearchAutocomplete,{items:Le,type:"Text",name:"projectId",id:"projectId",className:"error AutoComplete",onSelect:function(e){Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},{projectId:e.id})}))},showIcon:!1,onClear:Qt,placeholder:"Type minimum 3 characters"}),(0,O.jsxs)("span",{children:[" ",C.name]})]})})]})}):"","resource"==te?(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row",children:[(0,O.jsxs)("label",{className:"col-4",htmlFor:"email-input",children:["Resource",(0,O.jsx)("span",{className:"error-text ml-1",children:"*"})]}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-7 autocomplete",ref:function(e){yt.current[3]=e},children:(0,O.jsxs)("div",{className:"autoComplete-container ",children:[(0,O.jsx)(f.ReactSearchAutocomplete,{items:Je,type:"Text",name:"resourceId",id:"resourceId",className:"error AutoComplete",onSelect:function(e){Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},{resourceId:e.id})}))},showIcon:!1,onClear:Qt,placeholder:"Type minimum 3 characters"}),(0,O.jsxs)("span",{children:[" ",C.name]})]})})]})}):"","primaryPm"==te?(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row",children:[(0,O.jsxs)("label",{className:"col-4",htmlFor:"email-input",children:["Primary PM",(0,O.jsx)("span",{className:"error-text ml-1",children:"*"})]}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-7 autocomplete",ref:function(e){yt.current[4]=e},children:(0,O.jsxs)("div",{className:"autoComplete-container ",children:[(0,O.jsx)(f.ReactSearchAutocomplete,{items:$e,type:"Text",name:"pmId",id:"pmId",className:"error AutoComplete",onSelect:function(e){Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},{pmId:e.id})}))},showIcon:!1,onClear:Qt,placeholder:"Type minimum 3 characters"}),(0,O.jsxs)("span",{children:[" ",C.name]})]})})]})}):"",(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row",children:[(0,O.jsxs)("label",{className:"col-4",htmlFor:"email-input",children:["Country",(0,O.jsx)("span",{className:"error-text ml-1",children:"*"})]}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-7 multiselect",ref:function(e){yt.current[5]=e},children:(0,O.jsx)(d.NU,{ArrowRenderer:Xt,id:"countryIds",options:pe,hasSelectAll:!0,value:Se,disabled:!1,valueRenderer:qt,onChange:function(e){Ce(e);var t=[];e.forEach((function(e){t.push(e.value)})),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},(0,s.Z)({},"countryIds",t.toString()))}))}})})]})}),(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row",children:[(0,O.jsx)("label",{className:"col-4",htmlFor:"select",children:"Res. Type"}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-7",children:(0,O.jsxs)("select",{id:"resType",onChange:function(e){return Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},(0,s.Z)({},"resType",e.target.value))}))},children:[(0,O.jsx)("option",{value:"-1",children:"<<ALL>>"}),(0,O.jsx)("option",{value:"fte",children:"Employee"}),(0,O.jsx)("option",{value:"subk",children:"Contractors"})]})})]})}),(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row ",children:[(0,O.jsx)("label",{className:"col-4",htmlFor:"email-input",children:"Month"}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-7 datepicker",style:{zIndex:4},children:(0,O.jsx)(p(),{name:"month",id:"month",onChange:function(e){Me(e),Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},(0,s.Z)({},"month",y()(e).format("yyyy-MM-DD")))})),k(e)},selected:Ee,dateFormat:"MMM-yyyy",showMonthYearPicker:!0})})]})}),(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row",children:[(0,O.jsx)("label",{className:"col-4",htmlFor:"select",children:"Duration"}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-7",children:(0,O.jsxs)("select",{id:"duration",onSelect:function(e){return De(e.target.value)},onChange:function(e){return Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},(0,s.Z)({},"duration",e.target.value))}))},children:[(0,O.jsx)("option",{value:"1",children:"1"}),(0,O.jsx)("option",{value:"2",children:"2"}),(0,O.jsx)("option",{value:"3",selected:!0,children:"3"}),(0,O.jsx)("option",{value:"4",children:"4"}),(0,O.jsx)("option",{value:"5",children:"5"}),(0,O.jsx)("option",{value:"6",children:"6"}),(0,O.jsx)("option",{value:"7",children:"7"}),(0,O.jsx)("option",{value:"8",children:"8"}),(0,O.jsx)("option",{value:"9",children:"9"}),(0,O.jsx)("option",{value:"10",children:"10"}),(0,O.jsx)("option",{value:"11",children:"11"}),(0,O.jsx)("option",{value:"12",children:"12"})]})})]})}),(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row",children:[(0,O.jsxs)("label",{className:"col-4",htmlFor:"email-input",children:["Measures",(0,O.jsx)("span",{className:"error-text ml-1",children:"*"})]}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-7 multiselect",ref:function(e){yt.current[6]=e},children:(0,O.jsx)(d.NU,{ArrowRenderer:Xt,id:"measures",options:xe,hasSelectAll:!0,value:Ie,disabled:!1,valueRenderer:qt,onChange:function(e){Pe(e);var t=[];e.forEach((function(e){t.push(e.value)})),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},(0,s.Z)({},"measures",t.toString()))})),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},(0,s.Z)({},"filterVal","-1"))})),oe("-1")}})})]})}),"bu"==te?(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row",children:[(0,O.jsx)("label",{className:"col-4",htmlFor:"select",children:"View By"}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-7",children:(0,O.jsxs)("select",{id:"viewType",onChange:function(e){return Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},(0,s.Z)({},"viewType",e.target.value))}))},children:[(0,O.jsx)("option",{value:"resource",selected:!0,children:"Resource"}),(0,O.jsx)("option",{value:"bu",children:"BU"})]})})]})}):"",(0,O.jsx)("div",{className:"col-md-3 mb-2",children:(0,O.jsxs)("div",{className:"form-group row",children:[(0,O.jsx)("label",{className:"col-4",htmlFor:"select",children:"Filter By"}),(0,O.jsx)("span",{className:"col-1 p-0",children:":"}),(0,O.jsx)("div",{className:"col-3 pr-0",children:(0,O.jsxs)("select",{id:"filterMeasure",value:se,onChange:function(e){Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},(0,s.Z)({},"filterMeasure",e.target.value))})),Ut((function(e){return(0,i.Z)((0,i.Z)({},e),{},(0,s.Z)({},"filterVal","-1"))})),oe(e.target.value)},children:[(0,O.jsx)("option",{value:"-1",children:"<<Please Select>>"}),Ie.map((function(e){return(0,O.jsxs)("option",{value:e.value,children:[" ",e.label]})}))]})}),(0,O.jsx)("div",{className:"col-2 pl-1 pr-0",children:(0,O.jsxs)("select",{id:"operator",className:-1==se?"disabledFieldStyles":"",disabled:-1==se,onChange:function(e){return Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},(0,s.Z)({},"operator",e.target.value))}))},children:[(0,O.jsx)("option",{value:"ge",selected:!0,children:"\u2265"}),(0,O.jsx)("option",{value:"le",children:"\u2264"}),(0,O.jsx)("option",{value:"gt",children:">"}),(0,O.jsx)("option",{value:"lt",children:"<"}),(0,O.jsx)("option",{value:"eq",children:"="})]})}),(0,O.jsx)("div",{className:"col-2",children:(0,O.jsx)("input",{type:"text",className:-1==se?"disabledFieldStyles":P?"warning":"",disabled:-1==se,value:-1==se||"-1"==Ot.filterVal?"":Ot.filterVal,onChange:function(e){var t=e.target.value;/^\d*$/.test(t)&&Ut((function(t){return(0,i.Z)((0,i.Z)({},t),{},(0,s.Z)({},"filterVal",e.target.value))}))},id:"filterVal",maxLength:3,onKeyPress:function(e){e.key},onKeyDown:function(e){return e.keyCode&&(e.keyCode<=47||e.keyCode>=58)&&8!=e.keyCode&&e.preventDefault()}})})]})}),(0,O.jsx)("div",{className:"col-md-12 col-sm-12 col-xs-12 my-2 btn-container center",children:(0,O.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:function(){console.log(Ot),Rt(Ot.viewType),ht([]),T(parseInt(Ot.filterVal,10)>100);var e=yt.current.filter((function(e){return null!=e}));yt.current=e;var t=(0,z.Z)(yt);if("-1"!==Ot.filterMeasure&&"-1"===Ot.filterVal||""===Ot.filterVal&&"-1"===Ot.filterMeasure)return T(!0),void setTimeout((function(){T(!1)}),1e3);if(console.log(t,"---valid"),1==t&&(ot(!1),dt(!0),setTimeout((function(){T(!1),dt(!1)}),1e3)),!t&&!P&&!(parseInt(Ot.filterVal)>100)){Nt.current=new AbortController;var a=setTimeout((function(){ot(!(parseInt(Ot.filterVal,10)>100))}),2e3);x()({method:"post",url:Zt+"/dashboardsms/allocationDashboard/getAllocationDashboard",data:Ot,signal:Nt.current.signal}).then((function(e){var t=e.data.data;nt(t),ot(!1),clearTimeout(a);var n={tabData:t,reportRunId:e.data.reportRunId};return de(!0),n})).then((function(e){x()({method:"get",url:Zt+"/dashboardsms/allocationDashboard/getColumnsData?reportRunId=".concat(e.reportRunId)}).then((function(s){var o=s.data.val;gt(o);var i=[{columns:o},{tableData:(0,l.Z)(e.tabData)}];ot(!1),clearTimeout(a),(!t||!P)&&m(!n),F(n?u.UdN:u.NR5),ht(i)}))})).then((function(e){}))}},children:[(0,O.jsx)(u.U41,{})," Search"," "]})})]})}),st?(0,O.jsx)(g.Z,{handleAbort:function(){Nt.current&&Nt.current.abort(),ot(!1)}}):""]}),(0,O.jsxs)("div",{className:"col-12 p-0",children:[(0,O.jsxs)("div",{className:"col-12 row mr-0 pr-0",children:[ce&&(0,O.jsxs)("div",{className:"col-10",children:[(0,O.jsx)("span",{style:{fontWeight:"bold"},children:"B "}),"- Billable,"," ",(0,O.jsx)("span",{style:{fontWeight:"bold"},children:"NB "}),"- Non - Billable,"," ",(0,O.jsx)("span",{style:{fontWeight:"bold"},children:"I"})," - Innovation,"," ",(0,O.jsx)("span",{style:{fontWeight:"bold"},children:"O"})," - Others"]}),ce&&(0,O.jsx)("div",{className:"col-2",align:" right ",children:(0,O.jsx)(K.WlY,{size:"1.5em",title:"Export to Excel",style:{color:"green"},cursor:"pointer",onClick:function(){!function(){var e=[],t=[];t=xt.replaceAll("'",""),e=t.split(",").filter((function(e){return!e.includes("_greyout")}));var n=tt.map((function(t){var n={};return e.forEach((function(e){var l=t[e];if("string"===typeof l){var a=l.split("^&"),s=(0,r.Z)(a,2)[0];n[e]=s}else n[e]=l})),n})),l=(n.map((function(t){var n=[];return e.forEach((function(e){n.push(t[e])})),n})),new(S().Workbook)),a=l.addWorksheet("Data");n.forEach((function(e){a.addRow(Object.values(e))})),[1,2].forEach((function(e){a.getRow(e).font={bold:!0}})),l.xlsx.writeBuffer().then((function(e){saveAs(new Blob([e]),"AllocationDashboard.xlsx")}))}()}})})]}),(0,O.jsx)(L,{viewBy:Tt,data:pt,expandedCols:["emp_cadre","department","supervisor"],colExpandState:["0","1","name"]})]})]})}},224:function(e,t,n){n.d(t,{Z:function(){return g}});var l=n(93433),a=n(1413),s=n(4942),o=n(29439),i=n(72791),r=n(11683),c=n(13400),d=n(49177),u=n(34911),m=n(56637),p=n(53824),h=n(48462),f=n(59170),v=n(7692),x=n(80184);function g(e){var t={fte0:(0,x.jsx)("img",{src:u,alt:"(fte_inactive_icon)",style:{height:"12px",float:"left"},title:"Ex-Employee"}),fte1:(0,x.jsx)("img",{src:d,alt:"(fte_active_icon)",style:{height:"12px",float:"left"},title:"Active Employee"}),fte2:(0,x.jsx)("img",{src:m,alt:"(fte_notice_icon)",style:{height:"12px",float:"left"},title:"Employee in notice period"}),subk0:(0,x.jsx)("img",{src:h,alt:"(subk_inactive_icon)",style:{height:"12px",float:"left"},title:"Ex-Contractor"}),subk1:(0,x.jsx)("img",{src:p,alt:"(subk_active_icon)",style:{height:"12px",width:"auto",float:"left"},title:"Active Contractor",size:"1em"}),subk2:(0,x.jsx)("img",{src:f,alt:"(subk_notice_icon)",style:{height:"12px",float:"left"},title:"Contractor in notice period"})},n=e.data,g=e.expandedCols,j=e.colExpandState,b=(0,i.useState)([]),y=(0,o.Z)(b,2),N=y[0],Z=y[1],S=(0,i.useState)(null),C=(0,o.Z)(S,2),w=C[0],_=C[1],I=(0,i.useState)({}),P=(0,o.Z)(I,2),T=P[0],R=P[1],D=(0,i.useState)(!1),k=(0,o.Z)(D,2),A=k[0],E=k[1],M=(0,i.useState)([]),F=(0,o.Z)(M,2),V=(F[0],F[1]),O=function(e){var t=String(e);if(t.includes(".")){var n=Number(t),l=(null!=n&&n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:20})).split(".");return l[0]=l[0].replace(/(?<=\d)(?=(\d{3})+(?!\d|\.))/g,","),l.join(".")}return null!=t&&parseFloat(t).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:20}).replace(/(?<=\d)(?=(\d{3})+(?!\d|\.))/g,",")};(0,i.useEffect)((function(){U()}),[n]);var U=function(){var e,l;var a,i=n.tableData,r=null;null!==n&&void 0!==n&&null!==(e=n.columns)&&void 0!==e&&e.includes("'")?r=null===n||void 0===n||null===(a=n.columns)||void 0===a?void 0:a.replaceAll("'",""):r=null===n||void 0===n?void 0:n.columns;for(var d=null===(l=r)||void 0===l?void 0:l.split(","),u=[],m=[],p={},h=0;h<(null===d||void 0===d?void 0:d.length);h++){var f=d[h].trim(),b=i[0];p[f]=b[f]}var y=Object.entries(p).filter((function(e){var t=(0,o.Z)(e,2),n=(t[0],t[1]);return"string"===typeof n&&n.includes("^&")}));V(y),y.map((function(e){var t=(0,o.Z)(e,2),n=t[0];t[1];g.includes(n)&&m.push((0,s.Z)({},n,!1))})),R(Object.assign.apply(Object,[{}].concat(m))),y.map((function(e,n){var l=(0,o.Z)(e,2),a=l[0],s=l[1];u.push({accessorKey:a,header:s.split("^&")[0],enableColumnActions:!1,enableHiding:!0,Header:function(e){e.column;return(0,x.jsxs)("div",{children:[s.split("^&")[0]," ",a==j[2]?(0,x.jsx)(c.Z,{className:"expandIcon",title:"Show Details",onClick:function(){E((function(e){return!e}))},children:A?(0,x.jsx)(v.gbs,{}):(0,x.jsx)(v.lU2,{})}):""]})},Cell:function(e){var n=e.cell;return(0,x.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:n.getValue(),className:a.includes("_")?a.split("_")[1]%2==0?"":"odd":a.includes("total")?"total":("roleName"==a||"prjMgr"==a)&&"projManager",children:"name"==n.column.id&&null!=n.row.original.parentId?(0,x.jsxs)("span",{className:"rescolor",children:[t[n.row.original.empStatus],"\xa0",n.getValue()]}):a.includes("_")&&a.split("_")[2]||a.includes("total")?O(n.getValue()):n.getValue()})}})})),_(u);var N=[];null===i||void 0===i||i.map((function(e,t){return t>0&&-1!=e.id?N.push(e):""})),Z(B(N,{children:"subRows"}))};(0,i.useEffect)((function(){A?(U(),R({})):U()}),[A]);var B=function(e,t){t=(0,a.Z)({id:"uniqueId",parentId:"parentId",children:"subRows"},t);var n={},o=[],i=t.children;return e.forEach((function(e){var l=e[t.id],o=e[t.parentId];n[l]=(0,a.Z)((0,a.Z)((0,s.Z)({},i,[]),e),n[l]),n[o]=n[o]||(0,s.Z)({},i,[]),n[o][i].push(n[l])})),Object.values(n).forEach((function(e){"undefined"===typeof e[t.id]&&o.push.apply(o,(0,l.Z)(e[i]))})),o};return(0,x.jsx)("div",{className:"materialReactExpandableTable engagementAllocationsTable darkHeader",children:null!==w&&void 0!==w&&w.length?(0,x.jsx)(r.ZP,{columns:w,data:N,enableExpandAll:!0,enableExpanding:!0,enablePagination:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!1,filterFromLeafRows:!0,initialState:{expanded:!1,density:"compact",columnVisibility:(0,a.Z)({},T),columnPinning:{right:["total"]}},state:{columnVisibility:(0,a.Z)({},T)},defaultColumn:{minSize:40,maxSize:1e3,size:40},enableStickyHeader:!0,muiTableContainerProps:{sx:{maxHeight:"70vh",width:"auto",maxWidth:"fit-content"}},muiTableBodyProps:{sx:{"&":{},"& td":{borderRight:"1px solid #ccc",height:"22px",fontSize:"11px",paddingTop:"0px",paddingBottom:"0px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",fontSize:"13px",padding:"0px 8px"}}}}):null})}}}]);
//# sourceMappingURL=1858.4667ceba.chunk.js.map