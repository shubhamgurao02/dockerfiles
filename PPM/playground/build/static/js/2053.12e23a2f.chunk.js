"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[2053],{2053:function(e,t,n){n.r(t),n.d(t,{default:function(){return se}});var s=n(4942),l=n(1413),a=n(29439),o=n(72791),i=n(93433),r=n(80184);function c(e){var t=e.employeeElement,n=e.selectedSE,s=e.data,l=e.showInactive,i=e.search,c=(0,o.useState)([]),d=(0,a.Z)(c,2),u=d[0],m=d[1];return(0,o.useEffect)((function(){m((function(){return s.filter((function(e){return e.status!==(l?"":"empInactive")})).filter((function(e){return e.salesPersonName.toLowerCase().includes(i)})).map((function(e){return t(e)}))}))}),[n,l,s,i]),(0,r.jsxs)("div",{className:"option col-md-3",children:[0===u.length&&(0,r.jsx)("div",{className:"col-md-12",id:"noExecDiv",children:"No Customers found"}),u]})}function d(e){var t=e.selectedSEDisp;return(0,r.jsxs)("div",{className:"col-md-12 customCard Scroll",children:[0===t.length?"None Selected":t,(0,r.jsx)("div",{className:"clearfix",style:{height:"10px"}})]})}n(49177),n(34911),n(56637),n(53824),n(48462),n(59170);var u=n(34831),m=n(74569),h=n.n(m),f=(n(61155),(0,o.forwardRef)((function(e,t){var n=u.N.baseUrl,s=(0,o.useState)(!1),l=(0,a.Z)(s,2),m=l[0],f=(l[1],(0,o.useState)([])),p=(0,a.Z)(f,2),v=p[0],x=p[1],g=(0,o.useState)([]),j=(0,a.Z)(g,2),y=j[0],S=j[1],b=(0,o.useState)(!1),N=(0,a.Z)(b,2),C=N[0],Z=N[1],D=(0,o.useState)([]),w=(0,a.Z)(D,2),I=w[0],P=w[1],R=(0,o.useState)(!1),E=(0,a.Z)(R,2),M=E[0],k=E[1],A=(0,o.useState)(""),O=(0,a.Z)(A,2),_=O[0],T=O[1];(0,o.useImperativeHandle)(t,(function(){return{setGlobalState:function(){localStorage.setItem("selectedSE",JSON.stringify(v)),localStorage.setItem("isIndividual",M)},resetTOlocalState:function(){var e=null===localStorage.getItem("selectedSE")?[]:JSON.parse(localStorage.getItem("selectedSE"));x(e),k("true"===localStorage.getItem("isIndividual"))}}}));var V=function(e){return(0,r.jsxs)("span",{className:"option col-md-12",style:{width:"150px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[(0,r.jsx)("input",{type:"checkbox",id:e.id,name:e.salesPersonName,onChange:function(t){return function(e){x((function(t){return t.some((function(t){return t.id===e.id}))?t.filter((function(t){return t.id!==e.id})):[].concat((0,i.Z)(t),[e])}))}(e)},checked:v.some((function(t){return t.id===e.id}))}),"\xa0 \xa0",(0,r.jsx)("span",{title:e.salesPersonName,children:e.salesPersonName})]},e.id)};return(0,o.useEffect)((function(){S((function(){return v.filter((function(e){return e.salesPersonName.toLowerCase().includes(_)})).map((function(e){return V(e)}))}))}),[v,_]),(0,o.useEffect)((function(){x((function(e){return e.filter((function(e){return"empActive"===e.status}))}))}),[m]),(0,o.useEffect)((function(){h().get(n+"/SalesMS/MasterController/getInDirectSalesExecutiveTreeData?userId=512").then((function(e){var t=e.data;P(t)})).catch((function(e){console.log(e)}));var e=null===localStorage.getItem("selectedSE")?[]:JSON.parse(localStorage.getItem("selectedSE"));x(e),k("true"===localStorage.getItem("isIndividual"))}),[]),(0,r.jsxs)("div",{className:"col-md-12",children:[(0,r.jsx)("div",{className:"col-md-12",children:(0,r.jsx)("div",{className:"col-md-3 nopadding",children:(0,r.jsx)("input",{type:"text",placeholder:" Type to Search",onChange:function(e){return T(e.target.value.toLowerCase())},style:{borderRadius:"5px"}})})}),(0,r.jsx)("div",{className:"col-md-12 clearfix",style:{height:"10px"}}),(0,r.jsxs)("div",{className:"col-md-3",children:[(0,r.jsx)("label",{children:"Selected Items"}),"\xa0",(0,r.jsx)("input",{type:"checkbox",id:"SelectedItems",name:"SelectedItems",onChange:function(){x([])},checked:v.length>0}),"\xa0"]}),(0,r.jsx)("div",{className:"col-md-12",children:(0,r.jsx)(d,{selectedSEDisp:y})}),(0,r.jsx)("div",{className:"col-md-12 clearfix",style:{height:"10px"}}),(0,r.jsx)("div",{className:"col-md-12 nopadding",children:(0,r.jsx)("div",{className:"col-md-12",children:(0,r.jsxs)("div",{className:"col-md-12 customCard",children:[(0,r.jsxs)("div",{className:"col-md-6",children:[(0,r.jsx)("label",{children:"All Customers"}),"\xa0",(0,r.jsx)("input",{type:"checkbox",onChange:function(){x(C?function(e){var t=I.map((function(e){return e.id}));return e.filter((function(e){return!t.includes(e.id)}))}:function(e){var t=e.map((function(e){return e.id})),n=I.filter((function(e){return e.status!==(m?"":"empInactive")})).filter((function(e){return!t.includes(e.id)}));return[].concat((0,i.Z)(e),(0,i.Z)(n))}),Z((function(e){return!e}))},checked:C})]}),(0,r.jsx)("div",{className:"col-md-12 clearfix",style:{height:"20px"}}),(0,r.jsx)(c,{employeeElement:V,selectedSE:v,data:I,showInactive:m,search:_})]})})})]})}))),p=n(78983),v=n(16030),x=n(49648);function g(e){var t=e.open;e.children,e.onClose;if(!t)return null;var n=(0,o.useRef)(null),s=(0,o.useState)(!1),l=(0,a.Z)(s,2),i=(l[0],l[1]),c=(0,v.I0)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"box",children:(0,r.jsxs)(p.Tk,{visible:t,onClose:function(){return i(!1)},size:"xl",children:[(0,r.jsx)(p.p0,{children:(0,r.jsx)(p.fl,{children:"Select Customers/Prospects"})}),(0,r.jsx)(p.sD,{children:(0,r.jsx)(f,{ref:n})}),(0,r.jsxs)(p.Ym,{children:[(0,r.jsx)(p.u5,{onClick:function(){c((0,x.Xm)("undo")),n.current.resetTOlocalState()},children:"Undo"}),(0,r.jsx)(p.u5,{onClick:function(){n.current.setGlobalState(),c((0,x.Xm)("save")),i(!1)},children:"Save"})]})]})})})}var j=n(59513),y=n.n(j),S=n(72426),b=n.n(S),N=n(36167),C=n(11683),Z=n(13400),D=n(11087),w=n(29718),I=n.n(w),P=n(12003),R=n.n(P),E=n(59831),M=n(91951);function k(e){var t=e.filterData;console.log(t,"filterData............");var n={},s={};Object.keys(t).forEach((function(e){if(e.includes("plRevDelta")){var l=e.substring(0,10),a=(0,E.default)(l.replace(/_/g,"-")),o=(0,M.default)(a,"dd-MMM-yyyy");n[o]=t[e]}else if(e.includes("plRev")){console.log(e,"keys................."),console.log("key.........."+t[e]);var i=e.substring(0,10);console.log(i+"in line 27...");var r=(0,E.default)(i.replace(/_/g,"-")),c=(0,M.default)(r,"dd-MMM-yyyy");s[c]=t[e]}})),console.log(s,"pldata..........");var l=Object.keys(n).sort((function(e,t){return new Date(e)-new Date(t)})),a={};l.forEach((function(e){a[e]=n[e]})),console.log(a,"sortedFteData..................");var o={};Object.keys(s).sort((function(e,t){return new Date(e)-new Date(t)})).forEach((function(e){o[e]=s[e]}));var i={chart:{type:"line"},title:{text:"Delta"},exporting:{enabled:!0},xAxis:{categories:Object.keys(o).map((function(e){return e.split("-")[0]})),title:{text:"Days"}},yAxis:{tickInterval:2500,title:{text:"Revenue"}},series:[{name:"Delta",data:Object.values(a).map((function(e){return Number(e)}))}]},c={chart:{type:"line"},title:{text:"Planned Revenue"},exporting:{enabled:!0},xAxis:{categories:Object.keys(o).map((function(e){return e.split("-")[0]})),title:{text:"Days"}},yAxis:{tickInterval:2500,title:{text:"Revenue"}},series:[{name:"Planned Revenue",data:Object.values(o).map((function(e){return Number(e)}))}]};return(0,r.jsxs)("div",{className:"col-12 row",children:[(0,r.jsx)("div",{className:"col-6",children:(0,r.jsx)(R(),{highcharts:I(),options:c})}),(0,r.jsxs)("div",{className:"col-6",children:[" ",(0,r.jsx)(R(),{highcharts:I(),options:i})]})]})}var A=n(14651),O=n(37145),_=n(1063);n(20068);function T(e){var t=e.actionItems,n=e.Pname,s=e.close,l=e.setOpenPopup,i=(0,o.useState)([]),c=(0,a.Z)(i,2),d=(c[0],c[1]),u=(0,o.useState)([]),m=(0,a.Z)(u,2),h=(m[0],m[1]);console.log("actionItems................",t);(0,o.useEffect)((function(){h(t),t.length>1?d(t):d([])}),[t]);Boolean(s);var f=t[0];console.log(f);for(var p=[],v=0,x=["project","customer","itemdate","entryDt","entryBy","comments"];v<x.length;v++){var g=x[v];f&&f.hasOwnProperty(g)&&p.push({field:g,header:f[g]})}return(0,r.jsx)("div",{className:"col-8 mt-5",children:(0,r.jsxs)("div",{style:{width:"810px",height:"115px"},children:[(0,r.jsxs)("div",{className:"col-md-12 header padding",style:{border:"1px solid #ddd",marginTop:"10px"},children:[(0,r.jsx)("span",{align:"center",style:{fontSize:"13px",top:"250px",color:"#2E88C5"},children:n}),(0,r.jsx)("button",{title:"Close",style:{float:"right",marginRight:"-10px",height:"33px",width:"23px"},className:"button1",onClick:function(){l(!1)},children:"x"})]}),(0,r.jsx)("div",{className:"darkHeader",children:(0,r.jsx)(O.w,{showGridlines:!0,style:{fontSize:"12px"},value:t,emptyMessage:"No Records found.",children:[{field:"project",header:"Project"},{field:"customer",header:"Customer"},{field:"itemdate",header:"Itemdate"},{field:"entryBy",header:"EntryBy"},{field:"entryDt",header:"EntryDt"},{field:"comments",header:"Comments"}].map((function(e,t){return(0,r.jsx)(_.s,{field:e.field,header:e.header},e.field)}))})})]})})}n(7217);var V=n(15473),U=n(65661),B=n(39157),z=n(25103),F=n(17425),L=n(78820);function H(e){e.setOpenPopOver;var t=e.actionItem,n=e.Pname,s=e.close,l=e.handleClose,i=e.projetId,c=e.USerId,d=e.ItemDate,m=e.dataAccess,f=(0,o.useState)(""),p=(0,a.Z)(f,2),v=p[0],x=p[1],g=(0,o.useState)(!1),j=(0,a.Z)(g,2),y=j[0],S=j[1],N=(0,o.useState)(!1),C=(0,a.Z)(N,2),Z=(C[0],C[1]),D=(0,o.useState)(!1),w=(0,a.Z)(D,2),I=w[0],P=(w[1],u.N.baseUrl);(0,o.useEffect)((function(){console.log("in line 18---"),console.log(t)}),[]);var R=Boolean(s),E=R?"simple-popover":void 0,M=function(e){var t=e.value,n=e.onChange;return(0,r.jsx)(z.o,{value:t,onChange:function(e){var t=e.target.value;x(t),n(e)}})};console.log(v,"------------------------------"),console.log(t);var k=function(){""==v?S(!0):(S(!1),h()({method:"post",url:P+"/ProjectMS/PlannedActivities/saveActionItemData",data:{comments:v,project_id:i,item_date:d,created_by:c}}).then((function(e){S(!1)})).catch((function(e){console.log(e)})))};return(0,r.jsx)("div",{children:void 0!=t[0]&&(0,r.jsx)(V.ZP,{id:E,open:R,onClose:l,close:l,anchor:{top:"257px !important",left:"255px !important",position:"bottom !important"},size:"xl",children:(0,r.jsxs)("div",{className:"montlyPrPopup",style:{width:"810px",height:"115px"},children:[1==y?(0,r.jsxs)("div",{className:"statusMsg error",children:[(0,r.jsx)(L.CSE,{size:"1.4em"}),(0,r.jsx)("span",{children:"Please select the valid values for highlighted fields"})]}):"",1==I?(0,r.jsxs)("div",{className:"statusMsg error",children:[(0,r.jsx)(L.CSE,{size:"1.4em"}),(0,r.jsx)("span",{children:"No Modifications found to save"})]}):"",(0,r.jsx)(U.Z,{className:"header padding",children:(0,r.jsxs)("div",{className:"col-md-12",style:{height:"28px",marginTop:"-21px"},children:[(0,r.jsx)("span",{align:"center",style:{fontSize:"13px",top:"250px",color:"#2E88C5"},children:n}),(0,r.jsx)("button",{title:"Close",style:{float:"right",marginRight:"-10px",height:"33px",width:"23px"},className:"button1",onClick:l,children:"x"})]})}),(0,r.jsx)(B.Z,{children:(0,r.jsx)("div",{className:"darkHeader",children:(0,r.jsxs)(O.w,{value:t,tableStyle:{minWidth:"38rem"},showGridlines:!0,editMode:"cell",children:[(0,r.jsx)(_.s,{field:"entryDt",header:"Entry Date",body:function(e){return(0,r.jsx)("span",{id:"entryDt",title:e.entryDt,children:b()(e.entryDt).format("DD-MMM-YYYY")})}}),(0,r.jsx)(_.s,{field:"entryBy",header:"Entry By",body:function(e){return(0,r.jsx)("span",{id:"entryBy",title:e.entryBy,children:e.entryBy})}}),(0,r.jsx)(_.s,{field:"itemdate",header:"Item Date",body:function(e){return(0,r.jsx)("span",{id:"itemdate",title:e.itemdate,children:b()(e.itemdate).format("DD-MMM-YYYY")})}}),100===m&&(0,r.jsx)(_.s,{field:"comments",header:"Comments",body:function(e){return(0,r.jsx)("span",{id:"comments",title:e.comments,children:e.comments})},editor:function(e){return function(e){if("comments"===e.field)return(0,r.jsx)(M,{style:{width:"10px"},value:e.value,onChange:function(n){e.editorCallback(n.target.value),t[0].comments=n.target.value,Z(!0)}})}(e)},onCellEditComplete:function(e){}}),100===m&&(0,r.jsx)(_.s,{field:"",header:"Action Item",body:(0,r.jsx)("center",{children:(0,r.jsx)("a",{style:{cursor:"pointer"},children:(0,r.jsx)(F.Qup,{onClick:function(e){""!=v?(k(),l()):k()},title:"Save"})})})})]})})})]})})})}var Y=n(7692);function K(e){var t=u.N.baseUrl,n=e.data,c=e.expandedCols,d=e.colExpandState,m=e.dataAccess,f=(0,o.useState)([]),p=(0,a.Z)(f,2),v=p[0],x=p[1],g=(0,o.useState)(null),j=(0,a.Z)(g,2),y=j[0],S=j[1],N=(0,o.useState)({}),w=(0,a.Z)(N,2),I=w[0],P=w[1],R=(0,o.useState)(!1),E=(0,a.Z)(R,2),M=E[0],O=E[1],_=(0,o.useState)([]),V=(0,a.Z)(_,2),U=V[0],B=V[1],z=(0,o.useState)(!1),F=(0,a.Z)(z,2),L=F[0],K=F[1],W=(0,o.useState)([]),G=(0,a.Z)(W,2),J=G[0],q=G[1],X=(0,o.useState)(!1),Q=(0,a.Z)(X,2),$=Q[0],ee=Q[1],te=(0,o.useState)(!1),ne=(0,a.Z)(te,2),se=ne[0],le=ne[1],ae=(0,o.useState)(!1),oe=(0,a.Z)(ae,2),ie=oe[0],re=oe[1],ce=(0,o.useState)(),de=(0,a.Z)(ce,2),ue=de[0],me=de[1],he=(0,o.useState)([]),fe=(0,a.Z)(he,2),pe=fe[0],ve=fe[1],xe=(0,o.useState)([]),ge=(0,a.Z)(xe,2),je=ge[0],ye=ge[1],Se=(0,o.useState)(),be=(0,a.Z)(Se,2),Ne=be[0],Ce=be[1],Ze=(0,o.useRef)(null);(0,o.useEffect)((function(){var e=Ze.current;void 0!=e.children[0]&&setTimeout((function(){e&&(e.children[0].children[0].children[0].scrollLeft=e.children[0].children[0].children[0].scrollWidth)}),1e3)}),[v.length]),console.log(L,"graph.........................................."),(0,o.useEffect)((function(){dt(),K(!1)}),[n]);var De=(0,o.useRef)(null);(0,o.useEffect)((function(){var e=De.current;e&&(e.style.right="0")}),[]);var we=(0,o.useRef)(null),Ie=(0,o.useRef)(null),Pe=(0,o.useState)(0),Re=(0,a.Z)(Pe,2),Ee=Re[0],Me=Re[1],ke=(0,o.useState)(0),Ae=(0,a.Z)(ke,2),Oe=Ae[0],_e=Ae[1];(0,o.useEffect)((function(){Ee&&we.current&&we.current.scrollIntoView({behavior:"instant"})}),[Ee]),(0,o.useEffect)((function(){Oe&&Ie.current&&Ie.current.scrollIntoView({behavior:"instant"})}),[Oe]);var Te=function(e){return null===e||void 0===e?void 0:e.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")};console.log(n,"data..................");var Ve=function(e){n.tableData.map((function(t){(t.dispName.includes(e)&&1==t.lvl||0==t.lvl)&&(K(!0),q(t),Me((function(e){return e+1})),Ce(t.customer))}))},Ue=new Date,Be=Ue.getMonth(),ze=Ue.getFullYear(),Fe=new Date(ze,Be,1),Le=new Date(ze,Be+1,0),He=b()(Fe).format("yyyy-MM-DD"),Ye=b()(Le).format("yyyy-MM-DD"),Ke=(new Date).toLocaleDateString(),We=b()(Ke).format("yyyy-MM-DD"),Ge=(0,o.useState)(),Je=(0,a.Z)(Ge,2),qe=Je[0],Xe=Je[1],Qe=(0,o.useState)(),$e=(0,a.Z)(Qe,2),et=$e[0],tt=$e[1],nt=!0,st=localStorage.getItem("resId"),lt=localStorage.getItem("resName"),at="",ot={};console.log("actionItems>>>>>>>>>>>>>.",pe);var it=function(){re(!1),le(!1),ee(!1)},rt=function(e){var n;ee(!0),re(!0),me(e.getValue()),tt(e.row.original.id),n=e.row.original.id,at="prj",nt=!1,h()({method:"get",url:t+"/ProjectMS/PlannedActivities/getAllActionItems?projectId=".concat(n,"&runDt=").concat("","&OverView=").concat(nt,"&fday=").concat(He,"&lday=").concat(Ye,"&type=").concat(at)}).then((function(e){var t=e.data;ve(t)})).catch((function(e){console.log(e)})),_e((function(e){return e+1}))},ct=function(e){re(!0),le(!0),me(e.row.original.dispName);var n,s,l=e.id,a=l.includes("_")?l.split("_"):"";a=a.slice(1,4).join("-"),Xe(a),tt(e.row.original.id),n=e.row.original.id,s=a,at="prj",nt=!1,h()({method:"get",url:t+"/ProjectMS/PlannedActivities/getActionItems?projectId=".concat(n,"&runDt=").concat(s,"&OverView=").concat(nt,"&fday=").concat(He,"&lday=").concat(Ye,"&type=").concat(at)}).then((function(e){var t=e.data;if(0==t.length){for(var n=[We,lt,s,""],l=["entryDt","entryBy","itemdate","comments"],a=0;a<l.length;a++)ot[l[a]]=n[a];ye([].concat((0,i.Z)(pe),[ot]))}else 1==t.length&&ye(t)})).catch((function(e){console.log(e)}))},dt=function(){var e,t,l,o=null===n||void 0===n?void 0:n.tableData,i=null;null!==n&&void 0!==n&&null!==(e=n.columns)&&void 0!==e&&e.includes("'")?i=null===n||void 0===n||null===(l=n.columns)||void 0===l?void 0:l.replaceAll("'",""):i=null===n||void 0===n?void 0:n.vmgPerformance;for(var u=null===(t=i)||void 0===t?void 0:t.split(","),m=[],h=[],f={},p=0;p<(null===u||void 0===u?void 0:u.length);p++){var v=u[p].trim(),g=o[0];f[v]=g[v]}var j=Object.entries(f),y=j.filter((function(e){var t=(0,a.Z)(e,2),n=(t[0],t[1]);return"string"===typeof n&&n.includes("^&")}));B(y.sort((function(e,t){return e-t}))),console.log(j),j.map((function(e){var t,n=(0,a.Z)(e,2),l=n[0];n[1];c.includes(l)&&h.push((t={},(0,s.Z)(t,l,!1),(0,s.Z)(t,"className","mixer"),t))})),console.log(h),P(Object.assign.apply(Object,[{}].concat(h))),console.log(I);var b=null===o||void 0===o?void 0:o.filter((function(e){return-1==e.id}));y.map((function(e,t){var n=(0,a.Z)(e,2),s=n[0],l=n[1];m.push({accessorKey:s,header:l,enableColumnActions:!1,enableHiding:!0,Header:function(e){e.column;return(0,r.jsxs)("div",{className:"dispName"==s?"mixer":"csl"==s?"mixer csl":"dp"==s?"mixer dp":"pm"==s?"mixer pm":"",children:[null===l||void 0===l?void 0:l.split("^&")[0]," ",s==d[2]?(0,r.jsx)(Z.Z,{onClick:function(){O((function(e){return!e}))},children:M?(0,r.jsx)(Y.gbs,{style:{fontSize:"20px"}}):(0,r.jsx)(Y.lU2,{style:{fontSize:"20px"}})}):null]})}})}));var N=b&&Object.entries(b[0]);null===N||void 0===N||N.sort(),m.map((function(e){var t=m.indexOf(e),n=[];N.map((function(t,s){var l=(0,a.Z)(t,2),o=l[0],i=l[1];if(o.includes("_")){var c=o.includes("_")?o.split("_"):"";if(c=c.slice(0,2).join("_"),e.accessorKey.includes(c)){var d={id:o,header:i,accessorKey:o,Cell:function(e){var t=e.cell;return(0,r.jsx)("div",{className:o.includes("plRevDelta")?"delta":o.includes("plRev")?"plRev":o.includes("csl")?"csl":o.includes("pm")?"pm":o.includes("dp")?"dp":"summary",children:0==t.row.original.projectId?1==o.includes("Delta")?t.getValue()>0?(0,r.jsx)("div",{style:{color:"green"},children:Te(t.getValue())}):0==t.getValue()?t.getValue():(0,r.jsx)("div",{style:{color:"red"},children:Te(t.getValue())}):Te(t.getValue()):1==o.includes("Delta")&&0!=t.row.original.projectId?t.getValue()>0?(0,r.jsxs)("div",{style:{color:"green"},children:[Te(t.getValue()),(0,r.jsx)("a",{onClick:function(){return ct(t)},children:(0,r.jsx)(A.py9,{})})]}):0==t.getValue()?(0,r.jsxs)("span",{children:[t.getValue(),(0,r.jsx)("a",{onClick:function(){return ct(t)},children:(0,r.jsx)(A.py9,{})})]}):(0,r.jsx)("div",{style:{color:"red"},children:(0,r.jsxs)(r.Fragment,{children:[Te(t.getValue()),(0,r.jsx)("a",{onClick:function(){return ct(t)},children:(0,r.jsx)(A.py9,{})})]})}):Te(t.getValue())})}};n.push(d)}}else if(o==e.accessorKey){var u={id:o,header:"",accessorKey:o,Cell:function(e){var t=e.cell;return(0,r.jsx)("div",{className:"row",children:"dispName"==t.column.id&&1==t.row.original.lvl?(0,r.jsxs)("div",{className:"externalValues",children:[(0,r.jsx)("a",{title:"Action Items",onClick:function(){return rt(t)},children:(0,r.jsx)(A.py9,{})}),(0,r.jsx)("a",{className:o.includes("csl")?"csl ellipsis":o.includes("pm")?"pm ellipsis":o.includes("dp")?"dp ellipsis":" ellipsis",style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},title:t.getValue(),onClick:function(){return Ve(t.getValue())},children:t.getValue()})]}):"Summary"===t.row.original.dispName?(0,r.jsx)("a",{href:"#",onClick:function(e){e.preventDefault(),K(!0),Ve(t.getValue())},children:t.getValue()}):t.row.original.lvl>1&&"dispName"==t.column.id?(0,r.jsxs)("div",{children:[(0,r.jsxs)("a",{title:"Action Items",onClick:function(){return rt(t)},children:[(0,r.jsx)(A.py9,{}),"\xa0"," "]}),(0,r.jsx)(D.rU,{title:t.getValue(),to:"/project/Overview/:".concat(t.row.original.projectId),target:"_blank",className:"innerValues",children:(0,r.jsx)("span",{style:{color:"",display:"inline-block",maxWidth:"205px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",verticalAlign:"middle",textDecoration:"underline"},children:t.getValue()})})," "]}):(0,r.jsx)("div",{className:o.includes("csl")?"csl ellipsis":o.includes("pm")?"pm ellipsis":o.includes("dp")?"dp ellipsis":" ellipsis",style:{width:"100px"},title:t.getValue(),children:t.getValue()})})}};n.push(u)}})),m[t].columns=n})),S(m);var C=[];null===o||void 0===o||o.map((function(e){return-2!=e.id&&-3!=e.id?C.push(e):""}));var w=mt(C,{children:"subRows"});x(w.slice(1,w.length))};(0,o.useEffect)((function(){dt(),M?P({}):ut()}),[M]);var ut=function(){var e=[];U.map((function(t){var n=(0,a.Z)(t,2),l=n[0];n[1];c.includes(l)&&e.push((0,s.Z)({},l,!1))})),P(Object.assign.apply(Object,[{}].concat(e)))};console.log(J,"filterData...................");var mt=function(e,t){t=(0,l.Z)({id:"uniqueId",parentId:"parentId",children:"subRows"},t);var n={},a=[],o=t.children;return e.forEach((function(e){var a=e[t.id],i=e[t.parentId];n[a]=(0,l.Z)((0,l.Z)((0,s.Z)({},o,[]),e),n[a]),n[i]=n[i]||(0,s.Z)({},o,[]),n[i][o].push(n[a])})),Object.values(n).forEach((function(e){"undefined"===typeof e[t.id]&&a.push.apply(a,(0,i.Z)(e[o]))})),a};null===y||void 0===y||y.map((function(e){return e.header}));return console.log("hiddenColumns......................",I),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"materialReactExpandableTable1 monthlyPRMaterialTable darkHeader toHead",ref:Ze,children:[v.length?(0,r.jsx)("div",{children:(0,r.jsx)(C.ZP,{ref:De,columns:y,data:v,enableExpandAll:!0,enableRowVirtualization:!0,enableExpanding:!0,enablePagination:!1,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnActions:!1,enableSorting:!0,filterFromLeafRows:!0,initialState:{expanded:!1,density:"compact",columnVisibility:(0,l.Z)({},I)},state:{columnVisibility:(0,l.Z)({},I)},defaultColumn:{minSize:40,maxSize:1e3,size:70},muiTableContainerProps:{sx:{"&":{maxHeight:"73vh"}}},muiTableBodyProps:{sx:{"&":{},"& td":{borderRight:"1px solid #ccc",height:"22px",fontSize:"11px",paddingTop:"0px",paddingBottom:"0px"}}},muiTableHeadProps:{sx:{"& th":{borderTop:"1px solid #ccc",borderRight:"1px solid #ccc",background:"#f4f4f4 ",fontSize:"11px"}}}})}):null,L&&(0,r.jsxs)("div",{className:"col-12 mt-5",ref:we,children:[(0,r.jsx)("div",{style:{color:"#333333",fontSize:"15px",fontStyle:"bold"},children:(0,r.jsx)("b",{children:"Revenue Progression For "+Ne})}),(0,r.jsx)(k,{filterData:J})]},Ee),se?(0,r.jsx)(H,{setOpenPopOver:le,openPopOver:se,handleClose:it,close:ie,Pname:ue,actionItem:je,projetId:et,USerId:st,ItemDate:qe,dataAccess:m}):""]}),$?(0,r.jsxs)("div",{ref:Ie,children:[(0,r.jsx)(T,{setOpenPopup:ee,openPopup:$,handleClose:it,close:ie,Pname:ue,actionItems:pe})," "]},Oe):""]})}var W=n(83854),G=n(56355),J=n(85401),q=n(32125),X=n(96907),Q=n(15719),$=n(1104),ee=n(74888),te=n(72920),ne=n(38262);var se=function(){var e,t,i=u.N.baseUrl,c=new Date,d=(c.getFullYear(),c.getMonth(),c.getMonth(),new Date),m=(0,Q.default)(d),f=(0,o.useState)([]),v=(0,a.Z)(f,2),x=v[0],j=v[1],S=d.getDate(),C=S<=10?(0,$.default)(m,-1):m,Z=S>10?(0,$.default)(m,1):m,D=(0,Q.default)(C),w=(0,ee.default)(Z),I=(0,o.useState)(!1),P=(0,a.Z)(I,2),R=P[0],E=P[1],M=(0,o.useState)(!1),k=(0,a.Z)(M,2),A=k[0],O=k[1],_=(0,o.useState)([]),T=(0,a.Z)(_,2),V=T[0],U=T[1],B=(0,o.useState)([]),z=(0,a.Z)(B,2),H=z[0],Y=z[1],se=(0,o.useState)([]),le=(0,a.Z)(se,2),ae=le[0],oe=le[1],ie=(0,o.useState)(-1),re=(0,a.Z)(ie,2),ce=re[0],de=re[1],ue=(0,o.useState)([]),me=(0,a.Z)(ue,2),he=me[0],fe=me[1],pe=(0,o.useState)([]),ve=(0,a.Z)(pe,2),xe=ve[0],ge=ve[1],je=(0,o.useState)(!1),ye=(0,a.Z)(je,2),Se=ye[0],be=ye[1],Ne=(0,o.useState)(new Date),Ce=(0,a.Z)(Ne,2),Ze=Ce[0],De=Ce[1],we=(0,o.useState)([]),Ie=(0,a.Z)(we,2),Pe=Ie[0],Re=Ie[1],Ee=(0,o.useState)({}),Me=(0,a.Z)(Ee,2),ke=(Me[0],Me[1]),Ae=(0,o.useState)([]),Oe=(0,a.Z)(Ae,2),_e=Oe[0],Te=Oe[1],Ve=(0,o.useState)([]),Ue=(0,a.Z)(Ve,2),Be=Ue[0],ze=Ue[1],Fe=(0,o.useState)(!1),Le=(0,a.Z)(Fe,2),He=Le[0],Ye=Le[1],Ke=(0,o.useState)([]),We=(0,a.Z)(Ke,2),Ge=We[0],Je=We[1],qe=(0,o.useState)(!1),Xe=(0,a.Z)(qe,2),Qe=Xe[0],$e=Xe[1],et=localStorage.getItem("resId"),tt=(0,o.useRef)(null),nt=(0,o.useState)(!1),st=(0,a.Z)(nt,2),lt=st[0],at=st[1],ot=(0,o.useState)(G.UdN),it=(0,a.Z)(ot,2),rt=it[0],ct=it[1],dt=(0,o.useState)(!1),ut=(0,a.Z)(dt,2),mt=ut[0],ht=ut[1],ft=(0,o.useState)([]),pt=(0,a.Z)(ft,2),vt=(pt[0],pt[1]),xt=(0,o.useState)(!1),gt=(0,a.Z)(xt,2),jt=gt[0],yt=gt[1],St=(0,o.useState)(690),bt=(0,a.Z)(St,2),Nt=bt[0],Ct=bt[1],Zt=(0,o.useState)([]),Dt=(0,a.Z)(Zt,2),wt=(Dt[0],Dt[1]),It={customerIds:"-1",FromDate:new Date,CSL:"-1",DP:"-1",EngCompany:"-1",showDelta:!0,UserId:512},Pt=(0,o.useState)([]),Rt=(0,a.Z)(Pt,2),Et=Rt[0],Mt=Rt[1];(0,o.useEffect)((function(){kt()}),[Nt]);var kt=function(){h().get(i+"/CommonMS/master/getMenus?loggedUserId=".concat(et)).then((function(e){var t=e.data.map((function(e){return e.subMenus&&(e.subMenus=e.subMenus.filter((function(e){return"Monthly Revenue Trend"!==e.display_name&&"Revenue & Margin Variance"!==e.display_name&&"Rev. Projections"!==e.display_name&&"Project Timesheet (Deprecated)"!==e.display_name&&"Financial Plan & Review"!==e.display_name}))),e}));console.log(t),wt(t),t.forEach((function(e){"Revenue Metrics"===e.display_name&&Mt([e])}));var n=t.find((function(e){return"Revenue Metrics"===e.display_name})).subMenus.find((function(e){return"Monthly PR Changes by Day"===e.display_name}));console.log(n);var s=n?n.userRoles.includes("911")?911:n.userRoles.includes("126")?126:n.userRoles.includes("686")?686:n.userRoles.includes("932")?932:n.userRoles.includes("690")&&n.userRoles.includes("46")?800:n.userRoles.includes("641")&&n.userRoles.includes("46")?700:n.userRoles.includes("690")&&n.userRoles.includes("641")?600:n.userRoles.includes("930")&&n.userRoles.includes("641")?500:n.userRoles.includes("930")&&n.userRoles.includes("690")?400:n.userRoles.includes("641")?641:690==n.userRoles&&641==n.userRoles?620:n.userRoles.includes("690")?690:n.userRoles.includes("930")&&930:null;console.log(s,"----------------------&&&&&&7"),641==s?h().get(i+"/ProjectMS/project/getCustomersByCsl?loggedUserId=".concat(et)).then((function(e){vt(e.data)})):600==s?h().get(i+"/CommonMS/master/getCustomers?loggedUserId=".concat(et)).then((function(e){var t=e.data;vt(t)})):690==s?h().get(i+"/ProjectMS/project/getCustomersByDP?loggedUserId=".concat(et)).then((function(e){vt(e.data)})):h().get(i+"/CommonMS/master/geActiveCustomerList").then((function(e){var t=e.data;vt(t)})),Ct(s)}))},At=function(e){e.expanded;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(G.qL$,{className:"chevronIcon"})})},Ot=(0,o.useState)(It),_t=(0,a.Z)(Ot,2),Tt=_t[0],Vt=_t[1],Ut=(0,o.useRef)([]),Bt=function(e){var t=e.target,n=(t.id,t.name),a=t.value;"customerIds"==n&&"select"==a&&(Vt((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,s.Z)({},n,a))})),ht(!0)),vt(),Vt((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,s.Z)({},n,a))}))};console.log(Nt),(0,o.useEffect)((function(){}),[Nt]);var zt=(0,o.useState)([]),Ft=(0,a.Z)(zt,2),Lt=(Ft[0],Ft[1]);(0,o.useEffect)((function(){h().get(i+"/CommonMS/master/getCSLDPAE?loggedUserId=".concat(et)).then((function(e){Lt(e.data)}))}),[]),console.log(Nt),(0,o.useEffect)((function(){Yt(),console.log(Nt),h().get(i+"/CommonMS/master/getCslDropDownData?userId=".concat(et)).then((function(e){var t=e.data.map((function(e){return{value:e.id,label:e.PersonName}}));t.push({value:999,label:"UnAssigned"}),U(t),oe(t)})).catch((function(e){console.log(e)})),console.log(Nt),h().get(i+"/CommonMS/master/getDPDropDownData?userId=".concat(et)).then((function(e){var t=e.data.map((function(e){return{value:e.id,label:e.PersonName}}));t.push({value:999,label:"UnAssigned"}),Y(t),fe(t)})).catch((function(e){console.log(e)}))}),[]);var Ht=null===(e=JSON.parse(localStorage.getItem("selectedCust")))||void 0===e||null===(t=e.map((function(e){return e.id})))||void 0===t?void 0:t.toString(),Yt=function(){h()({method:"get",url:i+"/ProjectMS/Engagement/EngCompany"}).then((function(e){var t=e.data.map((function(e){return{value:e.value,label:e.label}}));ge(t),Re(t)})).catch((function(e){console.log(e)}))};console.log(_e,"columns.............");var Kt=(0,o.useState)([{}]),Wt=(0,a.Z)(Kt,2),Gt=Wt[0],Jt=Wt[1],qt=null===Gt||void 0===Gt?void 0:Gt.map((function(e){return null===e||void 0===e?void 0:e.id})).toString();console.log(qt),(0,o.useEffect)((function(){}),[qt]);var Xt=function(e){var t=e.id,n=e.value;console.log(t+" "+n),ke((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,s.Z)({},t,n))})),console.log(Be)};console.log(Tt,"FormData.................");var Qt=function(e,t){Promise.resolve().then(n.t.bind(n,64802,23)).then((function(n){if(n&&n.default){var s=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});n.default.saveAs(s,t+".xlsx")}}))},$t=function(e,t){var n=e.map((function(e){return e.value})),s=t.map((function(e){return e.value}));return n.length===s.length?"<< ALL >>":e.map((function(e){return e.label})).join(", ")};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g,{open:R,onClose:function(){return E(!1)}}),(0,r.jsxs)("div",{children:[He?(0,r.jsxs)("div",{className:"  statusMsg error",children:[" ","\xa0",(0,r.jsxs)("span",{className:"error-block",children:[(0,r.jsx)(L.CSE,{size:"1.4em",strokeWidth:{width:"100px"}})," ","\xa0 Please select the valid values for highlighted fields."]})]}):"",(0,r.jsxs)("div",{className:"pageTitle",children:[(0,r.jsx)("div",{className:"childOne"}),(0,r.jsx)("div",{className:"childTwo",children:(0,r.jsx)("h2",{children:"Monthly Planned Revenue Changes By Day"})}),(0,r.jsx)("div",{className:"childThree"})]}),(0,r.jsx)(ne.Z,{routes:Et,currentScreenName:["Monthly PR Changes By Day"]}),(0,r.jsxs)("div",{className:"group mb-3 customCard",children:[(0,r.jsxs)("div",{className:"col-md-12 collapseHeader",children:[(0,r.jsx)("h2",{children:"Search Filters"}),(0,r.jsx)("div",{className:"helpBtn",children:(0,r.jsx)(te.Z,{pdfname:"MonthlyPRChangesByDay.pdf",name:"Monthly PR Changes By Day"})}),(0,r.jsx)("div",{onClick:function(){at(!lt),ct(lt?G.UdN:G.NR5)},children:(0,r.jsx)("span",{children:rt})})]}),(0,r.jsx)(p.V9,{visible:!lt,children:(0,r.jsxs)("div",{className:"group-content row",children:[(0,r.jsx)("div",{className:" col-md-3 mb-2",children:(0,r.jsxs)("div",{className:"form-group row",children:[(0,r.jsxs)("label",{className:"col-5",htmlFor:"customerIds",children:["Customer \xa0",(0,r.jsx)("span",{className:"error-text",children:"*"})]}),(0,r.jsx)("span",{className:"col-1 p-0",children:":"}),(0,r.jsx)("div",{className:"col-6",children:911==Nt||126==Nt||686==Nt||930==Nt||932==Nt||931==Nt?(0,r.jsxs)("select",{className:"cancel Text",name:"customerIds",id:"customerIds",onChange:Bt,children:[Gt.length+"selected",(0,r.jsxs)("option",{value:-1,selected:!0,children:[" ","<<All>>"]}),(0,r.jsx)("option",{value:0,children:"Active Customers"}),(0,r.jsx)("option",{value:"select",children:"Select"})]}):(0,r.jsxs)("select",{className:"cancel Text",name:"customerIds",id:"customerIds",onChange:Bt,children:[Gt.length+"selected",(0,r.jsxs)("option",{value:"",selected:!0,children:[" ","<<Please Select>>"]}),(0,r.jsx)("option",{value:"select",children:"Select"})]})})]})}),(0,r.jsx)("div",{className:" col-md-3 mb-2",children:(0,r.jsxs)("div",{className:"form-group row",children:[(0,r.jsxs)("label",{className:"col-5",children:["CSL ",(0,r.jsx)("span",{className:"error-text",children:"*"})]}),(0,r.jsx)("span",{className:"col-1 p-0",children:":"}),(0,r.jsx)("span",{className:"col-6",children:(0,r.jsx)("div",{style:{zIndex:"6"},id:"roleTypes",className:"multiselect",ref:function(e){Ut.current[0]=e},children:(0,r.jsx)(N.NU,{ArrowRenderer:At,options:V,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:ae,valueRenderer:$t,disabled:!1,onChange:function(e){oe(e);var t=e.map((function(e){return e.value}));Vt((0,l.Z)((0,l.Z)({},Tt),{},(0,s.Z)({},"CSL",t.toString()))),Xt({id:"CSL",value:t.toString()})},ref:function(e){Ut.current[0]=e}})})})]})}),(0,r.jsx)("div",{className:" col-md-3 mb-2",children:(0,r.jsxs)("div",{className:"form-group row",children:[(0,r.jsxs)("label",{className:"col-5",children:["DP",(0,r.jsx)("span",{className:"error-text",children:"*"})," "]}),(0,r.jsx)("span",{className:"col-1 p-0",children:":"}),(0,r.jsx)("div",{className:"col-6",children:(0,r.jsx)("div",{id:"businessUnit",className:" multiselect",ref:function(e){Ut.current[1]=e},children:(0,r.jsx)(N.NU,{ArrowRenderer:At,id:"businessUnit",options:H,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:he,valueRenderer:$t,disabled:!1,onChange:function(e){fe(e);var t=[];e.forEach((function(e){t.push(e.value)})),de(t.toString())}})})})]})})," ",(0,r.jsx)("div",{className:" col-md-3 mb-2",children:(0,r.jsxs)("div",{className:"form-group row",children:[(0,r.jsxs)("label",{className:"col-5",children:[" ","Eng. Company",(0,r.jsx)("span",{className:"error-text",children:"*"})]}),(0,r.jsx)("span",{className:"col-1 p-0",children:":"}),(0,r.jsx)("span",{className:"col-6",children:(0,r.jsx)("div",{id:"businessUnit",className:"multiselect",ref:function(e){Ut.current[2]=e},children:(0,r.jsx)(N.NU,{ArrowRenderer:At,id:"businessUnit",options:xe,hasSelectAll:!0,isLoading:!1,shouldToggleOnHover:!1,disableSearch:!1,value:Pe,valueRenderer:$t,disabled:!1,onChange:function(e){Re(e);var t=e.map((function(e){return e.value}));Vt((0,l.Z)((0,l.Z)({},Tt),{},(0,s.Z)({},"EngCompany",t.toString()))),Xt({id:"EngCompany",value:t.toString()})}})})})]})}),(0,r.jsx)("div",{className:"col-md-3 mb-2",children:(0,r.jsxs)("div",{className:"form-group row",children:[(0,r.jsxs)("label",{className:"col-5",children:[" ","Month",(0,r.jsx)("span",{className:"error-text",children:"*"})]}),(0,r.jsx)("span",{className:"col-1 p-0",children:":"}),(0,r.jsxs)("span",{className:"col-6",style:{zIndex:"5"},children:[console.log(Ze,"date..................."),(0,r.jsx)(y(),{dateFormat:"MMM-yyyy",showMonthYearPicker:!0,minDate:D,maxDate:w,selected:Ze,onChange:function(e){var t=b()(e),n=b()();t.month()===n.month()&&t.date(n.date()),De(t.toDate()),Vt((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,s.Z)({},"FromDate",t.format("yyyy-MM-DD")))}))}})]})]})}),(0,r.jsx)("div",{className:"col-md-12 col-sm-12 col-xs-12 btn-container center",children:(0,r.jsxs)("button",{className:"btn btn-primary",onClick:function(){console.log(Nt),Je([]),yt(!1);var e=(0,q.Z)(Ut);if(1==e&&Ye(!0),!e){Ye(!1),O(!0);var t=setTimeout((function(){$e(!0)}),2e3);be(!0),tt.current=new AbortController,console.log(Tt.FromDate,"formData.FromDate............."),h()({method:"post",url:i+"/ProjectMS/PlannedActivities/getCustPlRevProgress",signal:tt.current.signal,data:{customerIds:0==Tt.customerIds?0:-1==Tt.customerIds?-1:Ht,FromDate:b()(Tt.FromDate).format("yyyy-MM-DD"),CSL:Tt.CSL,DP:ce,EngCompany:Tt.EngCompany,showDelta:Tt.showDelta,UserId:+et}}).then((function(n){function s(e){if(e>=11&&e<=13)return(0,r.jsxs)("span",{children:[e,(0,r.jsx)("sup",{children:"th"})]});var t=e%10,n=1===t?(0,r.jsx)("sup",{children:"st"}):2===t?(0,r.jsx)("sup",{children:"nd"}):3===t?(0,r.jsx)("sup",{children:"rd"}):(0,r.jsx)("sup",{children:"th"});return(0,r.jsxs)("span",{children:[e,n]})}if(yt(!0),ze(n.data),console.log("resp.data.tableData>",n.data.tableData[2]),"object"===typeof n.data.tableData[2]){var l=n.data.tableData[2];for(var a in l)if(a.match(/\d{4}_\d{2}_\d{2}_plRev/)&&"Delta"!==l[a]){var o=s(parseInt(l[a]));l[a]=o}}console.log(n.data.tableData[2]),j(n.data.tableData);var i=n.data,c=n.data.columns.replaceAll("'","").split(",");Je(i),Te(c),console.log(c,"cols227"),console.log(i,"data228"),$e(!1),clearTimeout(t),!e&&at(!lt),ct(lt?G.UdN:G.NR5)})).catch((function(e){console.log(e)}))}},children:[(0,r.jsx)(G.U41,{})," Search"]})}),Qe?(0,r.jsx)(W.Z,{handleAbort:function(){tt.current&&tt.current.abort(),$e(!1)}}):""]})}),(0,r.jsx)("div",{}),(0,r.jsx)(J.Z,{visible:mt,setVisible:ht,setSelectedItems:Jt,selectedItems:Gt,flag:3,dataAccess:Nt})]}),(0,r.jsx)("div",{children:!0===A?(0,r.jsxs)("div",{style:{paddingBottom:"30px",position:"relative"},children:[(0,r.jsxs)("div",{className:"legendContainer mb-3",style:{fontSize:"11px",backgroundColor:"#ffffff",paddingLeft:"5px",paddingBottom:"5px",paddingTop:"5px",marginBottom:"0px",border:"1px solid #f8e6c3"},children:[(0,r.jsx)(X.BrF,{style:{color:"#9d7c42"}}),(0,r.jsx)("span",{className:"font-weight-bold",style:{color:"#9d7c42",fontSize:"13px"},children:"Delta = Current PR - Previous PR"}),(0,r.jsxs)("div",{className:"legend green",children:[(0,r.jsx)("div",{className:"legendCircle",title:"Positive Delta"}),(0,r.jsx)("div",{className:"legendTxt",style:{color:"#9d7c42",fontSize:"13px"},children:"Positive Delta"}),(0,r.jsxs)("div",{className:"legend red",children:[(0,r.jsx)("div",{className:"legendCircle ",title:"Negative Delta"}),(0,r.jsx)("div",{className:"legendTxt",style:{color:"#9d7c42",fontSize:"13px"},children:"Negative Delta"})]})]})]}),1==Se&&(0,r.jsx)("div",{className:"excelIconContainer",style:{position:"absolute",top:0,right:0},children:(0,r.jsx)(F.WlY,{size:"1.5em",title:"Export to Excel",style:{color:"green"},cursor:"pointer",onClick:function(){Promise.resolve().then(n.bind(n,34045)).then((function(e){var t,n=[];t=_e,n.length||(n=t);Object.keys(x[0]);var s=x.slice(1).map((function(e){var t={};return n.forEach((function(n){var s=e[n];if("string"===typeof s){var l=s.split("^&"),o=(0,a.Z)(l,2)[0];t[n]=o}else t[n]=s instanceof Object?s.props.children[0]:parseFloat(s)})),t})),l=s.map((function(e){var t=[];return n.forEach((function(n){var s={v:e[n],t:"s"};"delta"===n&&(s.s={alignment:{horizontal:"right"}}),t.push(s)})),t}));l.forEach((function(e){e.forEach((function(e){e.s={alignment:{horizontal:"right"}}}))}));var o={Sheets:{data:e.utils.aoa_to_sheet(l)},SheetNames:["data"]},i=e.write(o,{bookType:"xlsx",type:"array"});Qt(i,"MonthlyPrChanges")}))}})}),jt&&(0,r.jsx)(K,{data:Ge,dataAccess:Nt,expandedCols:["csl","dp","pm"],colExpandState:["0","0","dispName"]})]}):""})]})]})}},7217:function(){},61155:function(){}}]);
//# sourceMappingURL=2053.12e23a2f.chunk.js.map