"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[1391],{71391:function(e,s,t){t.r(s);var n=t(4942),a=t(1413),r=t(29439),c=t(72791),o=t(56355),l=t(7692),i=t(59513),d=t.n(i),u=(t(68639),t(72426)),m=t.n(u),h=t(78983),j=t(34831),v=t(40071),f=t(73220),x=t(74569),p=t.n(x),g=t(32125),N=t(83854),S=t(11167),y=t(37145),b=(t(46175),t(41310),t(72920)),Z=t(38262),T=t(80184);s.default=function(){var e=(0,c.useState)([]),s=(0,r.Z)(e,2),t=s[0],i=s[1],u=(0,c.useState)(!1),x=(0,r.Z)(u,2),_=x[0],M=x[1],D=(0,c.useState)(!1),k=(0,r.Z)(D,2),w=k[0],I=k[1],C=(0,c.useState)(!1),F=(0,r.Z)(C,2),P=F[0],A=F[1],R=(0,c.useState)(o.UdN),H=(0,r.Z)(R,2),E=H[0],U=H[1],L=(0,c.useState)([]),B=(0,r.Z)(L,2),Y=B[0],O=B[1],G=(0,c.useState)(""),V=(0,r.Z)(G,2),K=V[0],X=V[1],q=(0,c.useState)([]),z=(0,r.Z)(q,2),J=z[0],Q=z[1],W=(0,c.useState)([]),$=(0,r.Z)(W,2),ee=$[0],se=$[1],te=(0,c.useState)([]),ne=(0,r.Z)(te,2),ae=ne[0],re=ne[1],ce=(0,c.useState)([]),oe=(0,r.Z)(ce,2),le=oe[0],ie=oe[1],de=(0,c.useState)([]),ue=(0,r.Z)(de,2),me=ue[0],he=ue[1],je=(0,c.useState)(!1),ve=(0,r.Z)(je,2),fe=ve[0],xe=ve[1],pe=(0,c.useState)(!1),ge=(0,r.Z)(pe,2),Ne=ge[0],Se=ge[1],ye=(0,c.useState)(!1),be=(0,r.Z)(ye,2),Ze=be[0],Te=be[1],_e=(0,c.useState)([]),Me=(0,r.Z)(_e,2),De=Me[0],ke=Me[1],we=(0,c.useState)([]),Ie=(0,r.Z)(we,2),Ce=Ie[0],Fe=Ie[1],Pe=(0,c.useState)(!1),Ae=(0,r.Z)(Pe,2),Re=Ae[0],He=Ae[1],Ee=(0,c.useState)(!1),Ue=(0,r.Z)(Ee,2),Le=Ue[0],Be=Ue[1],Ye=(0,c.useState)({}),Oe=(0,r.Z)(Ye,2),Ge=Oe[0],Ve=(Oe[1],(0,c.useState)({})),Ke=(0,r.Z)(Ve,2),Xe=Ke[0],qe=Ke[1],ze=new Date,Je=ze.getMonth(),Qe=ze.getFullYear(),We=new Date(Qe,Je-11),$e=(0,c.useRef)(null),es=(0,c.useState)(m()(m()().startOf("month"))._d),ss=(0,r.Z)(es,2),ts=ss[0],ns=ss[1],as=(0,c.useRef)([]),rs={FromDate:m()(ts).format("yyyy-MM-DD")},cs=j.N.baseUrl,os=localStorage.getItem("resId");console.log(os);var ls=(0,c.useState)(rs),is=(0,r.Z)(ls,2),ds=is[0],us=is[1],ms=(0,c.useState)([]),hs=(0,r.Z)(ms,2),js=hs[0],vs=hs[1];console.log(js),(0,c.useEffect)((function(){0!=ae&&p().get(cs+"/timeandexpensesms/getResources?PrjId=".concat(ae)).then((function(e){var s=e.data;ie(s)})).catch((function(e){return console.log(e)})),0!=J&&p().get(cs+"/timeandexpensesms/getTaskList?resId=".concat(J,"&PrjId=").concat(ae,"&fromdt=").concat(ds.FromDate)).then((function(e){var s=e.data;he(s)})).catch((function(e){return console.log(e)}))}),[ae,ds.FromDate,J,Ge,t,js]),(0,c.useEffect)((function(){p()({method:"GET",url:cs+"/CommonMS/master/getMenus?loggedUserId=".concat(os)}).then((function(e){var s=e.data;s.forEach((function(e){"Time & Expenses"===e.display_name&&Fe([e])}));var t=s.find((function(e){return"Time & Expenses"===e.display_name})).subMenus.find((function(e){return"Fill Timesheets"===e.display_name})),n=t?t.userRoles.includes("690")?690:t.userRoles.includes("641")?641:t.userRoles.includes("46")?46:t.userRoles.includes("930")&&930:null;vs(n),console.log(n),930==n?p().get(cs+"/CommonMS/master/getProjectsforAE?loggedUserId=".concat(os)).then((function(e){var s=e.data;O(s)})).catch((function(e){return console.log(e)})):641==n||690==n?p().get(cs+"/ProjectMS/project/getProjectsbyDp?loggedUserId=".concat(os)).then((function(e){var s=e.data;s.push({id:"-1",name:"<<ALL>>"}),O(s)})).catch((function(e){return console.log(e)})):46==n?p().get(cs+"/ProjectMS/project/getProjectsForFillTimeSheets?loggedUserId=".concat(os)).then((function(e){var s=e.data;s.push({id:"-1",name:"<<ALL>>"}),O(s)})).catch((function(e){return console.log(e)})):p().get(cs+"/timeandexpensesms/getProjectsForAdmin").then((function(e){var s=e.data;O(s)})).catch((function(e){return console.log(e)}))}))}),[]);var fs=function(){var e=(0,g.Z)(as);p().post(cs+"/timeandexpensesms/getTimesheetTable?resId=".concat(J,"&PrjId=").concat(ae,"&fromdt=").concat(ds.FromDate,"&taskId=").concat(ee)).then((function(s){for(var t=s.data,n=0;n<t.length;n++)t[n].SNo=n+1,t[n].createdAt=null==t[n].createdAt?"":m()(t[n].createdAt).format("DD-MM-YYYY HH:mm:ss");console.log(t),i(t),He(!1),Be(!0),!e&&A(!P),U(P?o.UdN:o.NR5),qe()})).catch((function(e){}))},xs=(0,c.useRef)(null),ps=function(e,s){X(e),(""===e||e>=0&&e<=24)&&qe((function(t){return(0,a.Z)((0,a.Z)({},t),{},(0,n.Z)({},s.timesheet_dt,e))}))};return(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{className:"col-md-12  mt-2",children:[_?(0,T.jsx)("div",{className:"statusMsg success",children:(0,T.jsxs)("span",{className:"errMsg",children:[(0,T.jsx)(l.hXj,{}),"\xa0TimeSheet Saved Successfully"]})}):"",w&&"Save"==De?(0,T.jsx)("div",{className:"statusMsg success",children:(0,T.jsxs)("span",{className:"errMsg",children:[(0,T.jsx)(l.hXj,{}),"\xa0 Timesheet Saved and Approved Successfully"]})}):"",fe?(0,T.jsxs)("div",{className:"statusMsg error",children:[" ",(0,T.jsxs)("span",{children:[" ",(0,T.jsx)(v.SZZ,{})," Please select the valid values for highlighted fields"," "]})]}):"",Ne?(0,T.jsxs)("div",{className:"statusMsg error",ref:xs,children:[" ",(0,T.jsxs)("span",{children:[" ",(0,T.jsx)(v.SZZ,{})," Please enter the valid hours"," "]})]}):""]}),(0,T.jsx)("div",{className:"col-md-12",children:(0,T.jsxs)("div",{className:"pageTitle",children:[(0,T.jsx)("div",{className:"childOne"}),(0,T.jsx)("div",{className:"childTwo",children:(0,T.jsx)("h2",{children:"Fill Timesheets"})}),(0,T.jsx)("div",{className:"childThree"})]})}),(0,T.jsx)(Z.Z,{routes:Ce,currentScreenName:["Fill Timesheets"]}),(0,T.jsxs)("div",{className:"group mb-1 customCard",children:[(0,T.jsxs)("div",{className:"col-md-12 collapseHeader",children:[(0,T.jsx)("h2",{children:"Timesheet"}),(0,T.jsx)("div",{className:"helpBtn",children:(0,T.jsx)(b.Z,{pdfname:"PMOTimesheet.pdf",name:"Fill Timesheets Help"})}),(0,T.jsx)("div",{onClick:function(){A(!P),U(P?o.UdN:o.NR5)},children:(0,T.jsx)("span",{children:E})})]}),(0,T.jsx)(h.V9,{visible:!P,children:(0,T.jsxs)("div",{className:"group-content row",children:[(0,T.jsx)("div",{className:"col-md-4 mb-2",children:(0,T.jsxs)("div",{className:"form-group row",children:[(0,T.jsxs)("label",{className:"col-5",htmlFor:"email-input",children:["Month\xa0",(0,T.jsx)("span",{className:"error-text",children:"*"})]}),(0,T.jsx)("span",{className:"col-1",children:":"}),(0,T.jsx)("div",{className:"col-6",children:(0,T.jsx)("div",{className:"datepicker",ref:function(e){as.current[0]=e},children:(0,T.jsx)(d(),{id:"FromDate",selected:ts,minDate:We,autoComplete:"off",onChange:function(e){ns(e),us((function(s){return(0,a.Z)((0,a.Z)({},s),{},(0,n.Z)({},"FromDate",m()(e).format("yyyy-MM-DD")))})),O(),ie(),he(),Q(),re()},dateFormat:"MMM-yyyy",maxDate:ze,showMonthYearPicker:!0,placeholderText:"Begin Date",onKeyDown:function(e){e.preventDefault()}})})})]})}),(0,T.jsx)("div",{className:"col-md-4 mb-2",children:(0,T.jsxs)("div",{className:"form-group row",children:[(0,T.jsxs)("label",{className:"col-5",htmlFor:"country-select",children:["Projects\xa0",(0,T.jsx)("span",{className:"error-text",children:"*"})]}),(0,T.jsx)("span",{className:"col-1 p-0",children:":"}),(0,T.jsx)("div",{className:"col-6",children:(0,T.jsxs)("select",{ref:function(e){as.current[1]=e},className:" text",name:"prj_id",id:"prj_id",onChange:function(e){re(e.target.value),ie(),he(),Te(!1)},children:[(0,T.jsx)("option",{value:"",children:" <<Please Select>>"}),null===Y||void 0===Y?void 0:Y.map((function(e){return(0,T.jsx)("option",{value:e.id,children:e.projectName},e.id)}))]})})]})}),(0,T.jsx)("div",{className:"col-md-4 mb-2",children:(0,T.jsxs)("div",{className:"form-group row",children:[(0,T.jsxs)("label",{className:"col-5",htmlFor:"country-select",children:["Resources\xa0",(0,T.jsx)("span",{className:"error-text",children:"*"})]}),(0,T.jsx)("span",{className:"col-1",children:":"}),(0,T.jsx)("div",{className:"col-6",children:(0,T.jsxs)("select",{ref:function(e){as.current[2]=e},className:" text",id:"res_id",name:"res_id",onChange:function(e){var s=e.target,t=(s.id,s.value);Te(!0),he(),Q(t)},children:[(0,T.jsx)("option",{value:"",children:" <<Please Select>>"}),null===le||void 0===le?void 0:le.map((function(e){return(0,T.jsx)("option",{value:e.id,children:e.name},e.id)}))]})})]})}),(0,T.jsx)("div",{className:"col-md-4 mb-2",children:(0,T.jsxs)("div",{className:"form-group row",children:[(0,T.jsxs)("label",{className:"col-5",htmlFor:"email-input",children:["Task List\xa0",(0,T.jsx)("span",{className:"error-text",children:"*"})]}),(0,T.jsx)("span",{className:"col-1",children:":"}),(0,T.jsxs)("div",{className:"col-6",children:[(0,T.jsxs)("select",{ref:function(e){as.current[3]=e},className:" text",name:"task_id",id:"task_id",onChange:function(e){!function(e){var s=e.target,t=(s.id,s.value);se(t)}(e)},children:[(0,T.jsx)("option",{value:"",children:" <<Please Select>>"}),null===me||void 0===me?void 0:me.map((function(e){return(0,T.jsx)("option",{value:e.project_task_id,children:e.task_name},e.project_task_id)}))]}),Ze&&""==me||me==[]?(0,T.jsxs)("div",{children:[" ",(0,T.jsxs)("span",{children:[(0,T.jsx)("b",{children:"No Task Found"})," "]})]}):""]})]})}),(0,T.jsx)("div",{className:"col-md-12 col-sm-12 col-xs-12 btn-container center my-1",children:(0,T.jsxs)("button",{type:"submit",className:"btn btn-primary",title:"Search",onClick:function(){return(0,f.Z)(as),void((0,g.Z)(as)?xe(!0):(He(!1),$e.current=new AbortController,Be(!1),xe(!1),fs()))},children:[(0,T.jsx)(o.U41,{})," Search"," "]})})]})}),Re?(0,T.jsx)(N.Z,{handleAbort:function(){$e.current&&$e.current.abort(),He(!1)}}):"",Le?(0,T.jsxs)("div",{className:"col-md-4 darkHeader",children:[(0,T.jsxs)("div",{className:"legendContainer",children:[(0,T.jsxs)("div",{className:"legend green",children:[(0,T.jsx)("div",{className:"legendCircle "}),"Approved"]}),(0,T.jsxs)("div",{className:"legend red",children:[(0,T.jsx)("div",{className:"legendCircle "})," Rejected"]})]}),(0,T.jsxs)(y.w,{className:"primeReactDataTable ",value:t,showGridlines:!0,rows:25,dataKey:"id",responsiveLayout:"scroll",emptyMessage:"No Records found.",style:{align:"center"},children:[(0,T.jsx)(S.sgG,{field:"timesheet_dt",header:"  Date",alignHeader:"center",body:function(e){return(0,T.jsx)("div",{align:"center",children:m()(e.timesheet_dt).format("DD-MMM-yyyy")})}}),(0,T.jsx)(S.sgG,{field:"hours",header:"Hours",alignHeader:"center",body:function(e){return(0,T.jsx)("div",{align:"center",children:173==e.typ_status?(0,T.jsx)("form",{children:(0,T.jsx)("input",{id:"hours",disabled:!0,className:"approvedHrs",value:Math.round(e.hours)})}):172==e.typ_status?(0,T.jsx)("input",{id:"hours",style:{backgroundColor:"red",textAlign:"center"},defaultValue:Math.round(e.hours),onChange:function(s){var t=Math.round(s.target.value);ps(t,e)}}):(0,T.jsx)("input",{id:"hours",style:{textAlign:"center"},defaultValue:Math.round(e.hours),onChange:function(s){var t=Math.round(s.target.value);ps(t,e)}})})}})]}),(0,T.jsx)("div",{className:"row mt-3",children:(0,T.jsxs)("div",{className:"col-md-12 btn-container center ",children:[(0,T.jsxs)("button",{className:"btn btn-primary mt-2 mb-2",value:"Approved",onClick:function(e){!function(e){if(void 0==Xe||null==Xe||Xe=={}||""===K||0==K||K>=0&&K>=25)Se(!0),window.scrollTo({top:0,behavior:"smooth"}),setTimeout((function(){Se(!1)}),6e3);else{ke(e.target.value),Se(!1);var s=[];Object.keys(Xe).forEach((function(e){var t={};t.timesheetDt=e,t.enteredHours=Math.round(Xe[e]),t.projectId=ae,t.projectTaskId=ee,t.resource_id=J,t.approver_notes="",t.typStatusId=174,t.loggedId=J,t.updatedById=J,s.push(t)})),p()({method:"post",url:cs+"/administrationms/timeSheet/saveTimesheet",data:s}).then((function(e){e.data,fs(),He(!1),Be(!1),setTimeout((function(){He(!1),Be(!0)}),5e3),qe(),M(!0),window.scrollTo({top:0,behavior:"smooth"}),setTimeout((function(){M(!1)}),3e3)}))}}(e)},children:[(0,T.jsx)(o.TvB,{}),"Save"]}),(0,T.jsxs)("button",{className:"btn btn-primary mt-2 mb-2",value:"Save",onClick:function(e){!function(e){if(ke(e.target.value),void 0==Xe||null==Xe||Xe=={}||""===K||0==K||K>=0&&K>=25)Se(!0),window.scrollTo({top:0,behavior:"smooth"}),setTimeout((function(){Se(!1)}),6e3);else{Se(!1);var s=[];Object.keys(Xe).forEach((function(e){var t={};t.timesheetDt=e,t.enteredHours=Xe[e],t.projectId=ae,t.projectTaskId=ee,t.resource_id=J,t.approver_notes="",t.typStatusId=173,t.loggedId=J,t.updatedById=J,s.push(t)})),p()({method:"post",url:cs+"/administrationms/timeSheet/saveTimesheet",data:s}).then((function(e){e.data,fs(),qe(),I(!0),window.scrollTo({top:0,behavior:"smooth"}),setTimeout((function(){I(!1)}),3e3)}))}}(e)},children:[(0,T.jsx)(o.TvB,{}),"Save & Approve"]})]})})]}):""]})]})}}}]);
//# sourceMappingURL=1391.73c12633.chunk.js.map